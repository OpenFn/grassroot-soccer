name: grassroot-soccer
description: null
collections: null
credentials:
  aissatou@openfn.org-GRS-Salesforce-Sandbox:
    name: GRS Salesforce Sandbox
    owner: aissatou@openfn.org
  rita@openfn.org-GRS-CommCare-Prod-with-Webhook-URLs:
    name: GRS CommCare Prod with Webhook URLs
    owner: rita@openfn.org
  rita@openfn.org-GRS-Salesforce-Prod:
    name: GRS Salesforce Prod
    owner: rita@openfn.org
workflows:
  Upsert-Pre-Challenges:
    name: Upsert Pre Challenges
    jobs:
      Upsert-Pre-Challenges:
        name: Upsert Pre Challenges
        adaptor: '@openfn/language-salesforce@4.3.0'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          fn(state => {
            function transform(value) {
              if (!value) return;
              //console.log("value in switch", value.toString().trim().toLowerCase());
              switch (value.toString().trim().toLowerCase()) {
                case 'true':
                case 'yes':
                case 'agree':
                case 'verdade':
                case 'concorda':
                case 'concordo':
                case 'choice1':
                  return 1;
                case 'false':
                case 'no':
                case 'disagree':
                case 'discorda':
                case 'discordo':
                case 'falso':
                case 'choice6':
                case 'choice3':
                  return 2;
                case 'i_dont_know':
                case 'na':
                  return 3;
                case 'unanswered':
                  return 4;
                case 'not_applicable':
                  return 5;
                default:
                  return value;
              }
            }

            state.helperFunctions = { transform };

            return query(
              `SELECT Participant_Identification_Number_PID__c from Person__c where Participant_Identification_Number_PID__c  = '${state.data.form.case['@case_id']}'`
            )(state);
          });

          fn(state => {
            const { form } = state.data;

            const formVersion = Object.keys(form).find(key => key.includes('pre_challenge'));

            console.log("form version", formVersion);

            const sfFieldMapping = {
              'pre_challenge_south_africa_-_skillz_girl': {
                Pre_1__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_have_an_older_person_in_my_life_i_can_go_to_for_advice_i_have_an_older_pe',
                Pre_2__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_know_how_to_make_a_plan_to_deal_with_the_challenges_i_may_face_in_reachin',
                Pre_3__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Pre_4__c: 'form.pre_challenge_south_africa_-_skillz_girl.every_day_i_can_find_something_to_be_grateful_for',
                Pre_5__c: 'form.pre_challenge_south_africa_-_skillz_girl.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Pre_6__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Pre_7__c: 'form.pre_challenge_south_africa_-_skillz_girl.girls_have_a_greater_risk_of_contracting_hiv_than_boys',
                Pre_8__c: 'form.pre_challenge_south_africa_-_skillz_girl.if_i_am_sexually_active_i_go_to_a_clinic_to_get_protection_from_hivstis_and',
                Pre_9__c: 'form.pre_challenge_south_africa_-_skillz_girl.like_physical_health_we_all_have_mental_health',
                Pre_10__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Pre_11__c: 'form.pre_challenge_south_africa_-_skillz_girl.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Pre_12__c: 'form.pre_challenge_south_africa_-_skillz_girl.if_a_girl_is_sexually_abused_she_can_reduce_her_risk_of_getting_hiv_by_goin',
                Pre_13__c: 'form.pre_challenge_south_africa_-_skillz_girl.sometimes_a_man_may_have_a_good_reason_to_hit_his_partner',
                Pre_14__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Pre_15__c: 'form.pre_challenge_south_africa_-_skillz_girl.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                Pre_16__c: 'form.pre_challenge_south_africa_-_skillz_girl.if_sexually_active_i_or_my_partner_is_using_a_prevention_method_to_protect_',
                Pre_17__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_know_where_to_go_to_receive_counselling_for_mental_health_challenges',
                Pre_18__c: 'form.pre_challenge_south_africa_-_skillz_girl.loss_of_interest_in_funenjoyable_activities_is_a_common_sign_of_depression',
                Pre_19__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_know_at_least_three_methods_to_prevent_an_unwanted_pregnancy',
              },
              'portuguese_pre_challenge_gcr_-_skillz_malaria': {
                Pre_1__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.dormir_dentro_da_rede_mosquiteira_tratada_todas_as_noites_pode_proteger_me_',
                Pre_2__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.posso_esperar_uns_dias_antes_de_fazer_o_teste_de_malria_se_tiver_febres',
                Pre_3__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.um_mdico_tradicionalcurandeiro_pode_me_dar_um_tratamento_para_curar_a_malri',
                Pre_4__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.se_tiver_malria_e_no_for_tratado_posso_transmitir_a_malria_a_algum',
                Pre_5__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.somente_as_mulheres_grvidas_e_as_crianas_menores_de_5_anos__que_precisam_de',
                Pre_6__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.a_malria_pode_matar_se_no_fr_tratada',
                Pre_7__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.a_febre__um_sintoma_da_malria',
                Pre_8__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.eu_me_sinto_bem_conmigo_mesmo',
                Pre_9__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.tenho_algum_na_minha_vida_que_pode_me_dar_bons_conselhos_quando_preciso_de_',
                Pre_10__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.eu_sei_onde_posso_ter_tratamento_para_malria_na_minha_comunidade',
                Pre_11__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.posso_proteger-me_da_malria',
              },
            
              'portuguese_pre_challenge_gcr_-_skillz_girl': {
                Pre_1__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.falei_sobre_o_hiv_com_uma_pessoa_adulta_nos_ltimos_2_meses_fora_do_skillz',
                Pre_2__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.sei_como_expressar_a_minha_raiva_sem_ser_violento',
                Pre_3__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.sei_como_superar_os_desafios_que_possa_enfrentar_na_minha_vida',
                Pre_4__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.sei_quais_as_decises_a_tomar_para_alcanar_os_meus_objectivos',
                Pre_5__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.os_rapazes_correm_um_risco_mais_elevado_de_serem_vtimas_de_violncia_do_que_',
                Pre_6__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.conheco_que_mudanas_ocorrem_no_meu_corpo_durante_a_puberdade',
                Pre_7__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.conheo_pelo_menos_trs_mtodos_para_evitar_uma_gravidez_indesejada',
                Pre_8__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.os_preservativos_so_o_nico_mtodo_contraceptivo_que_protege_contra_a_gravide',
                Pre_9__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.conheco_onde_obter_servios_de_apoio_para_mim_ou_outra_pessoa_para_casos_de_',
                Pre_10__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.se_uma_rapariga_inicia_seu_perodo_menstrual_significa_que_est_pronta_para_c',
                Pre_11__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.caso_eu_seja_abusada_sexualmente_prefiro_guard-lo_para_mim_para_evitar_que_',
                Pre_12__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.um_homem_tem_o_direito_de_ter_sexo_com_a_sua_namorada_mesmo_que_ela_no_o_qu',
                Pre_13__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.pessoas_com_problemas_de_sade_mental_so_apenas_confusas_ou_loucas',
                Pre_14__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.pessoas_com_problemas_de_sade_mental_so_apenas_confusas_ou_loucas',
                Pre_15__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.informaria_a_algum_caso_fosse_tocada_por_alguem_de_uma_forma_que_me_deixass',
                Pre_16__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.uma_filha_deve_sempre_respeitar_a_deciso_dos_seus_pais_para_se_casar',
                Pre_17__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.um_casamento_bem_sucedido__mais_importante_para_as_raparigas_do_que_termina',
                Pre_18__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.eu_no_praticaria_desporto_com_algum_que_tem_hiv',
                Pre_19__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.um_namorado_pode_ter_boas_razes_para_bater_na_sua_namorada',
                Pre_20__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.no_faz_mal_que_um_rapaz_ameace_bater_na_sua_namorada_se_nunca_a_bater_fisic',
              },
              'pre_challenge_zambia_-_plus_mh_enhanced_zambia': {
                Pre_1__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.in_general_i_feel_good_about_myself',
                Pre_2__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_have_the_skills_and_knowledge_to_avoid_getting_infected_with_another_kind',
                Pre_3__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_important_to_know_why_and_how_i_want_to_tell_someone_my_hiv_status',
                Pre_4__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_accept_myself_and_my_hiv_status',
                Pre_5__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Pre_6__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.are_you_or_have_you_been_past_12_months_in_a_sexual_relationship_na_if_not_',
                Pre_7__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
                Pre_8__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                Pre_9__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.there_are_people_i_trust_with_whom_i_can_talk_about_my_status',
                Pre_10__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_okay_for_two_people_with_hiv_to_have_unprotected_sex_with_each_other',
                Pre_11__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_okay_for_someone_with_hiv_to_stop_taking_their_arv_as_soon_as_they_st',
                Pre_12__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.when_i_have_a_choice_it_is_important_to_eat_a_variety_of_foods_including_gr',
                Pre_13__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.mental_health_problems_have_nothing_to_do_with_being_lazy_or_weak_and_many_',
                Pre_14__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.art_adherence_is_an_important_part_of_my_overall_health_and_well-being',
                Pre_15__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.the_most_common_illnesses_of_mental_health_are_depression_and_anxiety',
                Pre_16__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.biological_and_social_factors_contribute_to_females_and_males_experiencing_',
              },
              'pre_challenge_nigeria_-_advanced_skills':{
                Pre_1__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_have_talked_about_hiv_with_an_adult_in_the_past_two_months_outside_skillz',
                Pre_2__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_have_talked_about_malaria_with_an_adult_in_the_past_two_months_outside_sk',
                Pre_3__c: 'form.pre_challenge_nigeria_-_advanced_skills.unequal_power_in_relationships_can_contribute_to_the_spread_of_hiv',
                Pre_4__c: 'form.pre_challenge_nigeria_-_advanced_skills.the_most_effective_way_to_avoid_getting_hiv_is_to_abstain_from_sex',
                Pre_5__c: 'form.pre_challenge_nigeria_-_advanced_skills.malaria_is_spread_by_standing_under_the_hot_sun',
                Pre_6__c: 'form.pre_challenge_nigeria_-_advanced_skills.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                Pre_7__c: 'form.pre_challenge_nigeria_-_advanced_skills.sleeping_under_a_mosquito_net_every_night_can_help_protect_me_from_malaria',
                Pre_8__c: 'form.pre_challenge_nigeria_-_advanced_skills.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                Pre_9__c: 'form.pre_challenge_nigeria_-_advanced_skills.it_is_okay_for_someone_with_malaria_to_stop_taking_their_medication_as_soon',
                Pre_10__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_can_abstain_from_sex_until_i_am_older_even_if_it_is_difficult',
                Pre_11__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Pre_12__c: 'form.pre_challenge_nigeria_-_advanced_skills.men_should_share_the_work_around_the_house_such_as_cleaning',
                Pre_13__c: 'form.pre_challenge_nigeria_-_advanced_skills.it_is_the_males_responsibilty_to_make_decisions_in_a_relationship',
                Pre_14__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_can_use_drugs_and_still_easily_reach_my_goals_in_life',
                Pre_15__c: 'form.pre_challenge_nigeria_-_advanced_skills.when_sick_it_is_better_to_visit_the_herb_seller_than_to_visit_a_doctor_or_a',
                Pre_16__c: 'form.pre_challenge_nigeria_-_advanced_skills.it_is_okay_to_use_violence_with_my_partner_if_he_or_she_makes_me_angry',
                Pre_17__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_have_the_power_to_change_gender_expectations_that_i_do_not_agree_with',
              },
              'pre_challenge_zimbabwe_-_skillz_core_zimbabwe': {
                Pre_1__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_know_what_decisions_to_make_to_achieve_my_goals',
                Pre_2__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girlboy',
                Pre_3__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_what_i_am_good_at',
                Pre_4__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                Pre_5__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Pre_6__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Pre_7__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_access_sexual_health_services_such_as_sti_and_hiv_testi',
                Pre_8__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Pre_9__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Pre_10__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.girls_should_be_obedient_and_should_not_disagree_with_boys',
                Pre_11__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                Pre_12__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.my_skillz_coach_helps_me_to_be_a_better_person',
                Pre_13__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                Pre_14__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.if_i_test_positive_for_hiv_there_will_be_someone_who_will_help_and_support_',
                Pre_15__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_who_to_go_to_if_i_amsomeone_i_know_is_abused_sexually_physically_and',
                Pre_16__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_who_to_go_to_if_someone_touches_me_in_a_way_that_makes_me_uncomforta',
                Pre_17__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                Pre_18__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Pre_19__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
              },
              'pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe': {
                Pre_1__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_know_what_decisions_to_make_to_achieve_my_goals',
                Pre_2__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_dont_always_have_to_do_what_people_expect_just_because_i_am_girlboy',
                Pre_3__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Pre_4__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_can_make_my_own_informed_decisions_about_my_sexual_health',
                Pre_5__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Pre_6__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Pre_7__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.my_skillz_coach_helps_me_to_be_a_better_person',
                Pre_8__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advise_or_when_i_have_a',
                Pre_9__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
              },
              'pre_challenge_mindskillz-_zambia_100': {
                Pre_1__c:'form.pre_challenge_mindskillz-_zambia_100.when_i_express_my_feelings_clearly_people_understand_me_better',
                Pre_2__c:'form.pre_challenge_mindskillz-_zambia_100.i_have_skills_that_help_me_bounce_back_from_difficult_situations',
                Pre_3__c:'form.pre_challenge_mindskillz-_zambia_100.stress_is_a_normal_part_of_life',
                Pre_4__c:'form.pre_challenge_mindskillz-_zambia_100.i_can_reach_my_goals_in_life',
                Pre_5__c:'form.pre_challenge_mindskillz-_zambia_100.if_i_have_a_problem_i_have_someone_in_my_life_i_can_go_to_for_support',
                Pre_6__c:'form.pre_challenge_mindskillz-_zambia_100.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Pre_7__c:'form.pre_challenge_mindskillz-_zambia_100.self_control_helps_you_make_smart_decisions_when_you_are_angry_or_upset',
                Pre_8__c:'form.pre_challenge_mindskillz-_zambia_100.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                Pre_9__c:'form.pre_challenge_mindskillz-_zambia_100.i_know_how_to_express_my_anger_without_being_violent',
                Pre_10__c:'form.pre_challenge_mindskillz-_zambia_100.listening_carefully_to_others_is_an_important_communication_skill',
                Pre_11__c:'form.pre_challenge_mindskillz-_zambia_100.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                Pre_12__c:'form.pre_challenge_mindskillz-_zambia_100.i_can_understand_how_others_are_feeling_and_be_sensitive_to_their_emotions',
                Pre_13__c:'form.pre_challenge_mindskillz-_zambia_100.i_am_confident_that_i_know_where_to_seek_information_about_mental_illness',
                Pre_14__c:'form.pre_challenge_mindskillz-_zambia_100.i_am_confident_using_the_computer_or_telephone_to_seek_information_about_me',
                Pre_15__c:'form.pre_challenge_mindskillz-_zambia_100.i_am_confident_attending_face_to_face_appointments_to_seek_information_abou',
                Pre_16__c:'form.pre_challenge_mindskillz-_zambia_100.i_am_confident_i_have_access_to_resources_eg_doctor_internet_friends_that_i',
                Pre_17__c:'form.pre_challenge_mindskillz-_zambia_100.people_with_mental_illness_could_snap_out_of_it_if_they_wanted',
                Pre_18__c:'form.pre_challenge_mindskillz-_zambia_100.a_mental_illness_is_a_sign_of_personal_weakness',
                Pre_19__c:'form.pre_challenge_mindskillz-_zambia_100.a_mental_illness_is_not_a_real_medical_illness',
                Pre_20__c:'form.pre_challenge_mindskillz-_zambia_100.people_with_mental_illness_are_dangerous',
                Pre_21__c:'form.pre_challenge_mindskillz-_zambia_100.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Pre_22__c:'form.pre_challenge_mindskillz-_zambia_100.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Pre_23__c:'form.pre_challenge_mindskillz-_zambia_100.seeing_a_mental_health_professional_means_you_are_not_strong_enough_to_mana',
                Pre_24__c:'form.pre_challenge_mindskillz-_zambia_100.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi',
                Pre_25__c:'form.pre_challenge_mindskillz-_zambia_100.i_believe_treatment_for_a_mental_illness_provided_by_a_mental_health_profes',
              },
              'pre_challenge_skillz_girl_nih200':{
                Pre_1__c:'form.pre_challenge_skillz_girl_nih200.i_have_talked_about_hiv_with_an_adult_in_the_past_two_months_outside_skillz',
                Pre_2__c:'form.pre_challenge_skillz_girl_nih200.i_have_talked_about_hiv_with_a_friend_in_the_past_two_months_outside_skillz',
                Pre_3__c:'form.pre_challenge_skillz_girl_nih200.having_sex_with_an_older_partner_increases_my_risk_of_getting_hiv',
                Pre_4__c:'form.pre_challenge_skillz_girl_nih200.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Pre_5__c:'form.pre_challenge_skillz_girl_nih200.i_know_someone_in_my_community_who_distributes_contraceptives_and_other_sex',
                Pre_6__c:'form.pre_challenge_skillz_girl_nih200.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Pre_7__c:'form.pre_challenge_skillz_girl_nih200.i_have_the_right_to_say_no_to_sex_no_matter_who_asks',
                Pre_8__c:'form.pre_challenge_skillz_girl_nih200.as_a_girl_i_have_a_greater_risk_of_getting_hiv_than_boys',
                Pre_9__c:'form.pre_challenge_skillz_girl_nih200.i_know_where_to_get_support_services_for_rape',
                Pre_10__c:'form.pre_challenge_skillz_girl_nih200.if_a_girl_is_sexually_abused_she_can_reduce_her_risk_of_getting_hiv_by_taki',
                Pre_11__c:'form.pre_challenge_skillz_girl_nih200.i_feel_good_about_being_a_girl',
                Pre_12__c:'form.pre_challenge_skillz_girl_nih200.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Pre_13__c:'form.pre_challenge_skillz_girl_nih200.boys_should_share_the_work_around_the_home_such_as_household_chores',
                Pre_14__c:'form.pre_challenge_skillz_girl_nih200.i_know_what_i_want_to_be_after_finishing_secondary_school',
                Pre_15__c:'form.pre_challenge_skillz_girl_nih200.if_i_have_a_problem_i_have_someone_in_my_life_i_can_talk_to_for_advise',
                Pre_16__c:'form.pre_challenge_skillz_girl_nih200.a_boyfriend_may_have_good_reason_to_hit_his_girlfriend',
                Pre_17__c:'form.pre_challenge_skillz_girl_nih200.i_would_tell_someone_if_i_were_touched_in_a_manner_that_made_me_uncomfortab',
                Pre_18__c:'form.pre_challenge_skillz_girl_nih200.i_can_reach_my_goals_in_life',
                Pre_19__c:'form.pre_challenge_skillz_girl_nih200.a_girl_should_wait_to_get_married_until_after_college',
                Pre_20__c:'form.pre_challenge_skillz_girl_nih200.biological_and_social_factors_contribute_to_females_and_males_experiencing_',
                Pre_21__c:'form.pre_challenge_skillz_girl_nih200.the_most_common_illness_of_mental_health_are_depression_and_anxiety',
                Pre_22__c:'form.pre_challenge_skillz_girl_nih200.mental_health_problems_have_nothing_to_do_with_being_lazy_or_weak_and_many_',
                Pre_23__c:'form.pre_challenge_skillz_girl_nih200.i_am_ready_to_take_an_hiv_test',
                Pre_24__c:'form.pre_challenge_skillz_girl_nih200.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
              },
              
              'pre_challenge_mindskillz_pamumvuri':{
                Pre_1__c: 'form.pre_challenge_mindskillz_pamumvuri.when_i_express_my_feelings_clearly_people_understand_me_better',
                Pre_2__c: 'form.pre_challenge_mindskillz_pamumvuri.i_have_skills_that_help_me_bounce_back_from_difficult_situations',
                Pre_3__c: 'form.pre_challenge_mindskillz_pamumvuri.stress_is_a_normal_part_of_life',
                Pre_4__c: 'form.pre_challenge_mindskillz_pamumvuri.i_can_reach_my_goals_in_life',
                Pre_5__c: 'form.pre_challenge_mindskillz_pamumvuri.if_i_have_a_problem_i_have_someone_in_my_life_i_can_go_to_for_support',
                Pre_6__c: 'form.pre_challenge_mindskillz_pamumvuri.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Pre_7__c: 'form.pre_challenge_mindskillz_pamumvuri.self_control_helps_you_make_smart_decisions_when_you_are_angry_or_upset',
                Pre_8__c: 'form.pre_challenge_mindskillz_pamumvuri.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                Pre_9__c: 'form.pre_challenge_mindskillz_pamumvuri.i_know_how_to_express_my_anger_without_being_violent',
                Pre_10__c: 'form.pre_challenge_mindskillz_pamumvuri.listening_carefully_to_others_is_an_important_communication_skill',
                Pre_11__c: 'form.pre_challenge_mindskillz_pamumvuri.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                Pre_12__c: 'form.pre_challenge_mindskillz_pamumvuri.i_can_understand_how_others_are_feeling_and_be_sensitive_to_their_emotions',
                Pre_13__c: 'form.pre_challenge_mindskillz_pamumvuri.i_am_confident_that_i_know_where_to_seek_information_about_mental_illness',
                Pre_14__c: 'form.pre_challenge_mindskillz_pamumvuri.i_am_confident_using_the_computer_or_telephone_to_seek_information_about_me',
                Pre_15__c: 'form.pre_challenge_mindskillz_pamumvuri.i_am_confident_attending_face_to_face_appointments_to_seek_information_abou',
                Pre_16__c: 'form.pre_challenge_mindskillz_pamumvuri.i_am_confident_i_have_access_to_resources_eg_doctor_internet_friends_that_i',
                Pre_17__c: 'form.pre_challenge_mindskillz_pamumvuri.people_with_mental_illness_could_snap_out_of_it_if_they_wanted',
                Pre_18__c: 'form.pre_challenge_mindskillz_pamumvuri.a_mental_illness_is_a_sign_of_personal_weakness',
                Pre_19__c: 'form.pre_challenge_mindskillz_pamumvuri.a_mental_illness_is_not_a_real_medical_illness',
                Pre_20__c: 'form.pre_challenge_mindskillz_pamumvuri.people_with_mental_illness_are_dangerous',
                Pre_21__c: 'form.pre_challenge_mindskillz_pamumvuri.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Pre_22__c: 'form.pre_challenge_mindskillz_pamumvuri.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Pre_23__c: 'form.pre_challenge_mindskillz_pamumvuri.seeing_a_mental_health_professional_means_you_are_not_strong_enough_to_mana',
                Pre_24__c: 'form.pre_challenge_mindskillz_pamumvuri.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi',
                Pre_25__c: 'form.pre_challenge_mindskillz_pamumvuri.i_believe_treatment_for_a_mental_illness_provided_by_a_mental_health_profes',
              },
              'pre_challenge_skillz_girl_-_zam_311': {
                Pre_1__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_what_i_am_good_at',
                Pre_2__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_how_to_overcome_challenges_that_i_may_face_in_my_life',
                Pre_3__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girl',
                Pre_4__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_would_be_able_to_ask_my_boyfriend_that_i_want_to_use_a_condom',
                Pre_5__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_can_say_no_to_sex_even_if_my_boyfriend_or_friends_pressure_me_to_have_sex',
                Pre_6__c: 'form.pre_challenge_skillz_girl_-_zam_311.if_i_am_sexually_active_i_go_to_a_healthcare_provider_to_get_protection_fro',
                Pre_7__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Pre_8__c: 'form.pre_challenge_skillz_girl_-_zam_311.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                Pre_9__c: 'form.pre_challenge_skillz_girl_-_zam_311.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Pre_10__c: 'form.pre_challenge_skillz_girl_-_zam_311.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_or_wife',
                Pre_11__c: 'form.pre_challenge_skillz_girl_-_zam_311.a_successful_marriage_is_more_important_to_girls_than_completing_school',
                Pre_12__c: 'form.pre_challenge_skillz_girl_-_zam_311.a_daughter_should_always_respect_her_parents_decision_for_her_to_get_marrie',
                Pre_13__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_can_decide_when_is_the_right_time_for_me_to_have_a_baby',
                Pre_14__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                Pre_15__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                Pre_16__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_gender_base',
                Pre_17__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_prevention_',
                Pre_18__c: 'form.pre_challenge_skillz_girl_-_zam_311.one_sign_of_pregnancy_is_a_girl_missing_her_period',
                Pre_19__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_at_least_three_methods_to_avoid_an_unwanted_pregnancy',
                Pre_20__c: 'form.pre_challenge_skillz_girl_-_zam_311.are_you_or_your_boyfriend_currently_using_any_contraceptive_method',
              },
              'pre_challenge_skillz_core_zambia_211':{
                Pre_1__c: 'form.pre_challenge_skillz_core_zambia_211.i_know_what_i_am_good_at',
                Pre_2__c: 'form.pre_challenge_skillz_core_zambia_211.i_know_how_to_overcome_challenges_i_may_have_in_my_life',
                Pre_3__c: 'form.pre_challenge_skillz_core_zambia_211.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                Pre_4__c: 'form.pre_challenge_skillz_core_zambia_211.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Pre_5__c: 'form.pre_challenge_skillz_core_zambia_211.i_dont_always_have_to_do_what_people_expect_because_i_am_a_boygirl',
                Pre_6__c: 'form.pre_challenge_skillz_core_zambia_211.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Pre_7__c: 'form.pre_challenge_skillz_core_zambia_211.girls_should_not_disagree_with_boys',
                Pre_8__c: 'form.pre_challenge_skillz_core_zambia_211.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                Pre_9__c: 'form.pre_challenge_skillz_core_zambia_211.i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Pre_10__c: 'form.pre_challenge_skillz_core_zambia_211.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                Pre_11__c: 'form.pre_challenge_skillz_core_zambia_211.if_i_test_positive_for_hivthere_will_be_someone_who_will_help_and_support_m',
                Pre_12__c: 'form.pre_challenge_skillz_core_zambia_211.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                Pre_13__c: 'form.pre_challenge_skillz_core_zambia_211.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                Pre_14__c: 'form.pre_challenge_skillz_core_zambia_211.i_know_where_to_get_support_services_for_me_or_someone_elsefor_hiv_-_relate',
                Pre_15__c: 'form.pre_challenge_skillz_core_zambia_211.i_know_where_to_get_support_services_for_me_or_someone_elsefor_abuse',
                Pre_16__c: 'form.pre_challenge_skillz_core_zambia_211.i_have_the_right_to_access_sexual_health_servicessuch_as_sti_and_hiv_testin',
                Pre_17__c: 'form.pre_challenge_skillz_core_zambia_211.one_sign_of_pregnancy_is_a_girl_missing_her_period',
                Pre_18__c: 'form.pre_challenge_skillz_core_zambia_211.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Pre_19__c: 'form.pre_challenge_skillz_core_zambia_211.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
                Pre_20__c: 'form.pre_challenge_skillz_core_zambia_211.i_know_what_decisions_to_make_to_achieve_my_goals',
              },
              'pre_challenge_skillz_boy_zambia110':{
                Pre_1__c: 'form.pre_challenge_skillz_boy_zambia110.in_general_i_feel_good_about_myself',
                Pre_2__c: 'form.pre_challenge_skillz_boy_zambia110.i_would_be_able_to_ask_my_girlfriend_that_i_want_to_use_a_condom',
                Pre_3__c: 'form.pre_challenge_skillz_boy_zambia110.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_boy',
                Pre_4__c: 'form.pre_challenge_skillz_boy_zambia110.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Pre_5__c: 'form.pre_challenge_skillz_boy_zambia110.it_is_more_important_for_boys_to_be_educated_than_girls',
                Pre_6__c: 'form.pre_challenge_skillz_boy_zambia110.men_are_better_leaders_than_women',
                Pre_7__c: 'form.pre_challenge_skillz_boy_zambia110.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Pre_8__c: 'form.pre_challenge_skillz_boy_zambia110.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                Pre_9__c: 'form.pre_challenge_skillz_boy_zambia110.it_is_okay_for_a_boyfriend_to_threaten_to_hit_his_girlfriend_if_he_never_hi',
                Pre_10__c: 'form.pre_challenge_skillz_boy_zambia110.i_can_say_no_to_sex_even_if_my_friends_or_girlfriend_pressure_me_to_have_se',
                Pre_11__c: 'form.pre_challenge_skillz_boy_zambia110.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_sexual_behaviou',
                Pre_12__c: 'form.pre_challenge_skillz_boy_zambia110.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Pre_13__c: 'form.pre_challenge_skillz_boy_zambia110.i_have_a_friend_that_i_can_go_to_for_advice_when_i_have_a_problem',
                Pre_14__c: 'form.pre_challenge_skillz_boy_zambia110.i_have_the_right_to_access_sexual_health_services_such_as_hiv_and_sti_testi',
                Pre_15__c: 'form.pre_challenge_skillz_boy_zambia110.i_know_where_to_access_sexual_health_services_such_as_sti_and_hiv_testing',
                Pre_16__c: 'form.pre_challenge_skillz_boy_zambia110.before_making_a_decision_i_think_about_how_it_can_affect_me_or_others',
                Pre_17__c: 'form.pre_challenge_skillz_boy_zambia110.i_know_how_to_express_my_anger_without_being_violent_such_as_hitting_kickin',
                Pre_18__c: 'form.pre_challenge_skillz_boy_zambia110.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                Pre_19__c: 'form.pre_challenge_skillz_boy_zambia110.i_know_how_to_correctly_use_a_male_condom',
                Pre_20__c: 'form.pre_challenge_skillz_boy_zambia110.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
           
              },
              'pre_challenge_skillz_guyz_mh_-_sa_100':{
                Pre_1__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_have_to_be_respectful_communicate_and_take_action_to_be_a_role_model_in_m',
                Pre_2__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_have_skills_that_help_me_bounce_back_from_difficult_situations',
                Pre_3__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_can_identify_my_strengths_or_things_that_i_am_good_at',
                Pre_4__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.when_i_am_angry_i_know_how_to_avoid_using_violent_behaviour',
                Pre_5__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.when_i_express_my_feelings_clearly_people_understand_me_better',
                Pre_6__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Pre_7__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.sadness_and_a_loss_of_pleasure_in_things_you_enjoy_are_common_symptoms_of_d',
                Pre_8__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_know_where_to_access_health_services_and_mental_health_services',
                Pre_9__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_will_share_accurate_information_about_mental_health_services_to_avoid_sti',
                Pre_10__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                Pre_11__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.men_should_share_the_work_around_the_house_such_as_cleaning_and_taking_care',
                Pre_12__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.its_okay_for_a_guy_to_beat_a_girl_when_there_is_a_misunderstanding',
                Pre_13__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_should_respect_the_rights_of_others_such_as_their_right_to_their_own_opin',
                Pre_14__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_feel_confident_setting_my_goals',
                Pre_15__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.stress_is_a_normal_part_of_life',
                Pre_16__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Pre_17__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.there_are_people_i_trust_with_whom_i_can_talk_to_about_my_mental_health',
                Pre_18__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_have_no_fear_or_shame_when_accessing_health_services_or_mental_health_ser',
                Pre_19__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                Pre_20__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Pre_21__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_can_stand_up_to_peer_pressure_when_i_have_to',
                Pre_22__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_should_use_a_condom_even_if_my_girlfriend_is_on_another_form_of_birth_con',
                Pre_23__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_know_where_to_go_for_support_if_i_or_someone_i_know_abuses_alcohol',
              },
              
                  
              'pre_challenge_south_africa_-_skillz_girl_mh_sa_211':{
                Pre_1__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_my_rights_and_responsibilities',
                Pre_2__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Pre_3__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Pre_4__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.stress_is_a_normal_part_of_life',
                Pre_5__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.like_physical_health_we_all_have_mental_health',
                Pre_6__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Pre_7__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.healthy_relationships_are_based_on_healthy_communication_and_mutual_respect',
                Pre_8__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_partner_or_wif',
                Pre_9__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Pre_10__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Pre_11__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.taking_prep_and_using_a_condom_can_lower_my_risk_of_getting_hiv',
                Pre_12__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Pre_13__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Pre_14__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.post_exposure_prophylaxis_pep_can_reduce_my_risk_of_getting_hiv_if_taken_1-',
                Pre_15__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.it_is_my_right_to_access_health_services',
                Pre_16__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_have_an_adult_or_someone_in_my_life_i_can_go_to_for_advice',
                Pre_17__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_give_support_and_encouragement_to_a_friend_or_family_member_who_is_li',
                Pre_18__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.using_a_condom_and_another_contraceptive_method_can_help_prevent_unwanted_p',
                Pre_19__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Pre_20__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.drinking_too_much_alcohol_can_harm_the_body_and_the_mind',
              },
              
               'pre_challenge_skillz_girl_abbreviated_south_africa':{
                Pre_1__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_know_my_rights_and_responsibilities',
                Pre_2__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Pre_3__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Pre_4__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.stress_is_a_normal_part_of_life',
                Pre_5__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.like_physical_health_we_all_have_mental_health',
                Pre_6__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Pre_7__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.in_a_relationship_it_is_both_partners_responsibility_to_prevent_unwanted_pr',
                Pre_8__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.healthy_relationships_are_based_on_healthy_communication_and_respect',
                Pre_9__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_partner_or_wif',
                Pre_10__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.a_person_has_the_right_to_have_sex_with_their_partner_even_if_the_partner_d',
                Pre_11__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Pre_12__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Pre_13__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.taking_prep_and_using_a_condom_can_lower_my_risk_of_getting_hiv',
                Pre_14__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Pre_15__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Pre_16__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_can_use_coping_skills_to_handle_stress',
                Pre_17__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.post_exposure_prophylaxis_pep_can_reduce_my_risk_of_getting_hiv_if_taken_1-',
                Pre_18__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.it_is_my_right_to_access_health_services',
                Pre_19__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_have_an_adult_or_someone_in_my_life_i_can_go_to_for_advice',
                Pre_20__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.using_a_condom_and_another_contraceptive_method_can_help_prevent_unwanted_p',
                Pre_21__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Pre_22__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.drinking_too_much_alcohol_can_harm_the_body_and_mind',
                Pre_23__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_know_at_least_two_ways_of_saving_money',
                Pre_24__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.a_budget_is_the_estimated_income_and_expenses_for_a_certain_time_period',
                Pre_25__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.accepting_money_for_sexual_favors_can_create_risks_to_my_health_and_safety',
                Pre_26__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.using_assertive_communication_means_respectfully_sharing_my_thoughts_and_fe',
                Pre_27__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_have_the_right_to_access_emergency_contraception',
                Pre_28__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.if_a_girl_has_unprotected_sex_and_misses_her_period_this_could_mean_she_is_',
              },
              
              'pre_challenge_skillz_guyz_-_yedi__323':{
                 Pre_1__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_know_how_to_stand_up_to_peer_pressure_ie_to_drink_alcohol_or_have_sex_fro',
                 Pre_2__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Pre_3__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_have_someone_i_can_go_to_for_advice',
                 Pre_4__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.no_one_has_the_right_to_touch_me_in_a_way_that_makes_me_uncomfortable_such_',
                 Pre_5__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                 Pre_6__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_behaviours_such',
                 Pre_7__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                 Pre_8__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.a_mental_illness_is_a_sign_of_personal_weakness',
                 Pre_9__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Pre_10__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                 Pre_11__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.a_boys_opinion_is_more_important_than_a_girls',
                 Pre_12__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.men_should_share_the_work_around_the_house_such_as_cleaning_and_taking_care',
                 Pre_13__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.its_okay_for_a_guy_to_beat_a_girl_when_she_misbehaves',
                 Pre_14__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Pre_15__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                 Pre_16__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.condoms_are_the_only_contraceptive_method_that_protect_against_pregnancy_as',
                 Pre_17__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_would_stand_up_to_my_friends_if_they_were_harming_others_such_as_touching',
                 Pre_18__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                 Pre_19__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                 Pre_20__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_have_the_ability_to_shape_my_own_life',
              },
              
              'pre_challenge_skillz_girl_mh_zambia':{
                 Pre_1__c: 'form.pre_challenge_skillz_girl_mh_zambia.a_mental_illness_is_a_sign_of_personal_weakness',
                 Pre_2__c: 'form.pre_challenge_skillz_girl_mh_zambia.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Pre_3__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girl',
                 Pre_4__c: 'form.pre_challenge_skillz_girl_mh_zambia.if_i_had_a_boyfriend_i_would_be_able_to_ask_him_to_use_a_condom_before_havi',
                 Pre_5__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_can_say_no_to_sex_even_if_my_boyfriend_or_friends_pressure_to_have_sex',
                 Pre_6__c: 'form.pre_challenge_skillz_girl_mh_zambia.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Pre_7__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                 Pre_8__c: 'form.pre_challenge_skillz_girl_mh_zambia.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Pre_9__c: 'form.pre_challenge_skillz_girl_mh_zambia.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                 Pre_10__c: 'form.pre_challenge_skillz_girl_mh_zambia.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_or_wife',
                 Pre_11__c: 'form.pre_challenge_skillz_girl_mh_zambia.a_successful_marrige_is_more_important_to_girls_than_completing_school',
                 Pre_12__c: 'form.pre_challenge_skillz_girl_mh_zambia.a_daughter_should_always_respect_her_parents_decision_to_get_married',
                 Pre_13__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_can_decide_when_is_the_right_time_for_me_to_have_a_baby',
                 Pre_14__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                 Pre_15__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                 Pre_16__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_gender_base',
                 Pre_17__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_prevention_',
                 Pre_18__c: 'form.pre_challenge_skillz_girl_mh_zambia.if_sexually_active_one_sign_of_pregnance_is_a_girl_missing_her_period',
                 Pre_19__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_know_at_least_three_methods_to_avoid_an_unwanted_pregnancy',
                 Pre_20__c: 'form.pre_challenge_skillz_girl_mh_zambia.are_you_or_your_boyfriend_currently_using_any_contraceptive_method',
              },
              
              'pre_challenge_skillz_core_mh_zambia':{
                 Pre_1__c: 'form.pre_challenge_skillz_core_mh_zambia.i_know_what_i_am_good_at',
                 Pre_2__c: 'form.pre_challenge_skillz_core_mh_zambia.i_know_how_to_overcome_challenges_that_i_may_have_in_life',
                 Pre_3__c: 'form.pre_challenge_skillz_core_mh_zambia.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                 Pre_4__c: 'form.pre_challenge_skillz_core_mh_zambia.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                 Pre_5__c: 'form.pre_challenge_skillz_core_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girlboy',
                 Pre_6__c: 'form.pre_challenge_skillz_core_mh_zambia.a_man_has_the_right_to_have_sex_with_his_wifegirlfriend_even_if_she_doesnt_',
                 Pre_7__c: 'form.pre_challenge_skillz_core_mh_zambia.girls_should_not_disagree_with_boys',
                 Pre_8__c: 'form.pre_challenge_skillz_core_mh_zambia.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                 Pre_9__c: 'form.pre_challenge_skillz_core_mh_zambia.i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                 Pre_10__c: 'form.pre_challenge_skillz_core_mh_zambia.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                 Pre_11__c: 'form.pre_challenge_skillz_core_mh_zambia.if_i_test_positive_for_hiv_there_will_be_someone_who_will_help_and_support_',
                 Pre_12__c: 'form.pre_challenge_skillz_core_mh_zambia.people_with_mental_illness_live_on_the_streets_and_eat_dirty_food_from_garb',
                 Pre_13__c: 'form.pre_challenge_skillz_core_mh_zambia.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                 Pre_14__c: 'form.pre_challenge_skillz_core_mh_zambia.i_only_use_violent_behaviour_when_someone_angers_me',
                 Pre_15__c: 'form.pre_challenge_skillz_core_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_abuse_or_hi',
                 Pre_16__c: 'form.pre_challenge_skillz_core_mh_zambia.i_have_the_right_to_access_sexual_health_services_such_as_sti_and_hiv_testi',
                 Pre_17__c: 'form.pre_challenge_skillz_core_mh_zambia.if_sexually_active_one_sign_of_pregnancy_can_be_a_girl_missing_her_period',
                 Pre_18__c: 'form.pre_challenge_skillz_core_mh_zambia.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                 Pre_19__c: 'form.pre_challenge_skillz_core_mh_zambia.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
                 Pre_20__c: 'form.pre_challenge_skillz_core_mh_zambia.i_know_what_decisions_to_make_to_achieve_my_goals',
              },
              
              'pre_challenge_skillz_guyz_mh_zambia':{
                 Pre_1__c: 'form.pre_challenge_skillz_guyz_mh_zambia.a_mental_illness_is_a_sign_of_personal_weakness',
                 Pre_2__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_would_be_able_to_tell_my_girlfriend_that_i_want_to_use_a_condom',
                 Pre_3__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_boy',
                 Pre_4__c: 'form.pre_challenge_skillz_guyz_mh_zambia.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                 Pre_5__c: 'form.pre_challenge_skillz_guyz_mh_zambia.it_is_more_important_for_boys_to_be_educated_than_girls',
                 Pre_6__c: 'form.pre_challenge_skillz_guyz_mh_zambia.men_are_better_leaders_than_women',
                 Pre_7__c: 'form.pre_challenge_skillz_guyz_mh_zambia.a_manboy_has_the_right_to_have_sex_with_his_girlfriendwomanwife_even_if_she',
                 Pre_8__c: 'form.pre_challenge_skillz_guyz_mh_zambia.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Pre_9__c: 'form.pre_challenge_skillz_guyz_mh_zambia.it_is_okay_for_a_boyfriend_to_threaten_to_hit_his_girlfriend_if_he_never_hi',
                 Pre_10__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_can_say_no_to_sex_even_if_my_friends_or_girlfriend_pressure_me_to_have_se',
                 Pre_11__c: 'form.pre_challenge_skillz_guyz_mh_zambia.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_sexual_behaviou',
                 Pre_12__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                 Pre_13__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_have_a_friend_that_i_can_go_to_for_advice_when_i_have_a_problem',
                 Pre_14__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_have_the_right_to_access_sexual_health_services_such_as_hiv_and_sti_testi',
                 Pre_15__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_know_where_to_access_sexual_health_services_such_as_sti_and_hiv_testing',
                 Pre_16__c: 'form.pre_challenge_skillz_guyz_mh_zambia.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Pre_17__c: 'form.pre_challenge_skillz_guyz_mh_zambia.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Pre_18__c: 'form.pre_challenge_skillz_guyz_mh_zambia.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                 Pre_19__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_know_how_to_correctly_use_a_male_condom',
                 Pre_20__c: 'form.pre_challenge_skillz_guyz_mh_zambia.are_you_or_your_girlfriend_currently_using_any_contraceptive_or_protective_',
                 
              },

               'pre_challenge_mindskillz_sa_10':{
                Pre_1__c: 'form.pre_challenge_mindskillz_sa_10.mental_health_is_about_how_we_think_feel_and_act',
                Pre_2__c: 'form.pre_challenge_mindskillz_sa_10.i_can_name_the_feelings_i_have_when_im_happy_sad_or_angry',
                Pre_3__c: 'form.pre_challenge_mindskillz_sa_10.i_know_how_to_share_my_feelings_with_other_people_in_healthy_ways',
                Pre_4__c: 'form.pre_challenge_mindskillz_sa_10.mental_health_is_the_same_thing_as_mental_illness',
                Pre_5__c: 'form.pre_challenge_mindskillz_sa_10.stress_is_a_normal_part_of_life_but_too_much_stress_can_hurt_your_mental_he',
                Pre_6__c: 'form.pre_challenge_mindskillz_sa_10.i_can_tell_when_stress_is_making_me_feel_upset',
                Pre_7__c: 'form.pre_challenge_mindskillz_sa_10.i_know_two_ways_to_calm_myself_down_when_i_feel_stressed',
                Pre_8__c: 'form.pre_challenge_mindskillz_sa_10.taking_care_of_my_mental_health_can_help_me_achieve_my_goals',
                Pre_9__c: 'form.pre_challenge_mindskillz_sa_10.i_can_identify_my_strengths_or_things_i_am_good_at',
                Pre_10__c: 'form.pre_challenge_mindskillz_sa_10.i_know_how_to_support_my_friends_in_making_good_choices_for_their_mental_he',
                Pre_11__c: 'form.pre_challenge_mindskillz_sa_10.i_can_name_three_people_i_can_talk_to_if_i_need_help',
                Pre_12__c: 'form.pre_challenge_mindskillz_sa_10.i_know_of_adults_or_places_in_my_community_that_can_give_me_mental_health_s',
                Pre_13__c: 'form.pre_challenge_mindskillz_sa_10.i_can_deal_with_anger_without_being_violent',
                Pre_14__c: 'form.pre_challenge_mindskillz_sa_10.drinking_alcohol_can_harm_my_mental_and_physical_health',
                Pre_15__c: 'form.pre_challenge_mindskillz_sa_10.i_can_say_no_to_peer_pressure_like_being_asked_to_drink_alcohol',
                Pre_16__c: 'form.pre_challenge_mindskillz_sa_10.i_have_talked_to_someone_about_mental_health_in_the_last_month_outside_of_m',
                Pre_17__c: 'form.pre_challenge_mindskillz_sa_10.people_with_mental_illness_are_dangerous',
                Pre_18__c: 'form.pre_challenge_mindskillz_sa_10.a_mental_illness_is_a_sign_of_personal_weakness',
                Pre_19__c: 'form.pre_challenge_mindskillz_sa_10.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Pre_20__c: 'form.pre_challenge_mindskillz_sa_10.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Pre_21__c: 'form.pre_challenge_mindskillz_sa_10.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi'

              },

               'pre_challenge_mindskillz_zambia_2025':{
                Pre_1__c: 'form.pre_challenge_mindskillz_zambia_2025.mental_health_is_about_how_we_think_feel_and_act',
                Pre_2__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_name_the_feelings_i_have_when_im_happy_sad_or_angry',
                Pre_3__c: 'form.pre_challenge_mindskillz_zambia_2025.i_know_how_to_share_my_feelings_with_other_people_in_healthy_ways',
                Pre_4__c: 'form.pre_challenge_mindskillz_zambia_2025.mental_health_is_the_same_thing_as_mental_illness',
                Pre_5__c: 'form.pre_challenge_mindskillz_zambia_2025.stress_is_a_normal_part_of_life_but_too_much_stress_can_hurt_your_mental_he',
                Pre_6__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_tell_when_stress_is_making_me_feel_upset',
                Pre_7__c: 'form.pre_challenge_mindskillz_zambia_2025.i_know_two_ways_to_calm_myself_down_when_i_feel_stressed',
                Pre_8__c: 'form.pre_challenge_mindskillz_zambia_2025.taking_care_of_my_mental_health_can_help_me_achieve_my_goals',
                Pre_9__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_identify_my_strengths_or_things_i_am_good_at',
                Pre_10__c: 'form.pre_challenge_mindskillz_zambia_2025.i_know_how_to_support_my_friends_in_making_good_choices_for_their_mental_he',
                Pre_11__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_name_three_people_i_can_talk_to_if_i_need_help',
                Pre_12__c: 'form.pre_challenge_mindskillz_zambia_2025.i_know_of_adults_or_places_in_my_community_that_can_give_me_mental_health_s',
                Pre_13__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_deal_with_anger_without_being_violent',
                Pre_14__c: 'form.pre_challenge_mindskillz_zambia_2025.drinking_alcohol_can_harm_my_mental_and_physical_health',
                Pre_15__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_say_no_to_peer_pressure_like_being_asked_to_drink_alcohol',
                Pre_16__c: 'form.pre_challenge_mindskillz_zambia_2025.i_have_talked_to_someone_about_mental_health_in_the_last_month_outside_of_m',
                Pre_17__c: 'form.pre_challenge_mindskillz_zambia_2025.people_with_mental_illness_are_dangerous',
                Pre_18__c: 'form.pre_challenge_mindskillz_zambia_2025.a_mental_illness_is_a_sign_of_personal_weakness',
                Pre_19__c: 'form.pre_challenge_mindskillz_zambia_2025.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Pre_20__c: 'form.pre_challenge_mindskillz_zambia_2025.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Pre_21__c: 'form.pre_challenge_mindskillz_zambia_2025.if_i_had_a_mental_illness_i_would_not_seek_help_from_a_mental_health_profes'
              }

              

            };

            const pluckSfValue = val => {
              return sfFieldMapping[formVersion][val];
            };

            return { ...state, pluckSfValue };
          });

          // fn(state => {
          //   console.log("test")
          //   console.log(state.pluckSfValue('Pre_1__c'));
          //   return state;
          // });

          fn(state => {
            const PID = lastReferenceValue('records[0].Participant_Identification_Number_PID__c')(state);

            if (!PID) {
              console.log(
                `Participant not found with Participant_Identification_Number_PID__c: ${state.data.form.case['@case_id']}`
              );
              return state;
            }

            return upsert(
              'Attendance__c',
              'CommCare_Ext_ID__c',
              fields(
                //field('Event__c', dataValue('form.hidden_properties.intervention_name')),
                //relationship('Event__r', 'CommCare_Ext_ID__c', dataValue('form.hidden_properties.intervention_name')),
                relationship('Person_Attendance__r', 'Participant_Identification_Number_PID__c', dataValue('form.case.@case_id')),
                // relationship('Person_Attendance__r','CommCare_Ext_ID__c', state => {
                //   return (
                //     dataValue('form.hidden_properties.participant_first_name')(state) +
                //     dataValue('form.hidden_properties.participant_surname')(state)
                //   )
                // }),

                // field('CommCare_Ext_ID__c', state => {
                //   return `${dataValue('form.case.@case_id')(state)}-${scrubEmojis(
                //     dataValue('form.hidden_properties.intervention_name')(state),
                //     ''
                //   ).replace(/\//gi, '')}`;
                // }),
                field("CommCare_Ext_ID__c", (state) => {
                  return toUTF8(`${dataValue("form.case.@case_id")(state)}-${scrubEmojis(
                  dataValue("form.hidden_properties.intervention_name")(state),
                  ""
                  ).replace(/\//gi, "")}`);
                  }),

                //field(
                //'Person_Attendance__c',
                // state =>
                //   dataValue('form.hidden_properties.participant_first_name')(state) +
                //    ' ' +
                //   dataValue('form.hidden_properties.participant_surname')(state)
                //),
                field('Gender__c', dataValue('form.hidden_properties.gender')),
                field('Grade__c', state => {
                  const grade = dataValue('form.hidden_properties.grade')(state);
                  return grade ? grade.replace(/\D/g, '') : undefined;
                }),
                field('Class__c', dataValue('form.hidden_properties.class')),
                field('Pre_Post_Completed__c', state => {
                  var done = dataValue('form.hidden_properties.pre_questionnaire_complete')(state);
                  return done === 'Yes' ? true : done === 'No' ? false : undefined;
                }),
                field('Date_Pre_Administered__c', dataValue('form.date')),
                field('Pre_1__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_1__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_2__c', state => {
                  if (state.pluckSfValue('Pre_2__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_2__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                
                field('Pre_3__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_3__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                
                field('Pre_4__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_4__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                
                field('Pre_5__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_5__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_6__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_6__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_7__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_7__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_8__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_8__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_9__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_9__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_10__c', state => {
                  if (state.pluckSfValue('Pre_10__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_10__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_11__c', state => {
                  if (state.pluckSfValue('Pre_11__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_10__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_12__c', state => {
                  if (state.pluckSfValue('Pre_12__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_12__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_13__c', state => {
                  if (state.pluckSfValue('Pre_13__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_13__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_14__c', state => {
                  if (state.pluckSfValue('Pre_14__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_14__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_15__c', state => {
                  if (state.pluckSfValue('Pre_15__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_15__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_16__c', state => {
                  if (state.pluckSfValue('Pre_16__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_16__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_17__c', state => {
                  if (state.pluckSfValue('Pre_17__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_17__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_18__c', state => {
                  if (state.pluckSfValue('Pre_18__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_18__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_19__c', state => {
                  if (state.pluckSfValue('Pre_19__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_19__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_20__c', state => {
                  if (state.pluckSfValue('Pre_20__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_20__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_21__c', state => {
                  if (state.pluckSfValue('Pre_21__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_21__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_22__c', state => {
                  if (state.pluckSfValue('Pre_22__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_22__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_23__c', state => {
                  if (state.pluckSfValue('Pre_23__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_23__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_24__c', state => {
                  if (state.pluckSfValue('Pre_24__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_24__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_25__c', state => {
                  if (state.pluckSfValue('Pre_25__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_25__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_26__c', state => {
                  if (state.pluckSfValue('Pre_26__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_26__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_27__c', state => {
                  if (state.pluckSfValue('Pre_27__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_27__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_28__c', state => {
                  if (state.pluckSfValue('Pre_28__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_28__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
              )
            )(state);
          });

          //Removing mapping... need case_id to upsert Events. Date_of_Pre__c update should be handled on the SF side.
          // upsert(
          //   'Event__c',
          //   'CommCare_Ext_ID__c',
          //   fields(
          //     field('CommCare_Ext_ID__c', dataValue('form.hidden_properties.intervention_name')),
          //     field('Date_of_Pre__c', dataValue('form.date')),

          //   )
          // );
    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Pre-Challenges:
        source_trigger: webhook
        target_job: Upsert-Pre-Challenges
        condition_type: js_expression
        condition_label: Pre Challenges
        condition_expression: |
          state.data.form["@name"] == "Pre Challenges" && state.data.form["hidden_properties"]["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  Upsert-Service-Referral:
    name: Upsert Service Referral
    jobs:
      Upsert-Service-Referral:
        name: Upsert Service Referral
        adaptor: '@openfn/language-salesforce@4.8.6'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          alterState(state => {
            function checked(key, str) {
              if (!str) return false;
              return str.split(' ').indexOf(key) >= 0;
            }

            state.helperFunctions = { checked };

            function capitalizeFirstLetter(str) {
              if (!str) return;
              let new_str = str.toString().toLowerCase();
              return new_str.slice(0, 1).toUpperCase() + new_str.slice(1);
            }

            function transform(value) {
              if (!value) return;
              switch (value.toString().trim()) {
                case 'Daughterson':
                  return 'Daughter/Son';
                case 'Other_specify':
                  return 'Other';
                case 'Single_never_married':
                  return 'Single/Never Married';
                case 'Divorced__separated':
                  return 'Divorced/separated';
                default:
                  return value;
              }
            }

            state.data.form.parent__guardian_information.relationship_to_client = transform(
              capitalizeFirstLetter(state.data.form.parent__guardian_information.relationship_to_client)
            );

            return state;
          });

          alterState(state => {
            if (!state.data.form.subcase_0) {
              console.log('No referral services to upsert');
              return state;
            }
            return upsert(
              'NewReferral__c',
              'CommCare_Ext_ID__c',
              fields(
                //  field('Enter_Partner_s_Name__c', dataValue('form.referral_information.institution_referred_to')),
                //  field('Type_of_Referral__c', dataValue('form.referral_information.type_of_referral')),
                field('Participants_Full_Name__c', dataValue('form.client_registration.participant_full_name')),
                //field('Parent_Guardian_Contact_Number__c', dataValue('form.client_registration.mobile_number')),
                relationship('Event__r', 'CommCare_Case_ID__c', dataValue('form.event_name')),
                field('CommCare_Ext_ID__c', state => {
                  var subid = state.data.form.subcase_0;
                  return subid && subid !== '' ? state.data.form.subcase_0.case['@case_id'] : dataValue('id')(state); //Set external id to 'service' subcase if available, otherwise use formid
                }),
                //field('Venue__c', dataValue('form.client_registration.school_name')),
                //field('Grade__c', dataValue('form.client_registration.grade')),
                //field('Class__c', dataValue('form.client_registration.class')),
                field('Parent_Guardian_Full_Name__c', dataValue('form.parent__guardian_information.parent__guardian_full_name')),
                field('Relationship_To_Client__c', dataValue('form.parent__guardian_information.relationship_to_client')),
                field('Parent_Guardian_Contact_Number__c', dataValue('form.parent__guardian_information.contact_number')),
                field('Institution_Referred_To_1__c', dataValue('form.referral_information.institution_referred_to')),
                field('Institution_Referred_To_2__c', dataValue('form.referral_information.copy-1-of-institution_referred_to')),
                field('Institution_Referred_To_3__c', dataValue('form.referral_information.copy-2-of-institution_referred_to')),
                field('Service_Provider_Name__c', dataValue('form.hidden_props.coach_name')),
                field('HIV_Testing_Services_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'hiv_testing_services',
                    dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('VMMC_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'vmmc',
                    dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('TB_Screening_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'tb_screening_treatment_adherence',
                    dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('Post_Exposure_Prophylaxis_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'post_exposure_prophylaxis',
                    dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('PrEP_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'prep',
                    dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('HIV_STI_PREVENTION_Other_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'other',
                    dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('HIV_Other__c', dataValue('form.referral_services.hiv_support__care.please_specify')),
                field('ART_Initiation_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'art_initiationenrollment',
                    dataValue('form.referral_services.art_support_services.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('PMTCT_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'pmtct',
                    dataValue('form.referral_services.art_support_services.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('SKILLZ_Plus_Club_Support_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'grs_skillz_plus_club',
                    dataValue('form.referral_services.art_support_services.skillz_plus_club_option')(state)
                  )
                ),
                field(
                  'Victim_Friendly_Services_GRS_Staff__c',
                  state =>
                    state.helperFunctions.checked(
                      'suspected_abuse_reported_police_court_other_authority',
                      dataValue(
                        'form.referral_services.child_protection_support_services.check_the_services_that_client_was_referred_to'
                      )(state)
                    ) ||
                    state.helperFunctions.checked(
                      'post_violence_care_medical_legal_counseling',
                      dataValue(
                        'form.referral_services.child_protection_support_services.check_the_services_that_client_was_referred_to'
                      )(state)
                    ) ||
                    state.helperFunctions.checked(
                      'child_support_grant_social_foster_general_support',
                      dataValue(
                        'form.referral_services.child_protection_support_services.check_the_services_that_client_was_referred_to'
                      )(state)
                    ) ||
                    state.helperFunctions.checked(
                      'other',
                      dataValue(
                        'form.referral_services.child_protection_support_services.check_the_services_that_client_was_referred_to'
                      )(state)
                    )
                ),
                field('Business_Unit_Site__c', state => {
                  const bu = dataValue('form.business_unit')(state);
                  return bu === '65680f0c4c144b03ad0f86bdc46c1ebc'
                    ? 'GRS Zambia'
                    : bu === '04d98397e28046118fade28ced6b65cb'
                    ? 'GRS Zimbabwe'
                    : bu === 'ed125ab19ec34aacab79585e59eb76f4'
                    ? 'GRS Partnerships'
                    : undefined;
                }),
                field(
                  'Sexual_and_GBV_Abuse_GRS_Staff__c',
                  dataValue('form.referral_services.child_protection_support_services.abuse_reported_to')
                ),

                field('Legal_Other__c', dataValue('form.referral_services.legal_services.please_specify_other_legal')),
                field(
                  'Legal_Services_Other_GRS_Staff__c',
                  state =>
                    state.helperFunctions.checked(
                      'other',
                      dataValue('form.referral_services.legal_services.legal_services')(state)
                    ) ||
                    state.helperFunctions.checked(
                      'id',
                      dataValue('form.referral_services.legal_services.legal_services')(state)
                    ) ||
                    state.helperFunctions.checked(
                      'birth_bertificate',
                      dataValue('form.referral_services.legal_services.legal_services')(state)
                    )
                ),
                field('STI_Screen_Testing_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'sti_screening_diagnosis_treatment',
                    dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('Contraception_Family_Plan_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'contraceptivesfamily_planning',
                    dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('Cervical_Cancer_Screening_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'cervical_cancer_screening',
                    dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('HPV_vaccine_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'hpv',
                    dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('Antenatal_Care_ANC_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'antenatal_care_anc',
                    dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('Sexual_and_GBV_Abuse_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'based_violenceabus',
                    dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field(
                  'Psycho_Social_Support_GRS_Staff__c',
                  state =>
                    state.helperFunctions.checked(
                      'drug_or_alcohol_abuse',
                      dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(
                        state
                      )
                    ) ||
                    state.helperFunctions.checked(
                      'psychiatric_careintensive_counseling',
                      dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(
                        state
                      )
                    ) ||
                    state.helperFunctions.checked(
                      'psychosocial_support',
                      dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(
                        state
                      )
                    )
                ),
                field('Psycho_Social_Services_Other_GRS_Staff__c', state =>
                  state.helperFunctions.checked(
                    'other',
                    dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                  )
                ),
                field('Psycho_Other__c', dataValue('form.referral_services.other_srhr_services.please_specify_srhr_referred')),
                field('Date_Referred__c', dataValue('form.follow-up.date_referred')),
                field('Expected_Visit_Date__c', dataValue('form.follow-up.expected_visit_date')),
                field('Client_Follow_up_Consent_given__c', state =>
                  state.helperFunctions.checked('client_follow-up_consent_given', dataValue('form.follow-up.select')(state))
                ),
                field('Client_Linked_to_care__c', state =>
                  state.helperFunctions.checked('client_linked_to_care', dataValue('form.follow-up.select')(state))
                )
              )
            )(state);
          });

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Service-Referral:
        source_trigger: webhook
        target_job: Upsert-Service-Referral
        condition_type: js_expression
        condition_label: Service Referral
        condition_expression: |
          state.data.form["@name"] == "Service Referral" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  Upsert-Home-Visit-Log-Form:
    name: Upsert Home Visit Log Form
    jobs:
      Upsert-Home-Visit-Log-Form:
        name: Upsert Home Visit Log Form
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // push to production

          query(
            `SELECT Participant_Identification_Number_PID__c from Person__c where Participant_Identification_Number_PID__c  = '${state.data.form.case['@case_id']}'`
          );

          fn(state => {
            const PID = lastReferenceValue('records[0].Participant_Identification_Number_PID__c')(state);
            if (!PID) {
              console.log(
                `Participant not found with Participant_Identification_Number_PID__c: ${state.data.form.case['@case_id']}`
              );
              return state;
            }

            return execute(
              fn(state => {
                const { form } = state.data;
                const { basic_information } = form;
                if (basic_information.intervention_hidden) {
                  return query(
                    `SELECT Id, Event__c, CreatedDate, Person_Attendance__c
                  FROM Attendance__c
                  WHERE Person_Attendance__r.Participant_Identification_Number_PID__c = '${form.case['@case_id']}'
                  ORDER BY CreatedDate DESC LIMIT 1`
                  )(state).then(state => {
                    const { records } = state.references[0];
                    const eventId = records[0].Event__c;
                    state.data.eventField = [field('Event__c', eventId)];
                    return state;
                  });
                  // state.data.eventField = [
                  //   relationship('Event__r', 'CommCare_Ext_ID__c', dataValue('form.basic_information.intervention_hidden')(state)),
                  // ];
                  // return state;
                } else {
                  return query(
                    `SELECT Id, Event__c, CreatedDate, Person_Attendance__c
                  FROM Attendance__c
                  WHERE Person_Attendance__r.Participant_Identification_Number_PID__c = '${form.case['@case_id']}'
                  ORDER BY CreatedDate DESC LIMIT 1`
                  )(state).then(state => {
                    const { records } = state.references[0];
                    const eventId = records[0].Event__c;
                    state.data.eventField = [field('Event__c', eventId)];
                    return state;
                  });
                }
              }),

              upsert('Home_Visit__c', 'CommCare_Ext_ID__c', state => ({
                ...fields(
                  field('CommCare_Ext_ID__c', dataValue('id')),
                  // relationship('Event__r', 'CommCare_Ext_ID__c', dataValue('form.basic_information.intervention_hidden')),
                  relationship('Person_visiting__r', 'Participant_Identification_Number_PID__c', dataValue('form.case.@case_id')),
                  //=== NOTE: We do not need to map People information because Home Visit is related to Person. ======//
                  //This info already lives on the Person-level.
                  // field('First_Name__c', dataValue('form.basic_information.participant_first_name')),
                  // field('Surname__c', dataValue('form.basic_information.participant_surname')),
                  // field('Sex__c', dataValue('form.basic_information.gender')),
                  // field('Date_of_Birth__c', dataValue('form.basic_information.date_of_birth')),
                  // field('Physical Address Community City', dataValue('form.basic_information.participant_address')),
                  //================
                  field('Mobile_Number__c', dataValue('form.basic_information.Mobile_number')),
                  field('Consent_Given__c', dataValue('form.basic_information.consent_received')),
                  //field('Consent_Given__c', dataValue('form.participant_infomation.visit_information.consent_given')) //Repeated mapping
                  //field('From_Venue__c', dataValue('form.basic_information.venue_hidden')),
                  field('Reason_for_Home_Visit__c', dataValue('form.participant_infomation.reason_for_home_visit')),
                  field('Visit_Date__c', dataValue('form.participant_infomation.visit_information.visit_date')),
                  field('Additional_Comments__c', dataValue('form.administrative.visit_notes'))
                ),
                ...fields(...state.data.eventField),
              }))
            )(state);
          });

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Home-Visit-Log-Form:
        source_trigger: webhook
        target_job: Upsert-Home-Visit-Log-Form
        condition_type: js_expression
        condition_label: Home Visit Log Form
        condition_expression: |
          state.data.form["@name"] == "Home Visit Log Form" && state.data.form["basic_information"]["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "[TEST]-Upsert-Pre-Challenges":
    name: '[TEST] Upsert Pre Challenges'
    jobs:
      Upsert-pre-challenges:
        name: Upsert pre challenges
        adaptor: '@openfn/language-salesforce@4.3.0'
        credential: aissatou@openfn.org-GRS-Salesforce-Sandbox
        body: |
          fn(state => {
            function transform(value) {
              if (!value) return;
              //console.log("value in switch", value.toString().trim().toLowerCase());
              switch (value.toString().trim().toLowerCase()) {
                case 'true':
                case 'yes':
                case 'agree':
                case 'verdade':
                case 'concorda':
                case 'concordo':
                case 'choice1':
                  return 1;
                case 'false':
                case 'no':
                case 'disagree':
                case 'discorda':
                case 'discordo':
                case 'falso':
                case 'choice6':
                case 'choice3':
                  return 2;
                case 'i_dont_know':
                case 'na':
                  return 3;
                case 'unanswered':
                  return 4;
                case 'not_applicable':
                  return 5;
                default:
                  return value;
              }
            }

            state.helperFunctions = { transform };

            return query(
              `SELECT Participant_Identification_Number_PID__c from Person__c where Participant_Identification_Number_PID__c  = '${state.data.form.case['@case_id']}'`
            )(state);
          });

          fn(state => {
            const { form } = state.data;

            const formVersion = Object.keys(form).find(key => key.includes('pre_challenge'));

            console.log("form version", formVersion);

            const sfFieldMapping = {
              'pre_challenge_south_africa_-_skillz_girl': {
                Pre_1__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_have_an_older_person_in_my_life_i_can_go_to_for_advice_i_have_an_older_pe',
                Pre_2__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_know_how_to_make_a_plan_to_deal_with_the_challenges_i_may_face_in_reachin',
                Pre_3__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Pre_4__c: 'form.pre_challenge_south_africa_-_skillz_girl.every_day_i_can_find_something_to_be_grateful_for',
                Pre_5__c: 'form.pre_challenge_south_africa_-_skillz_girl.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Pre_6__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Pre_7__c: 'form.pre_challenge_south_africa_-_skillz_girl.girls_have_a_greater_risk_of_contracting_hiv_than_boys',
                Pre_8__c: 'form.pre_challenge_south_africa_-_skillz_girl.if_i_am_sexually_active_i_go_to_a_clinic_to_get_protection_from_hivstis_and',
                Pre_9__c: 'form.pre_challenge_south_africa_-_skillz_girl.like_physical_health_we_all_have_mental_health',
                Pre_10__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Pre_11__c: 'form.pre_challenge_south_africa_-_skillz_girl.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Pre_12__c: 'form.pre_challenge_south_africa_-_skillz_girl.if_a_girl_is_sexually_abused_she_can_reduce_her_risk_of_getting_hiv_by_goin',
                Pre_13__c: 'form.pre_challenge_south_africa_-_skillz_girl.sometimes_a_man_may_have_a_good_reason_to_hit_his_partner',
                Pre_14__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Pre_15__c: 'form.pre_challenge_south_africa_-_skillz_girl.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                Pre_16__c: 'form.pre_challenge_south_africa_-_skillz_girl.if_sexually_active_i_or_my_partner_is_using_a_prevention_method_to_protect_',
                Pre_17__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_know_where_to_go_to_receive_counselling_for_mental_health_challenges',
                Pre_18__c: 'form.pre_challenge_south_africa_-_skillz_girl.loss_of_interest_in_funenjoyable_activities_is_a_common_sign_of_depression',
                Pre_19__c: 'form.pre_challenge_south_africa_-_skillz_girl.i_know_at_least_three_methods_to_prevent_an_unwanted_pregnancy',
              },
              'portuguese_pre_challenge_gcr_-_skillz_malaria': {
                Pre_1__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.dormir_dentro_da_rede_mosquiteira_tratada_todas_as_noites_pode_proteger_me_',
                Pre_2__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.posso_esperar_uns_dias_antes_de_fazer_o_teste_de_malria_se_tiver_febres',
                Pre_3__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.um_mdico_tradicionalcurandeiro_pode_me_dar_um_tratamento_para_curar_a_malri',
                Pre_4__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.se_tiver_malria_e_no_for_tratado_posso_transmitir_a_malria_a_algum',
                Pre_5__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.somente_as_mulheres_grvidas_e_as_crianas_menores_de_5_anos__que_precisam_de',
                Pre_6__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.a_malria_pode_matar_se_no_fr_tratada',
                Pre_7__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.a_febre__um_sintoma_da_malria',
                Pre_8__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.eu_me_sinto_bem_conmigo_mesmo',
                Pre_9__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.tenho_algum_na_minha_vida_que_pode_me_dar_bons_conselhos_quando_preciso_de_',
                Pre_10__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.eu_sei_onde_posso_ter_tratamento_para_malria_na_minha_comunidade',
                Pre_11__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.posso_proteger-me_da_malria',
              },
            
              'portuguese_pre_challenge_gcr_-_skillz_girl': {
                Pre_1__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.falei_sobre_o_hiv_com_uma_pessoa_adulta_nos_ltimos_2_meses_fora_do_skillz',
                Pre_2__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.sei_como_expressar_a_minha_raiva_sem_ser_violento',
                Pre_3__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.sei_como_superar_os_desafios_que_possa_enfrentar_na_minha_vida',
                Pre_4__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.sei_quais_as_decises_a_tomar_para_alcanar_os_meus_objectivos',
                Pre_5__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.os_rapazes_correm_um_risco_mais_elevado_de_serem_vtimas_de_violncia_do_que_',
                Pre_6__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.conheco_que_mudanas_ocorrem_no_meu_corpo_durante_a_puberdade',
                Pre_7__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.conheo_pelo_menos_trs_mtodos_para_evitar_uma_gravidez_indesejada',
                Pre_8__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.os_preservativos_so_o_nico_mtodo_contraceptivo_que_protege_contra_a_gravide',
                Pre_9__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.conheco_onde_obter_servios_de_apoio_para_mim_ou_outra_pessoa_para_casos_de_',
                Pre_10__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.se_uma_rapariga_inicia_seu_perodo_menstrual_significa_que_est_pronta_para_c',
                Pre_11__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.caso_eu_seja_abusada_sexualmente_prefiro_guard-lo_para_mim_para_evitar_que_',
                Pre_12__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.um_homem_tem_o_direito_de_ter_sexo_com_a_sua_namorada_mesmo_que_ela_no_o_qu',
                Pre_13__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.pessoas_com_problemas_de_sade_mental_so_apenas_confusas_ou_loucas',
                Pre_14__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.pessoas_com_problemas_de_sade_mental_so_apenas_confusas_ou_loucas',
                Pre_15__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.informaria_a_algum_caso_fosse_tocada_por_alguem_de_uma_forma_que_me_deixass',
                Pre_16__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.uma_filha_deve_sempre_respeitar_a_deciso_dos_seus_pais_para_se_casar',
                Pre_17__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.um_casamento_bem_sucedido__mais_importante_para_as_raparigas_do_que_termina',
                Pre_18__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.eu_no_praticaria_desporto_com_algum_que_tem_hiv',
                Pre_19__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.um_namorado_pode_ter_boas_razes_para_bater_na_sua_namorada',
                Pre_20__c: 'form.portuguese_pre_challenge_gcr_-_skillz_girl.no_faz_mal_que_um_rapaz_ameace_bater_na_sua_namorada_se_nunca_a_bater_fisic',
              },
              'pre_challenge_zambia_-_plus_mh_enhanced_zambia': {
                Pre_1__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.in_general_i_feel_good_about_myself',
                Pre_2__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_have_the_skills_and_knowledge_to_avoid_getting_infected_with_another_kind',
                Pre_3__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_important_to_know_why_and_how_i_want_to_tell_someone_my_hiv_status',
                Pre_4__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_accept_myself_and_my_hiv_status',
                Pre_5__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Pre_6__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.are_you_or_have_you_been_past_12_months_in_a_sexual_relationship_na_if_not_',
                Pre_7__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
                Pre_8__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                Pre_9__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.there_are_people_i_trust_with_whom_i_can_talk_about_my_status',
                Pre_10__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_okay_for_two_people_with_hiv_to_have_unprotected_sex_with_each_other',
                Pre_11__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_okay_for_someone_with_hiv_to_stop_taking_their_arv_as_soon_as_they_st',
                Pre_12__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.when_i_have_a_choice_it_is_important_to_eat_a_variety_of_foods_including_gr',
                Pre_13__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.mental_health_problems_have_nothing_to_do_with_being_lazy_or_weak_and_many_',
                Pre_14__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.art_adherence_is_an_important_part_of_my_overall_health_and_well-being',
                Pre_15__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.the_most_common_illnesses_of_mental_health_are_depression_and_anxiety',
                Pre_16__c: 'form.pre_challenge_zambia_-_plus_mh_enhanced_zambia.biological_and_social_factors_contribute_to_females_and_males_experiencing_',
              },
              'pre_challenge_nigeria_-_advanced_skills':{
                Pre_1__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_have_talked_about_hiv_with_an_adult_in_the_past_two_months_outside_skillz',
                Pre_2__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_have_talked_about_malaria_with_an_adult_in_the_past_two_months_outside_sk',
                Pre_3__c: 'form.pre_challenge_nigeria_-_advanced_skills.unequal_power_in_relationships_can_contribute_to_the_spread_of_hiv',
                Pre_4__c: 'form.pre_challenge_nigeria_-_advanced_skills.the_most_effective_way_to_avoid_getting_hiv_is_to_abstain_from_sex',
                Pre_5__c: 'form.pre_challenge_nigeria_-_advanced_skills.malaria_is_spread_by_standing_under_the_hot_sun',
                Pre_6__c: 'form.pre_challenge_nigeria_-_advanced_skills.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                Pre_7__c: 'form.pre_challenge_nigeria_-_advanced_skills.sleeping_under_a_mosquito_net_every_night_can_help_protect_me_from_malaria',
                Pre_8__c: 'form.pre_challenge_nigeria_-_advanced_skills.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                Pre_9__c: 'form.pre_challenge_nigeria_-_advanced_skills.it_is_okay_for_someone_with_malaria_to_stop_taking_their_medication_as_soon',
                Pre_10__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_can_abstain_from_sex_until_i_am_older_even_if_it_is_difficult',
                Pre_11__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Pre_12__c: 'form.pre_challenge_nigeria_-_advanced_skills.men_should_share_the_work_around_the_house_such_as_cleaning',
                Pre_13__c: 'form.pre_challenge_nigeria_-_advanced_skills.it_is_the_males_responsibilty_to_make_decisions_in_a_relationship',
                Pre_14__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_can_use_drugs_and_still_easily_reach_my_goals_in_life',
                Pre_15__c: 'form.pre_challenge_nigeria_-_advanced_skills.when_sick_it_is_better_to_visit_the_herb_seller_than_to_visit_a_doctor_or_a',
                Pre_16__c: 'form.pre_challenge_nigeria_-_advanced_skills.it_is_okay_to_use_violence_with_my_partner_if_he_or_she_makes_me_angry',
                Pre_17__c: 'form.pre_challenge_nigeria_-_advanced_skills.i_have_the_power_to_change_gender_expectations_that_i_do_not_agree_with',
              },
              'pre_challenge_zimbabwe_-_skillz_core_zimbabwe': {
                Pre_1__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_know_what_decisions_to_make_to_achieve_my_goals',
                Pre_2__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girlboy',
                Pre_3__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_what_i_am_good_at',
                Pre_4__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                Pre_5__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Pre_6__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Pre_7__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_access_sexual_health_services_such_as_sti_and_hiv_testi',
                Pre_8__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Pre_9__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Pre_10__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.girls_should_be_obedient_and_should_not_disagree_with_boys',
                Pre_11__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                Pre_12__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.my_skillz_coach_helps_me_to_be_a_better_person',
                Pre_13__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                Pre_14__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.if_i_test_positive_for_hiv_there_will_be_someone_who_will_help_and_support_',
                Pre_15__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_who_to_go_to_if_i_amsomeone_i_know_is_abused_sexually_physically_and',
                Pre_16__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_who_to_go_to_if_someone_touches_me_in_a_way_that_makes_me_uncomforta',
                Pre_17__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                Pre_18__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Pre_19__c: 'form.pre_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
              },
              'pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe': {
                Pre_1__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_know_what_decisions_to_make_to_achieve_my_goals',
                Pre_2__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_dont_always_have_to_do_what_people_expect_just_because_i_am_girlboy',
                Pre_3__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Pre_4__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_can_make_my_own_informed_decisions_about_my_sexual_health',
                Pre_5__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Pre_6__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Pre_7__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.my_skillz_coach_helps_me_to_be_a_better_person',
                Pre_8__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advise_or_when_i_have_a',
                Pre_9__c: 'form.pre_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
              },
              'pre_challenge_mindskillz-_zambia_100': {
                Pre_1__c:'form.pre_challenge_mindskillz-_zambia_100.when_i_express_my_feelings_clearly_people_understand_me_better',
                Pre_2__c:'form.pre_challenge_mindskillz-_zambia_100.i_have_skills_that_help_me_bounce_back_from_difficult_situations',
                Pre_3__c:'form.pre_challenge_mindskillz-_zambia_100.stress_is_a_normal_part_of_life',
                Pre_4__c:'form.pre_challenge_mindskillz-_zambia_100.i_can_reach_my_goals_in_life',
                Pre_5__c:'form.pre_challenge_mindskillz-_zambia_100.if_i_have_a_problem_i_have_someone_in_my_life_i_can_go_to_for_support',
                Pre_6__c:'form.pre_challenge_mindskillz-_zambia_100.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Pre_7__c:'form.pre_challenge_mindskillz-_zambia_100.self_control_helps_you_make_smart_decisions_when_you_are_angry_or_upset',
                Pre_8__c:'form.pre_challenge_mindskillz-_zambia_100.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                Pre_9__c:'form.pre_challenge_mindskillz-_zambia_100.i_know_how_to_express_my_anger_without_being_violent',
                Pre_10__c:'form.pre_challenge_mindskillz-_zambia_100.listening_carefully_to_others_is_an_important_communication_skill',
                Pre_11__c:'form.pre_challenge_mindskillz-_zambia_100.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                Pre_12__c:'form.pre_challenge_mindskillz-_zambia_100.i_can_understand_how_others_are_feeling_and_be_sensitive_to_their_emotions',
                Pre_13__c:'form.pre_challenge_mindskillz-_zambia_100.i_am_confident_that_i_know_where_to_seek_information_about_mental_illness',
                Pre_14__c:'form.pre_challenge_mindskillz-_zambia_100.i_am_confident_using_the_computer_or_telephone_to_seek_information_about_me',
                Pre_15__c:'form.pre_challenge_mindskillz-_zambia_100.i_am_confident_attending_face_to_face_appointments_to_seek_information_abou',
                Pre_16__c:'form.pre_challenge_mindskillz-_zambia_100.i_am_confident_i_have_access_to_resources_eg_doctor_internet_friends_that_i',
                Pre_17__c:'form.pre_challenge_mindskillz-_zambia_100.people_with_mental_illness_could_snap_out_of_it_if_they_wanted',
                Pre_18__c:'form.pre_challenge_mindskillz-_zambia_100.a_mental_illness_is_a_sign_of_personal_weakness',
                Pre_19__c:'form.pre_challenge_mindskillz-_zambia_100.a_mental_illness_is_not_a_real_medical_illness',
                Pre_20__c:'form.pre_challenge_mindskillz-_zambia_100.people_with_mental_illness_are_dangerous',
                Pre_21__c:'form.pre_challenge_mindskillz-_zambia_100.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Pre_22__c:'form.pre_challenge_mindskillz-_zambia_100.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Pre_23__c:'form.pre_challenge_mindskillz-_zambia_100.seeing_a_mental_health_professional_means_you_are_not_strong_enough_to_mana',
                Pre_24__c:'form.pre_challenge_mindskillz-_zambia_100.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi',
                Pre_25__c:'form.pre_challenge_mindskillz-_zambia_100.i_believe_treatment_for_a_mental_illness_provided_by_a_mental_health_profes',
              },
              'pre_challenge_skillz_girl_nih200':{
                Pre_1__c:'form.pre_challenge_skillz_girl_nih200.i_have_talked_about_hiv_with_an_adult_in_the_past_two_months_outside_skillz',
                Pre_2__c:'form.pre_challenge_skillz_girl_nih200.i_have_talked_about_hiv_with_a_friend_in_the_past_two_months_outside_skillz',
                Pre_3__c:'form.pre_challenge_skillz_girl_nih200.having_sex_with_an_older_partner_increases_my_risk_of_getting_hiv',
                Pre_4__c:'form.pre_challenge_skillz_girl_nih200.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Pre_5__c:'form.pre_challenge_skillz_girl_nih200.i_know_someone_in_my_community_who_distributes_contraceptives_and_other_sex',
                Pre_6__c:'form.pre_challenge_skillz_girl_nih200.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Pre_7__c:'form.pre_challenge_skillz_girl_nih200.i_have_the_right_to_say_no_to_sex_no_matter_who_asks',
                Pre_8__c:'form.pre_challenge_skillz_girl_nih200.as_a_girl_i_have_a_greater_risk_of_getting_hiv_than_boys',
                Pre_9__c:'form.pre_challenge_skillz_girl_nih200.i_know_where_to_get_support_services_for_rape',
                Pre_10__c:'form.pre_challenge_skillz_girl_nih200.if_a_girl_is_sexually_abused_she_can_reduce_her_risk_of_getting_hiv_by_taki',
                Pre_11__c:'form.pre_challenge_skillz_girl_nih200.i_feel_good_about_being_a_girl',
                Pre_12__c:'form.pre_challenge_skillz_girl_nih200.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Pre_13__c:'form.pre_challenge_skillz_girl_nih200.boys_should_share_the_work_around_the_home_such_as_household_chores',
                Pre_14__c:'form.pre_challenge_skillz_girl_nih200.i_know_what_i_want_to_be_after_finishing_secondary_school',
                Pre_15__c:'form.pre_challenge_skillz_girl_nih200.if_i_have_a_problem_i_have_someone_in_my_life_i_can_talk_to_for_advise',
                Pre_16__c:'form.pre_challenge_skillz_girl_nih200.a_boyfriend_may_have_good_reason_to_hit_his_girlfriend',
                Pre_17__c:'form.pre_challenge_skillz_girl_nih200.i_would_tell_someone_if_i_were_touched_in_a_manner_that_made_me_uncomfortab',
                Pre_18__c:'form.pre_challenge_skillz_girl_nih200.i_can_reach_my_goals_in_life',
                Pre_19__c:'form.pre_challenge_skillz_girl_nih200.a_girl_should_wait_to_get_married_until_after_college',
                Pre_20__c:'form.pre_challenge_skillz_girl_nih200.biological_and_social_factors_contribute_to_females_and_males_experiencing_',
                Pre_21__c:'form.pre_challenge_skillz_girl_nih200.the_most_common_illness_of_mental_health_are_depression_and_anxiety',
                Pre_22__c:'form.pre_challenge_skillz_girl_nih200.mental_health_problems_have_nothing_to_do_with_being_lazy_or_weak_and_many_',
                Pre_23__c:'form.pre_challenge_skillz_girl_nih200.i_am_ready_to_take_an_hiv_test',
                Pre_24__c:'form.pre_challenge_skillz_girl_nih200.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
              },
              
              'pre_challenge_mindskillz_pamumvuri':{
                Pre_1__c: 'form.pre_challenge_mindskillz_pamumvuri.when_i_express_my_feelings_clearly_people_understand_me_better',
                Pre_2__c: 'form.pre_challenge_mindskillz_pamumvuri.i_have_skills_that_help_me_bounce_back_from_difficult_situations',
                Pre_3__c: 'form.pre_challenge_mindskillz_pamumvuri.stress_is_a_normal_part_of_life',
                Pre_4__c: 'form.pre_challenge_mindskillz_pamumvuri.i_can_reach_my_goals_in_life',
                Pre_5__c: 'form.pre_challenge_mindskillz_pamumvuri.if_i_have_a_problem_i_have_someone_in_my_life_i_can_go_to_for_support',
                Pre_6__c: 'form.pre_challenge_mindskillz_pamumvuri.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Pre_7__c: 'form.pre_challenge_mindskillz_pamumvuri.self_control_helps_you_make_smart_decisions_when_you_are_angry_or_upset',
                Pre_8__c: 'form.pre_challenge_mindskillz_pamumvuri.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                Pre_9__c: 'form.pre_challenge_mindskillz_pamumvuri.i_know_how_to_express_my_anger_without_being_violent',
                Pre_10__c: 'form.pre_challenge_mindskillz_pamumvuri.listening_carefully_to_others_is_an_important_communication_skill',
                Pre_11__c: 'form.pre_challenge_mindskillz_pamumvuri.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                Pre_12__c: 'form.pre_challenge_mindskillz_pamumvuri.i_can_understand_how_others_are_feeling_and_be_sensitive_to_their_emotions',
                Pre_13__c: 'form.pre_challenge_mindskillz_pamumvuri.i_am_confident_that_i_know_where_to_seek_information_about_mental_illness',
                Pre_14__c: 'form.pre_challenge_mindskillz_pamumvuri.i_am_confident_using_the_computer_or_telephone_to_seek_information_about_me',
                Pre_15__c: 'form.pre_challenge_mindskillz_pamumvuri.i_am_confident_attending_face_to_face_appointments_to_seek_information_abou',
                Pre_16__c: 'form.pre_challenge_mindskillz_pamumvuri.i_am_confident_i_have_access_to_resources_eg_doctor_internet_friends_that_i',
                Pre_17__c: 'form.pre_challenge_mindskillz_pamumvuri.people_with_mental_illness_could_snap_out_of_it_if_they_wanted',
                Pre_18__c: 'form.pre_challenge_mindskillz_pamumvuri.a_mental_illness_is_a_sign_of_personal_weakness',
                Pre_19__c: 'form.pre_challenge_mindskillz_pamumvuri.a_mental_illness_is_not_a_real_medical_illness',
                Pre_20__c: 'form.pre_challenge_mindskillz_pamumvuri.people_with_mental_illness_are_dangerous',
                Pre_21__c: 'form.pre_challenge_mindskillz_pamumvuri.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Pre_22__c: 'form.pre_challenge_mindskillz_pamumvuri.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Pre_23__c: 'form.pre_challenge_mindskillz_pamumvuri.seeing_a_mental_health_professional_means_you_are_not_strong_enough_to_mana',
                Pre_24__c: 'form.pre_challenge_mindskillz_pamumvuri.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi',
                Pre_25__c: 'form.pre_challenge_mindskillz_pamumvuri.i_believe_treatment_for_a_mental_illness_provided_by_a_mental_health_profes',
              },
              'pre_challenge_skillz_girl_-_zam_311': {
                Pre_1__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_what_i_am_good_at',
                Pre_2__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_how_to_overcome_challenges_that_i_may_face_in_my_life',
                Pre_3__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girl',
                Pre_4__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_would_be_able_to_ask_my_boyfriend_that_i_want_to_use_a_condom',
                Pre_5__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_can_say_no_to_sex_even_if_my_boyfriend_or_friends_pressure_me_to_have_sex',
                Pre_6__c: 'form.pre_challenge_skillz_girl_-_zam_311.if_i_am_sexually_active_i_go_to_a_healthcare_provider_to_get_protection_fro',
                Pre_7__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Pre_8__c: 'form.pre_challenge_skillz_girl_-_zam_311.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                Pre_9__c: 'form.pre_challenge_skillz_girl_-_zam_311.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Pre_10__c: 'form.pre_challenge_skillz_girl_-_zam_311.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_or_wife',
                Pre_11__c: 'form.pre_challenge_skillz_girl_-_zam_311.a_successful_marriage_is_more_important_to_girls_than_completing_school',
                Pre_12__c: 'form.pre_challenge_skillz_girl_-_zam_311.a_daughter_should_always_respect_her_parents_decision_for_her_to_get_marrie',
                Pre_13__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_can_decide_when_is_the_right_time_for_me_to_have_a_baby',
                Pre_14__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                Pre_15__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                Pre_16__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_gender_base',
                Pre_17__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_prevention_',
                Pre_18__c: 'form.pre_challenge_skillz_girl_-_zam_311.one_sign_of_pregnancy_is_a_girl_missing_her_period',
                Pre_19__c: 'form.pre_challenge_skillz_girl_-_zam_311.i_know_at_least_three_methods_to_avoid_an_unwanted_pregnancy',
                Pre_20__c: 'form.pre_challenge_skillz_girl_-_zam_311.are_you_or_your_boyfriend_currently_using_any_contraceptive_method',
              },
              'pre_challenge_skillz_core_zambia_211':{
                Pre_1__c: 'form.pre_challenge_skillz_core_zambia_211.i_know_what_i_am_good_at',
                Pre_2__c: 'form.pre_challenge_skillz_core_zambia_211.i_know_how_to_overcome_challenges_i_may_have_in_my_life',
                Pre_3__c: 'form.pre_challenge_skillz_core_zambia_211.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                Pre_4__c: 'form.pre_challenge_skillz_core_zambia_211.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Pre_5__c: 'form.pre_challenge_skillz_core_zambia_211.i_dont_always_have_to_do_what_people_expect_because_i_am_a_boygirl',
                Pre_6__c: 'form.pre_challenge_skillz_core_zambia_211.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Pre_7__c: 'form.pre_challenge_skillz_core_zambia_211.girls_should_not_disagree_with_boys',
                Pre_8__c: 'form.pre_challenge_skillz_core_zambia_211.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                Pre_9__c: 'form.pre_challenge_skillz_core_zambia_211.i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Pre_10__c: 'form.pre_challenge_skillz_core_zambia_211.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                Pre_11__c: 'form.pre_challenge_skillz_core_zambia_211.if_i_test_positive_for_hivthere_will_be_someone_who_will_help_and_support_m',
                Pre_12__c: 'form.pre_challenge_skillz_core_zambia_211.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                Pre_13__c: 'form.pre_challenge_skillz_core_zambia_211.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                Pre_14__c: 'form.pre_challenge_skillz_core_zambia_211.i_know_where_to_get_support_services_for_me_or_someone_elsefor_hiv_-_relate',
                Pre_15__c: 'form.pre_challenge_skillz_core_zambia_211.i_know_where_to_get_support_services_for_me_or_someone_elsefor_abuse',
                Pre_16__c: 'form.pre_challenge_skillz_core_zambia_211.i_have_the_right_to_access_sexual_health_servicessuch_as_sti_and_hiv_testin',
                Pre_17__c: 'form.pre_challenge_skillz_core_zambia_211.one_sign_of_pregnancy_is_a_girl_missing_her_period',
                Pre_18__c: 'form.pre_challenge_skillz_core_zambia_211.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Pre_19__c: 'form.pre_challenge_skillz_core_zambia_211.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
                Pre_20__c: 'form.pre_challenge_skillz_core_zambia_211.i_know_what_decisions_to_make_to_achieve_my_goals',
              },
              'pre_challenge_skillz_boy_zambia110':{
                Pre_1__c: 'form.pre_challenge_skillz_boy_zambia110.in_general_i_feel_good_about_myself',
                Pre_2__c: 'form.pre_challenge_skillz_boy_zambia110.i_would_be_able_to_ask_my_girlfriend_that_i_want_to_use_a_condom',
                Pre_3__c: 'form.pre_challenge_skillz_boy_zambia110.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_boy',
                Pre_4__c: 'form.pre_challenge_skillz_boy_zambia110.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Pre_5__c: 'form.pre_challenge_skillz_boy_zambia110.it_is_more_important_for_boys_to_be_educated_than_girls',
                Pre_6__c: 'form.pre_challenge_skillz_boy_zambia110.men_are_better_leaders_than_women',
                Pre_7__c: 'form.pre_challenge_skillz_boy_zambia110.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Pre_8__c: 'form.pre_challenge_skillz_boy_zambia110.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                Pre_9__c: 'form.pre_challenge_skillz_boy_zambia110.it_is_okay_for_a_boyfriend_to_threaten_to_hit_his_girlfriend_if_he_never_hi',
                Pre_10__c: 'form.pre_challenge_skillz_boy_zambia110.i_can_say_no_to_sex_even_if_my_friends_or_girlfriend_pressure_me_to_have_se',
                Pre_11__c: 'form.pre_challenge_skillz_boy_zambia110.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_sexual_behaviou',
                Pre_12__c: 'form.pre_challenge_skillz_boy_zambia110.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Pre_13__c: 'form.pre_challenge_skillz_boy_zambia110.i_have_a_friend_that_i_can_go_to_for_advice_when_i_have_a_problem',
                Pre_14__c: 'form.pre_challenge_skillz_boy_zambia110.i_have_the_right_to_access_sexual_health_services_such_as_hiv_and_sti_testi',
                Pre_15__c: 'form.pre_challenge_skillz_boy_zambia110.i_know_where_to_access_sexual_health_services_such_as_sti_and_hiv_testing',
                Pre_16__c: 'form.pre_challenge_skillz_boy_zambia110.before_making_a_decision_i_think_about_how_it_can_affect_me_or_others',
                Pre_17__c: 'form.pre_challenge_skillz_boy_zambia110.i_know_how_to_express_my_anger_without_being_violent_such_as_hitting_kickin',
                Pre_18__c: 'form.pre_challenge_skillz_boy_zambia110.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                Pre_19__c: 'form.pre_challenge_skillz_boy_zambia110.i_know_how_to_correctly_use_a_male_condom',
                Pre_20__c: 'form.pre_challenge_skillz_boy_zambia110.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
           
              },
              'pre_challenge_skillz_guyz_mh_-_sa_100':{
                Pre_1__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_have_to_be_respectful_communicate_and_take_action_to_be_a_role_model_in_m',
                Pre_2__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_have_skills_that_help_me_bounce_back_from_difficult_situations',
                Pre_3__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_can_identify_my_strengths_or_things_that_i_am_good_at',
                Pre_4__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.when_i_am_angry_i_know_how_to_avoid_using_violent_behaviour',
                Pre_5__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.when_i_express_my_feelings_clearly_people_understand_me_better',
                Pre_6__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Pre_7__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.sadness_and_a_loss_of_pleasure_in_things_you_enjoy_are_common_symptoms_of_d',
                Pre_8__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_know_where_to_access_health_services_and_mental_health_services',
                Pre_9__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_will_share_accurate_information_about_mental_health_services_to_avoid_sti',
                Pre_10__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                Pre_11__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.men_should_share_the_work_around_the_house_such_as_cleaning_and_taking_care',
                Pre_12__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.its_okay_for_a_guy_to_beat_a_girl_when_there_is_a_misunderstanding',
                Pre_13__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_should_respect_the_rights_of_others_such_as_their_right_to_their_own_opin',
                Pre_14__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_feel_confident_setting_my_goals',
                Pre_15__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.stress_is_a_normal_part_of_life',
                Pre_16__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Pre_17__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.there_are_people_i_trust_with_whom_i_can_talk_to_about_my_mental_health',
                Pre_18__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_have_no_fear_or_shame_when_accessing_health_services_or_mental_health_ser',
                Pre_19__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                Pre_20__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Pre_21__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_can_stand_up_to_peer_pressure_when_i_have_to',
                Pre_22__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_should_use_a_condom_even_if_my_girlfriend_is_on_another_form_of_birth_con',
                Pre_23__c: 'form.pre_challenge_skillz_guyz_mh_-_sa_100.i_know_where_to_go_for_support_if_i_or_someone_i_know_abuses_alcohol',
              },
              
                  
              'pre_challenge_south_africa_-_skillz_girl_mh_sa_211':{
                Pre_1__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_my_rights_and_responsibilities',
                Pre_2__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Pre_3__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Pre_4__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.stress_is_a_normal_part_of_life',
                Pre_5__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.like_physical_health_we_all_have_mental_health',
                Pre_6__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Pre_7__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.healthy_relationships_are_based_on_healthy_communication_and_mutual_respect',
                Pre_8__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_partner_or_wif',
                Pre_9__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Pre_10__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Pre_11__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.taking_prep_and_using_a_condom_can_lower_my_risk_of_getting_hiv',
                Pre_12__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Pre_13__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Pre_14__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.post_exposure_prophylaxis_pep_can_reduce_my_risk_of_getting_hiv_if_taken_1-',
                Pre_15__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.it_is_my_right_to_access_health_services',
                Pre_16__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_have_an_adult_or_someone_in_my_life_i_can_go_to_for_advice',
                Pre_17__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_give_support_and_encouragement_to_a_friend_or_family_member_who_is_li',
                Pre_18__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.using_a_condom_and_another_contraceptive_method_can_help_prevent_unwanted_p',
                Pre_19__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Pre_20__c: 'form.pre_challenge_south_africa_-_skillz_girl_mh_sa_211.drinking_too_much_alcohol_can_harm_the_body_and_the_mind',
              },
              
               'pre_challenge_skillz_girl_abbreviated_south_africa':{
                Pre_1__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_know_my_rights_and_responsibilities',
                Pre_2__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Pre_3__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Pre_4__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.stress_is_a_normal_part_of_life',
                Pre_5__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.like_physical_health_we_all_have_mental_health',
                Pre_6__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Pre_7__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.in_a_relationship_it_is_both_partners_responsibility_to_prevent_unwanted_pr',
                Pre_8__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.healthy_relationships_are_based_on_healthy_communication_and_respect',
                Pre_9__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_partner_or_wif',
                Pre_10__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.a_person_has_the_right_to_have_sex_with_their_partner_even_if_the_partner_d',
                Pre_11__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Pre_12__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Pre_13__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.taking_prep_and_using_a_condom_can_lower_my_risk_of_getting_hiv',
                Pre_14__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Pre_15__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Pre_16__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_can_use_coping_skills_to_handle_stress',
                Pre_17__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.post_exposure_prophylaxis_pep_can_reduce_my_risk_of_getting_hiv_if_taken_1-',
                Pre_18__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.it_is_my_right_to_access_health_services',
                Pre_19__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_have_an_adult_or_someone_in_my_life_i_can_go_to_for_advice',
                Pre_20__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.using_a_condom_and_another_contraceptive_method_can_help_prevent_unwanted_p',
                Pre_21__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Pre_22__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.drinking_too_much_alcohol_can_harm_the_body_and_mind',
                Pre_23__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_know_at_least_two_ways_of_saving_money',
                Pre_24__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.a_budget_is_the_estimated_income_and_expenses_for_a_certain_time_period',
                Pre_25__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.accepting_money_for_sexual_favors_can_create_risks_to_my_health_and_safety',
                Pre_26__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.using_assertive_communication_means_respectfully_sharing_my_thoughts_and_fe',
                Pre_27__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.i_have_the_right_to_access_emergency_contraception',
                Pre_28__c: 'form.pre_challenge_skillz_girl_abbreviated_south_africa.if_a_girl_has_unprotected_sex_and_misses_her_period_this_could_mean_she_is_',
              },
              
              'pre_challenge_skillz_guyz_-_yedi__323':{
                 Pre_1__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_know_how_to_stand_up_to_peer_pressure_ie_to_drink_alcohol_or_have_sex_fro',
                 Pre_2__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Pre_3__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_have_someone_i_can_go_to_for_advice',
                 Pre_4__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.no_one_has_the_right_to_touch_me_in_a_way_that_makes_me_uncomfortable_such_',
                 Pre_5__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                 Pre_6__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_behaviours_such',
                 Pre_7__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                 Pre_8__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.a_mental_illness_is_a_sign_of_personal_weakness',
                 Pre_9__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Pre_10__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                 Pre_11__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.a_boys_opinion_is_more_important_than_a_girls',
                 Pre_12__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.men_should_share_the_work_around_the_house_such_as_cleaning_and_taking_care',
                 Pre_13__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.its_okay_for_a_guy_to_beat_a_girl_when_she_misbehaves',
                 Pre_14__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Pre_15__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                 Pre_16__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.condoms_are_the_only_contraceptive_method_that_protect_against_pregnancy_as',
                 Pre_17__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_would_stand_up_to_my_friends_if_they_were_harming_others_such_as_touching',
                 Pre_18__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                 Pre_19__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                 Pre_20__c: 'form.pre_challenge_skillz_guyz_-_yedi__323.i_have_the_ability_to_shape_my_own_life',
              },
              
              'pre_challenge_skillz_girl_mh_zambia':{
                 Pre_1__c: 'form.pre_challenge_skillz_girl_mh_zambia.a_mental_illness_is_a_sign_of_personal_weakness',
                 Pre_2__c: 'form.pre_challenge_skillz_girl_mh_zambia.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Pre_3__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girl',
                 Pre_4__c: 'form.pre_challenge_skillz_girl_mh_zambia.if_i_had_a_boyfriend_i_would_be_able_to_ask_him_to_use_a_condom_before_havi',
                 Pre_5__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_can_say_no_to_sex_even_if_my_boyfriend_or_friends_pressure_to_have_sex',
                 Pre_6__c: 'form.pre_challenge_skillz_girl_mh_zambia.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Pre_7__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                 Pre_8__c: 'form.pre_challenge_skillz_girl_mh_zambia.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Pre_9__c: 'form.pre_challenge_skillz_girl_mh_zambia.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                 Pre_10__c: 'form.pre_challenge_skillz_girl_mh_zambia.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_or_wife',
                 Pre_11__c: 'form.pre_challenge_skillz_girl_mh_zambia.a_successful_marrige_is_more_important_to_girls_than_completing_school',
                 Pre_12__c: 'form.pre_challenge_skillz_girl_mh_zambia.a_daughter_should_always_respect_her_parents_decision_to_get_married',
                 Pre_13__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_can_decide_when_is_the_right_time_for_me_to_have_a_baby',
                 Pre_14__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                 Pre_15__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                 Pre_16__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_gender_base',
                 Pre_17__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_prevention_',
                 Pre_18__c: 'form.pre_challenge_skillz_girl_mh_zambia.if_sexually_active_one_sign_of_pregnance_is_a_girl_missing_her_period',
                 Pre_19__c: 'form.pre_challenge_skillz_girl_mh_zambia.i_know_at_least_three_methods_to_avoid_an_unwanted_pregnancy',
                 Pre_20__c: 'form.pre_challenge_skillz_girl_mh_zambia.are_you_or_your_boyfriend_currently_using_any_contraceptive_method',
              },
              
              'pre_challenge_skillz_core_mh_zambia':{
                 Pre_1__c: 'form.pre_challenge_skillz_core_mh_zambia.i_know_what_i_am_good_at',
                 Pre_2__c: 'form.pre_challenge_skillz_core_mh_zambia.i_know_how_to_overcome_challenges_that_i_may_have_in_life',
                 Pre_3__c: 'form.pre_challenge_skillz_core_mh_zambia.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                 Pre_4__c: 'form.pre_challenge_skillz_core_mh_zambia.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                 Pre_5__c: 'form.pre_challenge_skillz_core_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girlboy',
                 Pre_6__c: 'form.pre_challenge_skillz_core_mh_zambia.a_man_has_the_right_to_have_sex_with_his_wifegirlfriend_even_if_she_doesnt_',
                 Pre_7__c: 'form.pre_challenge_skillz_core_mh_zambia.girls_should_not_disagree_with_boys',
                 Pre_8__c: 'form.pre_challenge_skillz_core_mh_zambia.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                 Pre_9__c: 'form.pre_challenge_skillz_core_mh_zambia.i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                 Pre_10__c: 'form.pre_challenge_skillz_core_mh_zambia.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                 Pre_11__c: 'form.pre_challenge_skillz_core_mh_zambia.if_i_test_positive_for_hiv_there_will_be_someone_who_will_help_and_support_',
                 Pre_12__c: 'form.pre_challenge_skillz_core_mh_zambia.people_with_mental_illness_live_on_the_streets_and_eat_dirty_food_from_garb',
                 Pre_13__c: 'form.pre_challenge_skillz_core_mh_zambia.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                 Pre_14__c: 'form.pre_challenge_skillz_core_mh_zambia.i_only_use_violent_behaviour_when_someone_angers_me',
                 Pre_15__c: 'form.pre_challenge_skillz_core_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_abuse_or_hi',
                 Pre_16__c: 'form.pre_challenge_skillz_core_mh_zambia.i_have_the_right_to_access_sexual_health_services_such_as_sti_and_hiv_testi',
                 Pre_17__c: 'form.pre_challenge_skillz_core_mh_zambia.if_sexually_active_one_sign_of_pregnancy_can_be_a_girl_missing_her_period',
                 Pre_18__c: 'form.pre_challenge_skillz_core_mh_zambia.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                 Pre_19__c: 'form.pre_challenge_skillz_core_mh_zambia.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
                 Pre_20__c: 'form.pre_challenge_skillz_core_mh_zambia.i_know_what_decisions_to_make_to_achieve_my_goals',
              },
              
              'pre_challenge_skillz_guyz_mh_zambia':{
                 Pre_1__c: 'form.pre_challenge_skillz_guyz_mh_zambia.a_mental_illness_is_a_sign_of_personal_weakness',
                 Pre_2__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_would_be_able_to_tell_my_girlfriend_that_i_want_to_use_a_condom',
                 Pre_3__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_boy',
                 Pre_4__c: 'form.pre_challenge_skillz_guyz_mh_zambia.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                 Pre_5__c: 'form.pre_challenge_skillz_guyz_mh_zambia.it_is_more_important_for_boys_to_be_educated_than_girls',
                 Pre_6__c: 'form.pre_challenge_skillz_guyz_mh_zambia.men_are_better_leaders_than_women',
                 Pre_7__c: 'form.pre_challenge_skillz_guyz_mh_zambia.a_manboy_has_the_right_to_have_sex_with_his_girlfriendwomanwife_even_if_she',
                 Pre_8__c: 'form.pre_challenge_skillz_guyz_mh_zambia.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Pre_9__c: 'form.pre_challenge_skillz_guyz_mh_zambia.it_is_okay_for_a_boyfriend_to_threaten_to_hit_his_girlfriend_if_he_never_hi',
                 Pre_10__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_can_say_no_to_sex_even_if_my_friends_or_girlfriend_pressure_me_to_have_se',
                 Pre_11__c: 'form.pre_challenge_skillz_guyz_mh_zambia.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_sexual_behaviou',
                 Pre_12__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                 Pre_13__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_have_a_friend_that_i_can_go_to_for_advice_when_i_have_a_problem',
                 Pre_14__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_have_the_right_to_access_sexual_health_services_such_as_hiv_and_sti_testi',
                 Pre_15__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_know_where_to_access_sexual_health_services_such_as_sti_and_hiv_testing',
                 Pre_16__c: 'form.pre_challenge_skillz_guyz_mh_zambia.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Pre_17__c: 'form.pre_challenge_skillz_guyz_mh_zambia.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Pre_18__c: 'form.pre_challenge_skillz_guyz_mh_zambia.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                 Pre_19__c: 'form.pre_challenge_skillz_guyz_mh_zambia.i_know_how_to_correctly_use_a_male_condom',
                 Pre_20__c: 'form.pre_challenge_skillz_guyz_mh_zambia.are_you_or_your_girlfriend_currently_using_any_contraceptive_or_protective_',
                 
              },

               'pre_challenge_mindskillz_sa_10':{
                Pre_1__c: 'form.pre_challenge_mindskillz_sa_10.mental_health_is_about_how_we_think_feel_and_act',
                Pre_2__c: 'form.pre_challenge_mindskillz_sa_10.i_can_name_the_feelings_i_have_when_im_happy_sad_or_angry',
                Pre_3__c: 'form.pre_challenge_mindskillz_sa_10.i_know_how_to_share_my_feelings_with_other_people_in_healthy_ways',
                Pre_4__c: 'form.pre_challenge_mindskillz_sa_10.mental_health_is_the_same_thing_as_mental_illness',
                Pre_5__c: 'form.pre_challenge_mindskillz_sa_10.stress_is_a_normal_part_of_life_but_too_much_stress_can_hurt_your_mental_he',
                Pre_6__c: 'form.pre_challenge_mindskillz_sa_10.i_can_tell_when_stress_is_making_me_feel_upset',
                Pre_7__c: 'form.pre_challenge_mindskillz_sa_10.i_know_two_ways_to_calm_myself_down_when_i_feel_stressed',
                Pre_8__c: 'form.pre_challenge_mindskillz_sa_10.taking_care_of_my_mental_health_can_help_me_achieve_my_goals',
                Pre_9__c: 'form.pre_challenge_mindskillz_sa_10.i_can_identify_my_strengths_or_things_i_am_good_at',
                Pre_10__c: 'form.pre_challenge_mindskillz_sa_10.i_know_how_to_support_my_friends_in_making_good_choices_for_their_mental_he',
                Pre_11__c: 'form.pre_challenge_mindskillz_sa_10.i_can_name_three_people_i_can_talk_to_if_i_need_help',
                Pre_12__c: 'form.pre_challenge_mindskillz_sa_10.i_know_of_adults_or_places_in_my_community_that_can_give_me_mental_health_s',
                Pre_13__c: 'form.pre_challenge_mindskillz_sa_10.i_can_deal_with_anger_without_being_violent',
                Pre_14__c: 'form.pre_challenge_mindskillz_sa_10.drinking_alcohol_can_harm_my_mental_and_physical_health',
                Pre_15__c: 'form.pre_challenge_mindskillz_sa_10.i_can_say_no_to_peer_pressure_like_being_asked_to_drink_alcohol',
                Pre_16__c: 'form.pre_challenge_mindskillz_sa_10.i_have_talked_to_someone_about_mental_health_in_the_last_month_outside_of_m',
                Pre_17__c: 'form.pre_challenge_mindskillz_sa_10.people_with_mental_illness_are_dangerous',
                Pre_18__c: 'form.pre_challenge_mindskillz_sa_10.a_mental_illness_is_a_sign_of_personal_weakness',
                Pre_19__c: 'form.pre_challenge_mindskillz_sa_10.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Pre_20__c: 'form.pre_challenge_mindskillz_sa_10.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Pre_21__c: 'form.pre_challenge_mindskillz_sa_10.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi'

              },

               'pre_challenge_mindskillz_zambia_2025':{
                Pre_1__c: 'form.pre_challenge_mindskillz_zambia_2025.mental_health_is_about_how_we_think_feel_and_act',
                Pre_2__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_name_the_feelings_i_have_when_im_happy_sad_or_angry',
                Pre_3__c: 'form.pre_challenge_mindskillz_zambia_2025.i_know_how_to_share_my_feelings_with_other_people_in_healthy_ways',
                Pre_4__c: 'form.pre_challenge_mindskillz_zambia_2025.mental_health_is_the_same_thing_as_mental_illness',
                Pre_5__c: 'form.pre_challenge_mindskillz_zambia_2025.stress_is_a_normal_part_of_life_but_too_much_stress_can_hurt_your_mental_he',
                Pre_6__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_tell_when_stress_is_making_me_feel_upset',
                Pre_7__c: 'form.pre_challenge_mindskillz_zambia_2025.i_know_two_ways_to_calm_myself_down_when_i_feel_stressed',
                Pre_8__c: 'form.pre_challenge_mindskillz_zambia_2025.taking_care_of_my_mental_health_can_help_me_achieve_my_goals',
                Pre_9__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_identify_my_strengths_or_things_i_am_good_at',
                Pre_10__c: 'form.pre_challenge_mindskillz_zambia_2025.i_know_how_to_support_my_friends_in_making_good_choices_for_their_mental_he',
                Pre_11__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_name_three_people_i_can_talk_to_if_i_need_help',
                Pre_12__c: 'form.pre_challenge_mindskillz_zambia_2025.i_know_of_adults_or_places_in_my_community_that_can_give_me_mental_health_s',
                Pre_13__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_deal_with_anger_without_being_violent',
                Pre_14__c: 'form.pre_challenge_mindskillz_zambia_2025.drinking_alcohol_can_harm_my_mental_and_physical_health',
                Pre_15__c: 'form.pre_challenge_mindskillz_zambia_2025.i_can_say_no_to_peer_pressure_like_being_asked_to_drink_alcohol',
                Pre_16__c: 'form.pre_challenge_mindskillz_zambia_2025.i_have_talked_to_someone_about_mental_health_in_the_last_month_outside_of_m',
                Pre_17__c: 'form.pre_challenge_mindskillz_zambia_2025.people_with_mental_illness_are_dangerous',
                Pre_18__c: 'form.pre_challenge_mindskillz_zambia_2025.a_mental_illness_is_a_sign_of_personal_weakness',
                Pre_19__c: 'form.pre_challenge_mindskillz_zambia_2025.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Pre_20__c: 'form.pre_challenge_mindskillz_zambia_2025.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Pre_21__c: 'form.pre_challenge_mindskillz_zambia_2025.if_i_had_a_mental_illness_i_would_not_seek_help_from_a_mental_health_profes'
              }

              

            };

            const pluckSfValue = val => {
              return sfFieldMapping[formVersion][val];
            };

            return { ...state, pluckSfValue };
          });

          // fn(state => {
          //   console.log("test")
          //   console.log(state.pluckSfValue('Pre_1__c'));
          //   return state;
          // });

          fn(state => {
            const PID = lastReferenceValue('records[0].Participant_Identification_Number_PID__c')(state);

            if (!PID) {
              console.log(
                `Participant not found with Participant_Identification_Number_PID__c: ${state.data.form.case['@case_id']}`
              );
              return state;
            }

            return upsert(
              'Attendance__c',
              'CommCare_Ext_ID__c',
              fields(
                //field('Event__c', dataValue('form.hidden_properties.intervention_name')),
                //relationship('Event__r', 'CommCare_Ext_ID__c', dataValue('form.hidden_properties.intervention_name')),
                relationship('Person_Attendance__r', 'Participant_Identification_Number_PID__c', dataValue('form.case.@case_id')),
                // relationship('Person_Attendance__r','CommCare_Ext_ID__c', state => {
                //   return (
                //     dataValue('form.hidden_properties.participant_first_name')(state) +
                //     dataValue('form.hidden_properties.participant_surname')(state)
                //   )
                // }),

                // field('CommCare_Ext_ID__c', state => {
                //   return `${dataValue('form.case.@case_id')(state)}-${scrubEmojis(
                //     dataValue('form.hidden_properties.intervention_name')(state),
                //     ''
                //   ).replace(/\//gi, '')}`;
                // }),
                field("CommCare_Ext_ID__c", (state) => {
                  return toUTF8(`${dataValue("form.case.@case_id")(state)}-${scrubEmojis(
                  dataValue("form.hidden_properties.intervention_name")(state),
                  ""
                  ).replace(/\//gi, "")}`);
                  }),

                //field(
                //'Person_Attendance__c',
                // state =>
                //   dataValue('form.hidden_properties.participant_first_name')(state) +
                //    ' ' +
                //   dataValue('form.hidden_properties.participant_surname')(state)
                //),
                field('Gender__c', dataValue('form.hidden_properties.gender')),
                field('Grade__c', state => {
                  const grade = dataValue('form.hidden_properties.grade')(state);
                  return grade ? grade.replace(/\D/g, '') : undefined;
                }),
                field('Class__c', dataValue('form.hidden_properties.class')),
                field('Pre_Post_Completed__c', state => {
                  var done = dataValue('form.hidden_properties.pre_questionnaire_complete')(state);
                  return done === 'Yes' ? true : done === 'No' ? false : undefined;
                }),
                field('Date_Pre_Administered__c', dataValue('form.date')),
                field('Pre_1__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_1__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_2__c', state => {
                  if (state.pluckSfValue('Pre_2__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_2__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                
                field('Pre_3__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_3__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                
                field('Pre_4__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_4__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                
                field('Pre_5__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_5__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_6__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_6__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_7__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_7__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_8__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_8__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_9__c', state => {
                  const value = dataValue(state.pluckSfValue('Pre_9__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_10__c', state => {
                  if (state.pluckSfValue('Pre_10__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_10__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_11__c', state => {
                  if (state.pluckSfValue('Pre_11__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_10__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_12__c', state => {
                  if (state.pluckSfValue('Pre_12__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_12__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_13__c', state => {
                  if (state.pluckSfValue('Pre_13__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_13__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_14__c', state => {
                  if (state.pluckSfValue('Pre_14__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_14__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_15__c', state => {
                  if (state.pluckSfValue('Pre_15__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_15__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_16__c', state => {
                  if (state.pluckSfValue('Pre_16__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_16__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_17__c', state => {
                  if (state.pluckSfValue('Pre_17__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_17__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_18__c', state => {
                  if (state.pluckSfValue('Pre_18__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_18__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_19__c', state => {
                  if (state.pluckSfValue('Pre_19__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_19__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_20__c', state => {
                  if (state.pluckSfValue('Pre_20__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_20__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_21__c', state => {
                  if (state.pluckSfValue('Pre_21__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_21__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_22__c', state => {
                  if (state.pluckSfValue('Pre_22__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_22__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_23__c', state => {
                  if (state.pluckSfValue('Pre_23__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_23__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_24__c', state => {
                  if (state.pluckSfValue('Pre_24__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_24__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_25__c', state => {
                  if (state.pluckSfValue('Pre_25__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_25__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_26__c', state => {
                  if (state.pluckSfValue('Pre_26__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_26__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_27__c', state => {
                  if (state.pluckSfValue('Pre_27__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_27__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Pre_28__c', state => {
                  if (state.pluckSfValue('Pre_28__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Pre_28__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
              )
            )(state);
          });

          //Removing mapping... need case_id to upsert Events. Date_of_Pre__c update should be handled on the SF side.
          // upsert(
          //   'Event__c',
          //   'CommCare_Ext_ID__c',
          //   fields(
          //     field('CommCare_Ext_ID__c', dataValue('form.hidden_properties.intervention_name')),
          //     field('Date_of_Pre__c', dataValue('form.date')),

          //   )
          // );
    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Upsert-pre-challenges:
        source_trigger: webhook
        target_job: Upsert-pre-challenges
        condition_type: always
        enabled: true
  "?-Upsert-ART-Adherence-Self-Reporting-Tool":
    name: '? Upsert ART Adherence Self-Reporting Tool'
    jobs:
      Upsert-ART-Adherence-Self-Reporting-Tool:
        name: Upsert ART Adherence Self-Reporting Tool
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // Push to production
          alterState(state => {

            function getAge(dateString) {
              if (!dateString) return;

              const today = new Date();
              const birthDate = new Date(dateString);
              var age = today.getFullYear() - birthDate.getFullYear();
              var m = today.getMonth() - birthDate.getMonth();
              if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                age--;
              }
              return age;
            }

            function transform(value) {
              if (!value) return;
              switch (value.toString().trim()) {
                case 'i_dont_know__i_dont_recall':
                  return "I don't know/I don't recall";
                case 'i_dont_recall':
                  return "I don't know/I don't recall";
                case 'no':
                  return 'No';
                case 'yes':
                  return 'Yes';
                case 'na':
                  return 'NA';      
                case 'disagree':
                  return '2 (Disagree)';
                case 'agree':
                  return '4 (Agree)';   
                case 'neither_agree_or_disagree':
                  return '3 (Neither Agree or Disagree)';
                case 'strongly_agree':
                  return '5 (Strongly Agree)';      
                case 'strongly_disagree':
                  return '1 (Strongly Disagree)'; 
                case 'sure':
                  return '4 (Agree)';        
                case 'very_sure':
                  return '5 (Strongly Agree)';
                case 'i_dont_know':
                  return 'I dont know';    
                case 'suppressed':
                  return 'Suppressed';  
                case 'unsuppressed':
                  return 'Unsuppressed';   
                default:
                  return value;
              }
            }

            state.helperFunctions = { getAge };
            
            state.data.form.behavioural.are_you_taking_any_other_religious_treatment_ie_holy_water_anointing_oilwat = 
            transform(state.data.form.behavioural.are_you_taking_any_other_religious_treatment_ie_holy_water_anointing_oilwat)
            
            state.data.form.behavioural.are_you_taking_any_traditional_medicine_as_a_supplement_to_the_arvs = 
            transform(state.data.form.behavioural.are_you_taking_any_traditional_medicine_as_a_supplement_to_the_arvs)
            
            state.data.form.behavioural.if_yes_to_any_of_the_above_did_it_affect_your_taking_of_medication_treatmen = 
            transform(state.data.form.behavioural.if_yes_to_any_of_the_above_did_it_affect_your_taking_of_medication_treatmen)
            
            state.data.form.behavioural.in_the_past_month_did_you_go_for_a_party_or_other_leisure_activities = 
            transform(state.data.form.behavioural.in_the_past_month_did_you_go_for_a_party_or_other_leisure_activities)
            
            state.data.form.behavioural.in_the_past_month_did_you_sleep_away_from_home = 
            transform(state.data.form.behavioural.in_the_past_month_did_you_sleep_away_from_home)
           
            state.data.form.clinical_knowledge.do_you_know_your_cd4_count = 
            transform(state.data.form.clinical_knowledge.do_you_know_your_cd4_count)
            
            state.data.form.clinical_knowledge.question16 = 
            transform(state.data.form.clinical_knowledge.question16)
            
            state.data.form.clinical_knowledge.do_you_know_your_viral_load = 
            transform(state.data.form.clinical_knowledge.do_you_know_your_viral_load)
            
            state.data.form.clinical_knowledge.when_did_you_last_go_for_these_two_clinical_tests = 
            transform(state.data.form.clinical_knowledge.when_did_you_last_go_for_these_two_clinical_tests)
            
            state.data.form.treatment_adherence.did_you_encounter_any_challenges_in_taking_your_medication_as_prescribed_in = 
            transform(state.data.form.treatment_adherence.did_you_encounter_any_challenges_in_taking_your_medication_as_prescribed_in)
            
            state.data.form.treatment_adherence.in_the_past_month_have_you_failed_to_take_any_of_your_art_treatment = 
            transform(state.data.form.treatment_adherence.in_the_past_month_have_you_failed_to_take_any_of_your_art_treatment)
            
            state.data.form.treatment_adherence.in_the_past_month_have_you_taken_any_of_your_art_treatment_at_times_other_t = 
            transform(state.data.form.treatment_adherence.in_the_past_month_have_you_taken_any_of_your_art_treatment_at_times_other_t)
            
            state.data.form.treatment_adherence.in_the_past_month_have_you_taken_less_or_more_pills_of_any_of_your_art_trea = 
            transform(state.data.form.treatment_adherence.in_the_past_month_have_you_taken_less_or_more_pills_of_any_of_your_art_trea)
            
            state.data.form['treatment_self-efficacy'].how_sure_are_you_that_you_will_be_taking_your_medication_as_are_directed = how_sure_are_you_that_you_will_be_taking_your_medication_as_are_directed = 
            transform(state.data.form['treatment_self-efficacy'].how_sure_are_you_that_you_will_be_taking_your_medication_as_are_directed)
            
            state.data.form['treatment_self-efficacy'].how_sure_are_you_that_your_medication_will_have_a_positive_effect_on_your_h = 
            transform(state.data.form['treatment_self-efficacy'].how_sure_are_you_that_your_medication_will_have_a_positive_effect_on_your_h)
            
            state.data.form['treatment_self-efficacy'].how_sure_are_you_that_your_medication_will_help_you_live_a_longer_and_healt = 
            transform(state.data.form['treatment_self-efficacy'].how_sure_are_you_that_your_medication_will_help_you_live_a_longer_and_healt)
            
            state.data.form.clinical_knowledge.question16 = 
            transform(state.data.form.clinical_knowledge.question16) 
            
            state.data.form.clinical_knowledge.when_did_you_last_have_your_clinical_test = 
            state.data.form.clinical_knowledge.when_did_you_last_have_your_clinical_test ? transform(state.data.form.clinical_knowledge.when_did_you_last_have_your_clinical_test)
            : transform(state.data.form.clinical_knowledge.when_did_you_last_go_for_these_two_clinical_tests);
            
            return state;
          });



          upsert(
            'ART_ADHERENCE_SELF_SELF_REPORTING_TOOL__c',
            'CommCare_Ext_ID__c',
            fields(
              field('CommCare_Ext_ID__c', dataValue('id')),
              field('Date__c', dataValue('form.demographic_information.date')),
              field('Sex__c', dataValue('form.gender')),
              field('Facility_Name__c', dataValue('form.school')),
              field('Patient_ID_or_Facility_File_Number__c', dataValue('form.skillz_lplus_number')),
              //field('Business_Unit__c', 'GRS Zambia'),
              field('Captured_By__c', dataValue('form.coach_name')),
              field('Verified_By__c', dataValue('form.coach_name')),
              field('Captured_Date__c', dataValue('form.demographic_information.date')),
              field('Verified_Date__c', dataValue('form.demographic_information.date')),
              field('Age__c', state => {
                const dob = dataValue('form.date_of_birth')(state);
                return state.helperFunctions.getAge(dob);
              }),    
              field(
                'Treatment_Adherence_3__c',
                dataValue('form.treatment_adherence.in_the_past_month_have_you_taken_any_of_your_art_treatment_at_times_other_t')
              ),
              field(
                'Treatment_Adherence_2__c',
                dataValue('form.treatment_adherence.in_the_past_month_have_you_failed_to_take_any_of_your_art_treatment')
              ),
              field(
                'Treatment_Adherence_4__c',
                dataValue('form.treatment_adherence.in_the_past_month_have_you_taken_less_or_more_pills_of_any_of_your_art_trea')
              ),
              field(
                'Treatment_Adherence_5_a__c',
                dataValue('form.treatment_adherence.did_you_encounter_any_challenges_in_taking_your_medication_as_prescribed_in')
              ),
              
              
              field('Clinical_Knowledge_2__c', dataValue('form.clinical_knowledge.question16')),
              field(
                'Clinical_Knowledge_1__c',
                dataValue('form.clinical_knowledge.when_did_you_last_have_your_clinical_test')
              ),
              field(
                'Treatment_Self_Efficacy__c',
                dataValue('form.treatment_self-efficacy.how_sure_are_you_that_you_will_be_taking_your_medication_as_are_directed')
              ),
              field(
                'Treatment_Self_Efficacy_10__c',
                dataValue(
                  'form.treatment_self-efficacy.how_sure_are_you_that_your_medication_will_have_a_positive_effect_on_your_h'
                )
              ),
              field(
                'Treatment_Self_Efficacy_11__c',
                dataValue(
                  'form.treatment_self-efficacy.how_sure_are_you_that_your_medication_will_help_you_live_a_longer_and_healt'
                )
              ),
              field(
                'Behavioural_Factors_12__c',
                dataValue('form.behavioural.in_the_past_month_did_you_go_for_a_party_or_other_leisure_activities')
              ),
              field('Behavioural_Factors_13__c', dataValue('form.behavioural.in_the_past_month_did_you_sleep_away_from_home')),
              field(
                'Behavioural_Factors_14__c',
                dataValue('form.behavioural.are_you_taking_any_traditional_medicine_as_a_supplement_to_the_arvs')
              ),
              field(
                'Behavioural_Factors_14__c',
                dataValue('form.behavioural.are_you_taking_any_other_religious_treatment_ie_holy_water_anointing_oilwat')
              ),
              field(
                'Behavioural_Factors_15__c',
                dataValue('form.behavioural.if_yes_to_any_of_the_above_did_it_affect_your_taking_of_medication_treatmen')
              )
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Upsert-ART-Adherence-Self-Reporting-Tool:
        source_trigger: webhook
        target_job: Upsert-ART-Adherence-Self-Reporting-Tool
        condition_type: js_expression
        condition_label: ART Adherence Self-Reporting Tool
        condition_expression: |
          state.data.form["@name"] == "ART Adherence Self-Reporting Tool" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  Upsert-Post-Challenges:
    name: Upsert Post Challenges
    jobs:
      Upsert-Post-Challenges:
        name: Upsert Post Challenges
        adaptor: '@openfn/language-salesforce@4.3.0'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          fn(state => {
            function transform(value) {
              if (!value) return;
              switch (value.toString().trim().toLowerCase()) {
                case 'true':
                case 'yes':
                case 'agree':
                case 'concordo':
                case 'verdade':
                case 'copy-1-of-yes':
                case 'choice1':
                  return 1;
                case 'false':
                case 'no':
                case 'disagree':
                case 'discordo':
                case 'falso':
                case 'copy-1-of-no':
                case 'choice3': 
                case 'choice6': 
                  return 2;
                case 'i_dont_know':
                case 'na':
                  return 3;
                case 'unanswered':
                case `not_sexually_active`:
                  return 4;
                case 'not_applicable':
                  return 5;
                default:
                  return value;
              }
            }

            state.helperFunctions = { transform };

            return query(
              `SELECT Participant_Identification_Number_PID__c from Person__c where Participant_Identification_Number_PID__c  = '${state.data.form.case['@case_id']}'`
            )(state);
          });

          fn(state => {
            const { form } = state.data;

            const formVersion = Object.keys(form).find(key => key.includes('challenge'));
            if (formVersion == 'post_challenge_ecap_-_post_-_season_survey_for_athletes') {
              console.log('Skipping upsert for ECAP data');
              return { ...state, formVersion };
            }
            console.log('form version', formVersion);

            const sfFieldMapping = {
              'portuguese_pre_challenge_gcr_-_skillz_malaria': {
                Post_1__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.dormir_dentro_da_rede_mosquiteira_tratada_todas_as_noites_pode_proteger_me_',
                Post_2__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.posso_esperar_uns_dias_antes_de_fazer_o_teste_de_malria_se_tiver_febres',
                Post_3__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.um_mdico_tradicionalcurandeiro_pode_me_dar_um_tratamento_para_curar_a_malri',
                Post_4__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.se_tiver_malria_e_no_for_tratado_posso_transmitir_a_malria_a_algum',
                Post_5__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.somente_as_mulheres_grvidas_e_as_crianas_menores_de_5_anos__que_precisam_de',
                Post_6__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.a_malria_pode_matar_se_no_fr_tratada',
                Post_7__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.a_febre__um_sintoma_da_malria',
                Post_8__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.eu_me_sinto_bem_conmigo_mesmo',
                Post_9__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.tenho_algum_na_minha_vida_que_pode_me_dar_bons_conselhos_quando_preciso_de_',
                Post_10__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.eu_sei_onde_posso_ter_tratamento_para_malria_na_minha_comunidade',
                Post_11__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.posso_proteger-me_da_malria',
              },

              'post_challenge_south_africa_-_skillz_girl': {
                Post_1__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_have_an_older_person_in_my_life_i_can_go_to_for_advice_i_have_an_older_pe',
                Post_2__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_know_how_to_make_a_plan_to_deal_with_the_challenges_i_may_face_in_reachin',
                Post_3__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Post_4__c: 'form.post_challenge_south_africa_-_skillz_girl.every_day_i_can_find_something_to_be_grateful_for',
                Post_5__c:
                  'form.post_challenge_south_africa_-_skillz_girl.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Post_6__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Post_7__c:
                  'form.post_challenge_south_africa_-_skillz_girl.girls_have_a_greater_risk_of_contracting_hiv_than_boys',
                Post_8__c:
                  'form.post_challenge_south_africa_-_skillz_girl.if_i_am_sexually_active_i_go_to_a_clinic_to_get_protection_from_hivstis_and',
                Post_9__c: 'form.post_challenge_south_africa_-_skillz_girl.like_physical_health_we_all_have_mental_health',
                Post_10__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Post_11__c:
                  'form.post_challenge_south_africa_-_skillz_girl.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Post_12__c:
                  'form.post_challenge_south_africa_-_skillz_girl.if_a_girl_is_sexually_abused_she_can_reduce_her_risk_of_getting_hiv_by_goin',
                Post_13__c:
                  'form.post_challenge_south_africa_-_skillz_girl.sometimes_a_man_may_have_a_good_reason_to_hit_his_partner',
                Post_14__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Post_15__c:
                  'form.post_challenge_south_africa_-_skillz_girl.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                Post_16__c:
                  'form.post_challenge_south_africa_-_skillz_girl.if_sexually_active_i_or_my_partner_is_using_a_prevention_method_to_protect_',
                Post_17__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_know_where_to_go_to_receive_counselling_for_mental_health_challenges',
                Post_18__c:
                  'form.post_challenge_south_africa_-_skillz_girl.loss_of_interest_in_funenjoyable_activities_is_a_common_sign_of_depression',
                Post_19__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_know_at_least_three_methods_to_prevent_an_unwanted_pregnancy',
              },
              'portuguese_post_challenge_gcr_-_skillz_girl': {
                Post_1__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.falei_sobre_o_hiv_com_uma_pessoa_adulta_nos_ltimos_2_meses_fora_do_skillz',
                Post_2__c: 'form.portuguese_post_challenge_gcr_-_skillz_girl.sei_como_expressar_a_minha_raiva_sem_ser_violento',
                Post_3__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.sei_como_superar_os_desafios_que_possa_enfrentar_na_minha_vida',
                Post_4__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.sei_quais_as_decises_a_tomar_para_alcanar_os_meus_objectivos',
                Post_5__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.os_rapazes_correm_um_risco_mais_elevado_de_serem_vtimas_de_violncia_do_que_',
                Post_6__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.conheco_que_mudanas_ocorrem_no_meu_corpo_durante_a_puberdade',
                Post_7__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.conheo_pelo_menos_trs_mtodos_para_evitar_uma_gravidez_indesejada',
                Post_8__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.os_preservativos_so_o_nico_mtodo_contraceptivo_que_protege_contra_a_gravide',
                Post_9__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.conheco_onde_obter_servios_de_apoio_para_mim_ou_outra_pessoa_para_casos_de_',
                Post_10__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.se_uma_rapariga_inicia_seu_perodo_menstrual_significa_que_est_pronta_para_c',
                Post_11__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.caso_eu_seja_abusada_sexualmente_prefiro_guard-lo_para_mim_para_evitar_que_',
                Post_12__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.um_homem_tem_o_direito_de_ter_sexo_com_a_sua_namorada_mesmo_que_ela_no_o_qu',
                Post_13__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.pessoas_com_problemas_de_sade_mental_so_apenas_confusas_ou_loucas',
                Post_14__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.pessoas_com_problemas_de_sade_mental_so_apenas_confusas_ou_loucas',
                Post_15__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.informaria_a_algum_caso_fosse_tocada_por_alguem_de_uma_forma_que_me_deixass',
                Post_16__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.uma_filha_deve_sempre_respeitar_a_deciso_dos_seus_pais_para_se_casar',
                Post_17__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.um_casamento_bem_sucedido__mais_importante_para_as_raparigas_do_que_termina',
                Post_18__c: 'form.portuguese_post_challenge_gcr_-_skillz_girl.eu_no_praticaria_desporto_com_algum_que_tem_hiv',
                Post_19__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.um_namorado_pode_ter_boas_razes_para_bater_na_sua_namorada',
                Post_20__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.no_faz_mal_que_um_rapaz_ameace_bater_na_sua_namorada_se_nunca_a_bater_fisic',
              },
              'post_challenge_zambia_-_plus_mh_enhanced_zambia': {
                Post_1__c: 'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.in_general_i_feel_good_about_myself',
                Post_2__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.i_have_the_skills_and_knowledge_to_avoid_getting_infected_with_another_kind',
                Post_3__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_important_to_know_why_and_how_i_want_to_tell_someone_my_hiv_status',
                Post_4__c: 'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.i_accept_myself_and_my_hiv_status',
                Post_5__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Post_6__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.are_you_or_have_you_been_past_12_months_in_a_sexual_relationship_na_if_not_',
                Post_7__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
                Post_8__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                Post_9__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.there_are_people_i_trust_with_whom_i_can_talk_about_my_status',
                Post_10__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_okay_for_two_people_with_hiv_to_have_unprotected_sex_with_each_other',
                Post_11__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_okay_for_someone_with_hiv_to_stop_taking_their_arv_as_soon_as_they_st',
                Post_12__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.when_i_have_a_choice_it_is_important_to_eat_a_variety_of_foods_including_gr',
                Post_13__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.mental_health_problems_have_nothing_to_do_with_being_lazy_or_weak_and_many_',
                Post_14__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.art_adherence_is_an_important_part_of_my_overall_health_and_well-being',
                Post_15__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.the_most_common_illnesses_of_mental_health_are_depression_and_anxiety',
                Post_16__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.biological_and_social_factors_contribute_to_females_and_males_experiencing_',
              },
              'post_challenge_nigeria_-_advanced_skills': {
                Post_1__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_have_talked_about_hiv_with_an_adult_in_the_past_two_months_outside_skillz',
                Post_2__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_have_talked_about_malaria_with_an_adult_in_the_past_two_months_outside_sk',
                Post_3__c:
                  'form.post_challenge_nigeria_-_advanced_skills.unequal_power_in_relationships_can_contribute_to_the_spread_of_hiv',
                Post_4__c:
                  'form.post_challenge_nigeria_-_advanced_skills.the_most_effective_way_to_avoid_getting_hiv_is_to_abstain_from_sex',
                Post_5__c: 'form.post_challenge_nigeria_-_advanced_skills.malaria_is_spread_by_standing_under_the_hot_sun',
                Post_6__c: 'form.post_challenge_nigeria_-_advanced_skills.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                Post_7__c:
                  'form.post_challenge_nigeria_-_advanced_skills.sleeping_under_a_mosquito_net_every_night_can_help_protect_me_from_malaria',
                Post_8__c:
                  'form.post_challenge_nigeria_-_advanced_skills.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                Post_9__c:
                  'form.post_challenge_nigeria_-_advanced_skills.it_is_okay_for_someone_with_malaria_to_stop_taking_their_medication_as_soon',
                Post_10__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_can_abstain_from_sex_until_i_am_older_even_if_it_is_difficult',
                Post_11__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Post_12__c:
                  'form.post_challenge_nigeria_-_advanced_skills.men_should_share_the_work_around_the_house_such_as_cleaning',
                Post_13__c:
                  'form.post_challenge_nigeria_-_advanced_skills.it_is_the_males_responsibilty_to_make_decisions_in_a_relationship',
                Post_14__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_can_use_drugs_and_still_easily_reach_my_goals_in_life',
                Post_15__c:
                  'form.post_challenge_nigeria_-_advanced_skills.when_sick_it_is_better_to_visit_the_herb_seller_than_to_visit_a_doctor_or_a',
                Post_16__c:
                  'form.post_challenge_nigeria_-_advanced_skills.it_is_okay_to_use_violence_with_my_partner_if_he_or_she_makes_me_angry',
                Post_17__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_have_the_power_to_change_gender_expectations_that_i_do_not_agree_with',
              },
              'post_challenge_zimbabwe_-_skillz_core_zimbabwe': {
                Post_1__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_know_what_decisions_to_make_to_achieve_my_goals',
                Post_2__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girlboy',
                Post_3__c: 'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_what_i_am_good_at',
                Post_4__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                Post_5__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Post_6__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Post_7__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_access_sexual_health_services_such_as_sti_and_hiv_testi',
                Post_8__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Post_9__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Post_10__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.girls_should_be_obedient_and_should_not_disagree_with_boys',
                Post_11__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                Post_12__c: 'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.my_skillz_coach_helps_me_to_be_a_better_person',
                Post_13__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                Post_14__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.if_i_test_positive_for_hiv_there_will_be_someone_who_will_help_and_support_',
                Post_15__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_who_to_go_to_if_i_amsomeone_i_know_is_abused_sexually_physically_and',
                Post_16__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_who_to_go_to_if_someone_touches_me_in_a_way_that_makes_me_uncomforta',
                Post_17__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                Post_18__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Post_19__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
              },
              'copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe': {
                Post_1__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_know_what_decisions_to_make_to_achieve_my_goals',
                Post_2__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_dont_always_have_to_do_what_people_expect_just_because_i_am_girlboy',
                Post_3__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Post_4__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_can_make_my_own_informed_decisions_about_my_sexual_health',
                Post_5__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Post_6__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Post_7__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.my_skillz_coach_helps_me_to_be_a_better_person',
                Post_8__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advise_or_when_i_have_a',
                Post_9__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
              },
              'post_challenge_skillz_girl_-_zam_311': {
                Post_1__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_what_i_am_good_at',
                Post_2__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_how_to_overcome_challenges_that_i_may_face_in_my_life',
                Post_3__c: 'form.post_challenge_skillz_girl_-_zam_311.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girl',
                Post_4__c: 'form.post_challenge_skillz_girl_-_zam_311.i_would_be_able_to_ask_my_boyfriend_that_i_want_to_use_a_condom',
                Post_5__c: 'form.post_challenge_skillz_girl_-_zam_311.i_can_say_no_to_sex_even_if_my_boyfriend_or_friends_pressure_me_to_have_sex',
                Post_6__c: 'form.post_challenge_skillz_girl_-_zam_311.if_i_am_sexually_active_i_go_to_a_healthcare_provider_to_get_protection_fro',
                Post_7__c: 'form.post_challenge_skillz_girl_-_zam_311.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Post_8__c: 'form.post_challenge_skillz_girl_-_zam_311.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                Post_9__c: 'form.post_challenge_skillz_girl_-_zam_311.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Post_10__c: 'form.post_challenge_skillz_girl_-_zam_311.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_or_wife',
                Post_11__c: 'form.post_challenge_skillz_girl_-_zam_311.a_successful_marriage_is_more_important_to_girls_than_completing_school',
                Post_12__c: 'form.post_challenge_skillz_girl_-_zam_311.a_daughter_should_always_respect_her_parents_decision_for_her_to_get_marrie',
                Post_13__c: 'form.post_challenge_skillz_girl_-_zam_311.i_can_decide_when_is_the_right_time_for_me_to_have_a_baby',
                Post_14__c: 'form.post_challenge_skillz_girl_-_zam_311.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                Post_15__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                Post_16__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_gender_base',
                Post_17__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_prevention_',
                Post_18__c: 'form.post_challenge_skillz_girl_-_zam_311.one_sign_of_pregnancy_is_a_girl_missing_her_period',
                Post_19__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_at_least_three_methods_to_avoid_an_unwanted_pregnancy',
                Post_20__c: 'form.post_challenge_skillz_girl_-_zam_311.are_you_or_your_boyfriend_currently_using_any_contraceptive_method',
              },
              'post_challenge_skillz_core_zambia_211': {
                Post_1__c: 'form.post_challenge_skillz_core_zambia_211.question1',
                Post_2__c: 'form.post_challenge_skillz_core_zambia_211.i_know_how_to_overcome_challenges_i_may_have_in_my_life',
                Post_3__c: 'form.post_challenge_skillz_core_zambia_211.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                Post_4__c: 'form.post_challenge_skillz_core_zambia_211.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Post_5__c: 'form.post_challenge_skillz_core_zambia_211.i_dont_always_have_to_do_what_people_expect_because_i_am_a_boygirl',
                Post_6__c: 'form.post_challenge_skillz_core_zambia_211.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Post_7__c: 'form.post_challenge_skillz_core_zambia_211.girls_should_not_disagree_with_boys',
                Post_8__c: 'form.post_challenge_skillz_core_zambia_211.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                Post_9__c: 'form.post_challenge_skillz_core_zambia_211.i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Post_10__c: 'form.post_challenge_skillz_core_zambia_211.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                Post_11__c: 'form.post_challenge_skillz_core_zambia_211.if_i_test_positive_for_hivthere_will_be_someone_who_will_help_and_support_m',
                Post_12__c: 'form.post_challenge_skillz_core_zambia_211.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                Post_13__c: 'form.post_challenge_skillz_core_zambia_211.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                Post_14__c: 'form.post_challenge_skillz_core_zambia_211.i_know_where_to_get_support_services_for_me_or_someone_elsefor_hiv_-_relate',
                Post_15__c: 'form.post_challenge_skillz_core_zambia_211.i_know_where_to_get_support_services_for_me_or_someone_elsefor_abuse',
                Post_16__c: 'form.post_challenge_skillz_core_zambia_211.i_have_the_right_to_access_sexual_health_servicessuch_as_sti_and_hiv_testin',
                Post_17__c: 'form.post_challenge_skillz_core_zambia_211.one_sign_of_pregnancy_is_a_girl_missing_her_period',
                Post_18__c: 'form.post_challenge_skillz_core_zambia_211.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Post_19__c: 'form.post_challenge_skillz_core_zambia_211.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
                Post_20__c: 'form.post_challenge_skillz_core_zambia_211.i_know_what_decisions_to_make_to_achieve_my_goals',
              },
              'post_challenge_skillz_boy_zambia110': {
                Post_1__c: 'form.post_challenge_skillz_boy_zambia110.in_general_i_feel_good_about_myself',
                Post_2__c: 'form.post_challenge_skillz_boy_zambia110.i_would_be_able_to_ask_my_girlfriend_that_i_want_to_use_a_condom',
                Post_3__c: 'form.post_challenge_skillz_boy_zambia110.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_boy',
                Post_4__c: 'form.post_challenge_skillz_boy_zambia110.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Post_5__c: 'form.post_challenge_skillz_boy_zambia110.it_is_more_important_for_boys_to_be_educated_than_girls',
                Post_6__c: 'form.post_challenge_skillz_boy_zambia110.men_are_better_leaders_than_women',
                Post_7__c: 'form.post_challenge_skillz_boy_zambia110.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Post_8__c: 'form.post_challenge_skillz_boy_zambia110.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                Post_9__c: 'form.post_challenge_skillz_boy_zambia110.it_is_okay_for_a_boyfriend_to_threaten_to_hit_his_girlfriend_if_he_never_hi',
                Post_10__c: 'form.post_challenge_skillz_boy_zambia110.i_can_say_no_to_sex_even_if_my_friends_or_girlfriend_pressure_me_to_have_se',
                Post_11__c: 'form.post_challenge_skillz_boy_zambia110.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_sexual_behaviou',
                Post_12__c: 'form.post_challenge_skillz_boy_zambia110.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Post_13__c: 'form.post_challenge_skillz_boy_zambia110.i_have_a_friend_that_i_can_go_to_for_advice_when_i_have_a_problem',
                Post_14__c: 'form.post_challenge_skillz_boy_zambia110.i_have_the_right_to_access_sexual_health_services_such_as_hiv_and_sti_testi',
                Post_15__c: 'form.post_challenge_skillz_boy_zambia110.i_know_where_to_access_sexual_health_services_such_as_sti_and_hiv_testing',
                Post_16__c: 'form.post_challenge_skillz_boy_zambia110.before_making_a_decision_i_think_about_how_it_can_affect_me_or_others',
                Post_17__c: 'form.post_challenge_skillz_boy_zambia110.i_know_how_to_express_my_anger_without_being_violent_such_as_hitting_kickin',
                Post_18__c: 'form.post_challenge_skillz_boy_zambia110.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                Post_19__c: 'form.post_challenge_skillz_boy_zambia110.i_know_how_to_correctly_use_a_male_condom',
                Post_20__c: 'form.post_challenge_skillz_boy_zambia110.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
              },
              'post_challenge_skillz_guyz_mh_-_sa_100':{
                Post_1__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_have_to_be_respectful_communicate_and_take_action_to_be_a_role_model_in_m',
                Post_2__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_have_skills_that_help_me_bounce_back_from_difficult_situations',
                Post_3__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_can_identify_my_strengths_or_things_that_i_am_good_at',
                Post_4__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.when_i_am_angry_i_know_how_to_avoid_using_violent_behaviour',
                Post_5__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.when_i_express_my_feelings_clearly_people_understand_me_better',
                Post_6__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Post_7__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.sadness_and_a_loss_of_pleasure_in_things_you_enjoy_are_common_symptoms_of_d',
                Post_8__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_know_where_to_access_health_services_and_mental_health_services',
                Post_9__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_will_share_accurate_information_about_mental_health_services_to_avoid_sti',
                Post_10__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                Post_11__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.men_should_share_the_work_around_the_house_such_as_cleaning_and_taking_care',
                Post_12__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.its_okay_for_a_guy_to_beat_a_girl_when_there_is_a_misunderstanding',
                Post_13__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_should_respect_the_rights_of_others_such_as_their_right_to_their_own_opin',
                Post_14__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_feel_confident_setting_my_goals',
                Post_15__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.stress_is_a_normal_part_of_life',
                Post_16__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Post_17__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.there_are_people_i_trust_with_whom_i_can_talk_to_about_my_mental_health',
                Post_18__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_have_no_fear_or_shame_when_accessing_health_services_or_mental_health_ser',
                Post_19__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                Post_20__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Post_21__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_can_stand_up_to_peer_pressure_when_i_have_to',
                Post_22__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_should_use_a_condom_even_if_my_girlfriend_is_on_another_form_of_birth_con',
                Post_23__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_know_where_to_go_for_support_if_i_or_someone_i_know_abuses_alcohol',
              },
              'post_challenge_mindskillz-_zambia_100': {
                  Post_1__c:'form.post_challenge_mindskillz-_zambia_100.when_i_express_my_feelings_clearly_people_understand_me_better',
                  Post_2__c:'form.post_challenge_mindskillz-_zambia_100.i_have_skills_that_help_me_bounce_back_from_difficult_situations',
                  Post_3__c:'form.post_challenge_mindskillz-_zambia_100.stress_is_a_normal_part_of_life',
                  Post_4__c:'form.post_challenge_mindskillz-_zambia_100.i_can_reach_my_goals_in_life',
                  Post_5__c:'form.post_challenge_mindskillz-_zambia_100.if_i_have_a_problem_i_have_someone_in_my_life_i_can_go_to_for_support',
                  Post_6__c:'form.post_challenge_mindskillz-_zambia_100.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                  Post_7__c:'form.post_challenge_mindskillz-_zambia_100.self_control_helps_you_make_smart_decisions_when_you_are_angry_or_upset',
                  Post_8__c:'form.post_challenge_mindskillz-_zambia_100.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                  Post_9__c:'form.post_challenge_mindskillz-_zambia_100.i_know_how_to_express_my_anger_without_being_violent',
                  Post_10__c:'form.post_challenge_mindskillz-_zambia_100.listening_carefully_to_others_is_an_important_communication_skill',
                  Post_11__c:'form.post_challenge_mindskillz-_zambia_100.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                  Post_12__c:'form.post_challenge_mindskillz-_zambia_100.i_can_understand_how_others_are_feeling_and_be_sensitive_to_their_emotions',
                  Post_13__c:'form.post_challenge_mindskillz-_zambia_100.i_am_confident_that_i_know_where_to_seek_information_about_mental_illness',
                  Post_14__c:'form.post_challenge_mindskillz-_zambia_100.i_am_confident_using_the_computer_or_telephone_to_seek_information_about_me',
                  Post_15__c:'form.post_challenge_mindskillz-_zambia_100.i_am_confident_attending_face_to_face_appointments_to_seek_information_abou',
                  Post_16__c:'form.post_challenge_mindskillz-_zambia_100.i_am_confident_i_have_access_to_resources_eg_doctor_internet_friends_that_i',
                  Post_17__c:'form.post_challenge_mindskillz-_zambia_100.people_with_mental_illness_could_snap_out_of_it_if_they_wanted',
                  Post_18__c:'form.post_challenge_mindskillz-_zambia_100.a_mental_illness_is_a_sign_of_personal_weakness',
                  Post_19__c:'form.post_challenge_mindskillz-_zambia_100.a_mental_illness_is_not_a_real_medical_illness',
                  Post_20__c:'form.post_challenge_mindskillz-_zambia_100.people_with_mental_illness_are_dangerous',
                  Post_21__c:'form.post_challenge_mindskillz-_zambia_100.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                  Post_22__c:'form.post_challenge_mindskillz-_zambia_100.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                  Post_23__c:'form.post_challenge_mindskillz-_zambia_100.seeing_a_mental_health_professional_means_you_are_not_strong_enough_to_mana',
                  Post_24__c:'form.post_challenge_mindskillz-_zambia_100.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi',
                  Post_25__c:'form.post_challenge_mindskillz-_zambia_100.i_believe_treatment_for_a_mental_illness_provided_by_a_mental_health_profes',
                        },
                        
                'post_challenge_skillz_girl_nih200': {
                  Post_1__c:'form.post_challenge_skillz_girl_nih200.i_have_talked_about_hiv_with_an_adult_in_the_past_two_months_outside_skillz',
          Post_2__c:'form.post_challenge_skillz_girl_nih200.i_have_talked_about_hiv_with_a_friend_in_the_past_two_months_outside_skillz',
          Post_3__c:'form.post_challenge_skillz_girl_nih200.having_sex_with_an_older_partner_increases_my_risk_of_getting_hiv',
          Post_4__c:'form.post_challenge_skillz_girl_nih200.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
          Post_5__c:'form.post_challenge_skillz_girl_nih200.i_know_someone_in_my_community_who_distributes_contraceptives_and_other_sex',
          Post_6__c:'form.post_challenge_skillz_girl_nih200.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
          Post_7__c:'form.post_challenge_skillz_girl_nih200.i_have_the_right_to_say_no_to_sex_no_matter_who_asks',
          Post_8__c:'form.post_challenge_skillz_girl_nih200.as_a_girl_i_have_a_greater_risk_of_getting_hiv_than_boys',
          Post_9__c:'form.post_challenge_skillz_girl_nih200.i_know_where_to_get_support_services_for_rape',
          Post_10__c:'form.post_challenge_skillz_girl_nih200.if_a_girl_is_sexually_abused_she_can_reduce_her_risk_of_getting_hiv_by_taki',
          Post_11__c:'form.post_challenge_skillz_girl_nih200.i_feel_good_about_being_a_girl',
          Post_12__c:'form.post_challenge_skillz_girl_nih200.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
          Post_13__c:'form.post_challenge_skillz_girl_nih200.boys_should_share_the_work_around_the_home_such_as_household_chores',
          Post_14__c:'form.post_challenge_skillz_girl_nih200.i_know_what_i_want_to_be_after_finishing_secondary_school',
          Post_15__c:'form.post_challenge_skillz_girl_nih200.if_i_have_a_problem_i_have_someone_in_my_life_i_can_talk_to_for_advise',
          Post_16__c:'form.post_challenge_skillz_girl_nih200.a_boyfriend_may_have_good_reason_to_hit_his_girlfriend',
          Post_17__c:'form.post_challenge_skillz_girl_nih200.i_would_tell_someone_if_i_were_touched_in_a_manner_that_made_me_uncomfortab',
          Post_18__c:'form.post_challenge_skillz_girl_nih200.i_can_reach_my_goals_in_life',
          Post_19__c:'form.post_challenge_skillz_girl_nih200.a_girl_should_wait_to_get_married_until_after_college',
          Post_20__c:'form.post_challenge_skillz_girl_nih200.biological_and_social_factors_contribute_to_females_and_males_experiencing_',
          Post_21__c:'form.post_challenge_skillz_girl_nih200.the_most_common_illness_of_mental_health_are_depression_and_anxiety',
          Post_22__c:'form.post_challenge_skillz_girl_nih200.mental_health_problems_have_nothing_to_do_with_being_lazy_or_weak_and_many_',
          Post_23__c:'form.post_challenge_skillz_girl_nih200.i_am_ready_to_take_an_hiv_test',
          Post_24__c:'form.post_challenge_skillz_girl_nih200.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
                },
                
                'post_challenge_mindskillz_pamumvuri':{
                  Post_1__c: 'form.post_challenge_mindskillz_pamumvuri.when_i_express_my_feelings_clearly_people_understand_me_better',
                  Post_2__c: 'form.post_challenge_mindskillz_pamumvuri.have_skills_that_help_me_bounce_back_from_difficult_situations',
                  Post_3__c: 'form.post_challenge_mindskillz_pamumvuri.stress_is_a_normal_part_of_life',
                  Post_4__c: 'form.post_challenge_mindskillz_pamumvuri.i_can_reach_my_goals_in_life',
                  Post_5__c: 'form.post_challenge_mindskillz_pamumvuri.if_i_have_a_problem_i_have_someone_in_my_life_i_can_go_to_for_support',
                  Post_6__c: 'form.post_challenge_mindskillz_pamumvuri.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                  Post_7__c: 'form.post_challenge_mindskillz_pamumvuri.self_control_helps_you_make_smart_decisions_when_you_are_angry_or_upset',
                  Post_8__c: 'form.post_challenge_mindskillz_pamumvuri.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                  Post_9__c: 'form.post_challenge_mindskillz_pamumvuri.i_know_how_to_express_my_anger_without_being_violent',
                  Post_10__c: 'form.post_challenge_mindskillz_pamumvuri.listening_carefully_to_others_is_an_important_communication_skill',
                  Post_11__c: 'form.post_challenge_mindskillz_pamumvuri.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                  Post_12__c: 'form.post_challenge_mindskillz_pamumvuri.i_can_understand_how_others_are_feeling_and_be_sensitive_to_their_emotions',
                  Post_13__c: 'form.post_challenge_mindskillz_pamumvuri.i_am_confident_that_i_know_where_to_seek_information_about_mental_illness',
                  Post_14__c: 'form.post_challenge_mindskillz_pamumvuri.i_am_confident_using_the_computer_or_telephone_to_seek_information_about_me',
                  Post_15__c: 'form.post_challenge_mindskillz_pamumvuri.i_am_confident_attending_face_to_face_appointments_to_seek_information_abou',
                  Post_16__c: 'form.post_challenge_mindskillz_pamumvuri.i_am_confident_i_have_access_to_resources_eg_doctor_internet_friends_that_i',
                  Post_17__c: 'form.post_challenge_mindskillz_pamumvuri.people_with_mental_illness_could_snap_out_of_it_if_they_wanted',
                  Post_18__c: 'form.post_challenge_mindskillz_pamumvuri.a_mental_illness_is_a_sign_of_personal_weakness',
                  Post_19__c: 'form.post_challenge_mindskillz_pamumvuri.a_mental_illness_is_not_a_real_medical_illness',
                  Post_20__c: 'form.post_challenge_mindskillz_pamumvuri.people_with_mental_illness_are_dangerous',
                  Post_21__c: 'form.post_challenge_mindskillz_pamumvuri.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                  Post_22__c: 'form.post_challenge_mindskillz_pamumvuri.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                  Post_23__c: 'form.post_challenge_mindskillz_pamumvuri.seeing_a_mental_health_professional_means_you_are_not_strong_enough_to_mana',
                  Post_24__c: 'form.post_challenge_mindskillz_pamumvuri.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi',
                  Post_25__c: 'form.post_challenge_mindskillz_pamumvuri.i_believe_treatment_for_a_mental_illness_provided_by_a_mental_health_profes',

                },
              
              'post_challenge_south_africa_-_skillz_girl_mh_sa_211':{
                Post_1__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_my_rights_and_responsibilities',
                Post_2__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Post_3__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Post_4__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.stress_is_a_normal_part_of_life',
                Post_5__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.like_physical_health_we_all_have_mental_health',
                Post_6__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Post_7__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.healthy_relationships_are_based_on_healthy_communication_and_mutual_respect',
                Post_8__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_partner_or_wif',
                Post_9__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Post_10__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Post_11__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.taking_prep_and_using_a_condom_can_lower_my_risk_of_getting_hiv',
                Post_12__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Post_13__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Post_14__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.post_exposure_prophylaxis_pep_can_reduce_my_risk_of_getting_hiv_if_taken_1-',
                Post_15__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.it_is_my_right_to_access_health_services',
                Post_16__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_have_an_adult_or_someone_in_my_life_i_can_go_to_for_advice',
                Post_17__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_give_support_and_encouragement_to_a_friend_or_family_member_who_is_li',
                Post_18__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.using_a_condom_and_another_contraceptive_method_can_help_prevent_unwanted_p',
                Post_19__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Post_20__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.drinking_too_much_alcohol_can_harm_the_body_and_the_mind',
              },
              
               'post_challenge_skillz_girl_abbreviated_south_africa':{
                Post_1__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_know_my_rights_and_responsibilities',
                Post_2__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Post_3__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Post_4__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.stress_is_a_normal_part_of_life',
                Post_5__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.like_physical_health_we_all_have_mental_health',
                Post_6__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Post_7__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.in_a_relationship_it_is_both_partners_responsibility_to_prevent_unwanted_pr',
                Post_8__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.healthy_relationships_are_based_on_healthy_communication_and_respect',
                Post_9__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_partner_or_wif',
                Post_10__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.a_person_has_the_right_to_have_sex_with_their_partner_even_if_the_partner_d',
                Post_11__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Post_12__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Post_13__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.taking_prep_and_using_a_condom_can_lower_my_risk_of_getting_hiv',
                Post_14__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Post_15__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Post_16__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_can_use_coping_skills_to_handle_stress',
                Post_17__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.post_exposure_prophylaxis_pep_can_reduce_my_risk_of_getting_hiv_if_taken_1-',
                Post_18__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.it_is_my_right_to_access_health_services',
                Post_19__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_have_an_adult_or_someone_in_my_life_i_can_go_to_for_advice',
                Post_20__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.using_a_condom_and_another_contraceptive_method_can_help_prevent_unwanted_p',
                Post_21__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Post_22__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.drinking_too_much_alcohol_can_harm_the_body_and_mind',
                Post_23__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_know_at_least_two_ways_of_saving_money',
                Post_24__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.a_budget_is_the_estimated_income_and_expenses_for_a_certain_time_period',
                Post_25__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.accepting_money_for_sexual_favors_can_create_risks_to_my_health_and_safety',
                Post_26__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.using_assertive_communication_means_respectfully_sharing_my_thoughts_and_fe',
                Post_27__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_have_the_right_to_access_emergency_contraception',
                Post_28__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.if_a_girl_has_unprotected_sex_and_misses_her_period_this_could_mean_she_is_',
              },
              
              'post_challenge_skillz_guyz_-_yedi__323':{
                 Post_1__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_know_how_to_stand_up_to_peer_pressure_ie_to_drink_alcohol_or_have_sex_fro',
                 Post_2__c: 'form.post_challenge_skillz_guyz_-_yedi__323.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Post_3__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_have_someone_i_can_go_to_for_advice',
                 Post_4__c: 'form.post_challenge_skillz_guyz_-_yedi__323.no_one_has_the_right_to_touch_me_in_a_way_that_makes_me_uncomfortable_such_',
                 Post_5__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                 Post_6__c: 'form.post_challenge_skillz_guyz_-_yedi__323.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_behaviours_such',
                 Post_7__c: 'form.post_challenge_skillz_guyz_-_yedi__323.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                 Post_8__c: 'form.post_challenge_skillz_guyz_-_yedi__323.a_mental_illness_is_a_sign_of_personal_weakness',
                 Post_9__c: 'form.post_challenge_skillz_guyz_-_yedi__323.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Post_10__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                 Post_11__c: 'form.post_challenge_skillz_guyz_-_yedi__323.a_boys_opinion_is_more_important_than_a_girls',
                 Post_12__c: 'form.post_challenge_skillz_guyz_-_yedi__323.men_should_share_the_work_around_the_house_such_as_cleaning_and_taking_care',
                 Post_13__c: 'form.post_challenge_skillz_guyz_-_yedi__323.its_okay_for_a_guy_to_beat_a_girl_when_she_misbehaves',
                 Post_14__c: 'form.post_challenge_skillz_guyz_-_yedi__323.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Post_15__c: 'form.post_challenge_skillz_guyz_-_yedi__323.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                 Post_16__c: 'form.post_challenge_skillz_guyz_-_yedi__323.condoms_are_the_only_contraceptive_method_that_protect_against_pregnancy_as',
                 Post_17__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_would_stand_up_to_my_friends_if_they_were_harming_others_such_as_touching',
                 Post_18__c: 'form.post_challenge_skillz_guyz_-_yedi__323.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                 Post_19__c: 'form.post_challenge_skillz_guyz_-_yedi__323.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                 Post_20__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_have_the_ability_to_shape_my_own_life',
              },
              
                'post_challenge_skillz_girl_mh_zambia':{
                 Post_1__c: 'form.post_challenge_skillz_girl_mh_zambia.a_mental_illness_is_a_sign_of_personal_weakness',
                 Post_2__c: 'form.post_challenge_skillz_girl_mh_zambia.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Post_3__c: 'form.post_challenge_skillz_girl_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girl',
                 Post_4__c: 'form.post_challenge_skillz_girl_mh_zambia.if_i_had_a_boyfriend_i_would_be_able_to_ask_him_to_use_a_condom_before_havi',
                 Post_5__c: 'form.post_challenge_skillz_girl_mh_zambia.i_can_say_no_to_sex_even_if_my_boyfriend_or_friends_pressure_to_have_sex',
                 Post_6__c: 'form.post_challenge_skillz_girl_mh_zambia.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Post_7__c: 'form.post_challenge_skillz_girl_mh_zambia.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                 Post_8__c: 'form.post_challenge_skillz_girl_mh_zambia.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Post_9__c: 'form.post_challenge_skillz_girl_mh_zambia.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                 Post_10__c: 'form.post_challenge_skillz_girl_mh_zambia.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_or_wife',
                 Post_11__c: 'form.post_challenge_skillz_girl_mh_zambia.a_successful_marrige_is_more_important_to_girls_than_completing_school',
                 Post_12__c: 'form.post_challenge_skillz_girl_mh_zambia.a_daughter_should_always_respect_her_parents_decision_to_get_married',
                 Post_13__c: 'form.post_challenge_skillz_girl_mh_zambia.i_can_decide_when_is_the_right_time_for_me_to_have_a_baby',
                 Post_14__c: 'form.post_challenge_skillz_girl_mh_zambia.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                 Post_15__c: 'form.post_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                 Post_16__c: 'form.post_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_gender_base',
                 Post_17__c: 'form.post_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_prevention_',
                 Post_18__c: 'form.post_challenge_skillz_girl_mh_zambia.if_sexually_active_one_sign_of_pregnance_is_a_girl_missing_her_period',
                 Post_19__c: 'form.post_challenge_skillz_girl_mh_zambia.i_know_at_least_three_methods_to_avoid_an_unwanted_pregnancy',
                 Post_20__c: 'form.post_challenge_skillz_girl_mh_zambia.are_you_or_your_boyfriend_currently_using_any_contraceptive_method',
                 
              },
              
              'post_challenge_skillz_core_mh_zambia':{
                 Post_1__c: 'form.post_challenge_skillz_core_mh_zambia.i_know_what_i_am_good_at',
                 Post_2__c: 'form.post_challenge_skillz_core_mh_zambia.i_know_how_to_overcome_challenges_that_i_may_have_in_life',
                 Post_3__c: 'form.post_challenge_skillz_core_mh_zambia.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                 Post_4__c: 'form.post_challenge_skillz_core_mh_zambia.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                 Post_5__c: 'form.post_challenge_skillz_core_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girlboy',
                 Post_6__c: 'form.post_challenge_skillz_core_mh_zambia.a_man_has_the_right_to_have_sex_with_his_wifegirlfriend_even_if_she_doesnt_',
                 Post_7__c: 'form.post_challenge_skillz_core_mh_zambia.girls_should_not_disagree_with_boys',
                 Post_8__c: 'form.post_challenge_skillz_core_mh_zambia.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                 Post_9__c: 'form.post_challenge_skillz_core_mh_zambia.i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                 Post_10__c: 'form.post_challenge_skillz_core_mh_zambia.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                 Post_11__c: 'form.post_challenge_skillz_core_mh_zambia.if_i_test_positive_for_hiv_there_will_be_someone_who_will_help_and_support_',
                 Post_12__c: 'form.post_challenge_skillz_core_mh_zambia.people_with_mental_illness_live_on_the_streets_and_eat_dirty_food_from_garb',
                 Post_13__c: 'form.post_challenge_skillz_core_mh_zambia.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                 Post_14__c: 'form.post_challenge_skillz_core_mh_zambia.i_only_use_violent_behaviour_when_someone_angers_me',
                 Post_15__c: 'form.post_challenge_skillz_core_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_abuse_or_hi',
                 Post_16__c: 'form.post_challenge_skillz_core_mh_zambia.i_have_the_right_to_access_sexual_health_services_such_as_sti_and_hiv_testi',
                 Post_17__c: 'form.post_challenge_skillz_core_mh_zambia.if_sexually_active_one_sign_of_pregnancy_can_be_a_girl_missing_her_period',
                 Post_18__c: 'form.post_challenge_skillz_core_mh_zambia.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                 Post_19__c: 'form.post_challenge_skillz_core_mh_zambia.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
                 Post_20__c: 'form.post_challenge_skillz_core_mh_zambia.i_know_what_decisions_to_make_to_achieve_my_goals',
              },
              
              'post_challenge_skillz_guyz_mh_zambia':{
                 Post_1__c: 'form.post_challenge_skillz_guyz_mh_zambia.a_mental_illness_is_a_sign_of_personal_weakness',
                 Post_2__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_would_be_able_to_tell_my_girlfriend_that_i_want_to_use_a_condom',
                 Post_3__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_boy',
                 Post_4__c: 'form.post_challenge_skillz_guyz_mh_zambia.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                 Post_5__c: 'form.post_challenge_skillz_guyz_mh_zambia.it_is_more_important_for_boys_to_be_educated_than_girls',
                 Post_6__c: 'form.post_challenge_skillz_guyz_mh_zambia.men_are_better_leaders_than_women',
                 Post_7__c: 'form.post_challenge_skillz_guyz_mh_zambia.a_manboy_has_the_right_to_have_sex_with_his_girlfriendwomanwife_even_if_she',
                 Post_8__c: 'form.post_challenge_skillz_guyz_mh_zambia.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Post_9__c: 'form.post_challenge_skillz_guyz_mh_zambia.it_is_okay_for_a_boyfriend_to_threaten_to_hit_his_girlfriend_if_he_never_hi',
                 Post_10__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_can_say_no_to_sex_even_if_my_friends_or_girlfriend_pressure_me_to_have_se',
                 Post_11__c: 'form.post_challenge_skillz_guyz_mh_zambia.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_sexual_behaviou',
                 Post_12__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                 Post_13__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_have_a_friend_that_i_can_go_to_for_advice_when_i_have_a_problem',
                 Post_14__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_have_the_right_to_access_sexual_health_services_such_as_hiv_and_sti_testi',
                 Post_15__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_know_where_to_access_sexual_health_services_such_as_sti_and_hiv_testing',
                 Post_16__c: 'form.post_challenge_skillz_guyz_mh_zambia.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Post_17__c: 'form.post_challenge_skillz_guyz_mh_zambia.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Post_18__c: 'form.post_challenge_skillz_guyz_mh_zambia.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                 Post_19__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_know_how_to_correctly_use_a_male_condom',
                 Post_20__c: 'form.post_challenge_skillz_guyz_mh_zambia.are_you_or_your_girlfriend_currently_using_any_contraceptive_or_protective_',
                 
              },
              
              'post_challenge_mindskillz_sa_10':{
                Post_1__c: 'form.post_challenge_mindskillz_sa_10.mental_health_is_about_how_we_think_feel_and_act',
                Post_2__c: 'form.post_challenge_mindskillz_sa_10.i_can_name_the_feelings_i_have_when_im_happy_sad_or_angry',
                Post_3__c: 'form.post_challenge_mindskillz_sa_10.i_know_how_to_share_my_feelings_with_other_people_in_healthy_ways',
                Post_4__c: 'form.post_challenge_mindskillz_sa_10.mental_health_is_the_same_thing_as_mental_illness',
                Post_5__c: 'form.post_challenge_mindskillz_sa_10.stress_is_a_normal_part_of_life_but_too_much_stress_can_hurt_your_mental_he',
                Post_6__c: 'form.post_challenge_mindskillz_sa_10.i_can_tell_when_stress_is_making_me_feel_upset',
                Post_7__c: 'form.post_challenge_mindskillz_sa_10.i_know_two_ways_to_calm_myself_down_when_i_feel_stressed',
                Post_8__c: 'form.post_challenge_mindskillz_sa_10.taking_care_of_my_mental_health_can_help_me_achieve_my_goals',
                Post_9__c: 'form.post_challenge_mindskillz_sa_10.i_can_identify_my_strengths_or_things_i_am_good_at',
                Post_10__c: 'form.post_challenge_mindskillz_sa_10.i_know_how_to_support_my_friends_in_making_good_choices_for_their_mental_he',
                Post_11__c: 'form.post_challenge_mindskillz_sa_10.i_can_name_three_people_i_can_talk_to_if_i_need_help',
                Post_12__c: 'form.post_challenge_mindskillz_sa_10.i_know_of_adults_or_places_in_my_community_that_can_give_me_mental_health_s',
                Post_13__c: 'form.post_challenge_mindskillz_sa_10.i_can_deal_with_anger_without_being_violent',
                Post_14__c: 'form.post_challenge_mindskillz_sa_10.drinking_alcohol_can_harm_my_mental_and_physical_health',
                Post_15__c: 'form.post_challenge_mindskillz_sa_10.i_can_say_no_to_peer_postssure_like_being_asked_to_drink_alcohol',
                Post_16__c: 'form.post_challenge_mindskillz_sa_10.i_have_talked_to_someone_about_mental_health_in_the_last_month_outside_of_m',
                Post_17__c: 'form.post_challenge_mindskillz_sa_10.people_with_mental_illness_are_dangerous',
                Post_18__c: 'form.post_challenge_mindskillz_sa_10.a_mental_illness_is_a_sign_of_personal_weakness',
                Post_19__c: 'form.post_challenge_mindskillz_sa_10.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Post_20__c: 'form.post_challenge_mindskillz_sa_10.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Post_21__c: 'form.post_challenge_mindskillz_sa_10.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi'
              },

              'post_challenge_mindskillz_zambia_2025':{
                Post_1__c: 'form.post_challenge_mindskillz_zambia_2025.mental_health_is_about_how_we_think_feel_and_act',
                Post_2__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_name_the_feelings_i_have_when_im_happy_sad_or_angry',
                Post_3__c: 'form.post_challenge_mindskillz_zambia_2025.i_know_how_to_share_my_feelings_with_other_people_in_healthy_ways',
                Post_4__c: 'form.post_challenge_mindskillz_zambia_2025.mental_health_is_the_same_thing_as_mental_illness',
                Post_5__c: 'form.post_challenge_mindskillz_zambia_2025.stress_is_a_normal_part_of_life_but_too_much_stress_can_hurt_your_mental_he',
                Post_6__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_tell_when_stress_is_making_me_feel_upset',
                Post_7__c: 'form.post_challenge_mindskillz_zambia_2025.i_know_two_ways_to_calm_myself_down_when_i_feel_stressed',
                Post_8__c: 'form.post_challenge_mindskillz_zambia_2025.taking_care_of_my_mental_health_can_help_me_achieve_my_goals',
                Post_9__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_identify_my_strengths_or_things_i_am_good_at',
                Post_10__c: 'form.post_challenge_mindskillz_zambia_2025.i_know_how_to_support_my_friends_in_making_good_choices_for_their_mental_he',
                Post_11__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_name_three_people_i_can_talk_to_if_i_need_help',
                Post_12__c: 'form.post_challenge_mindskillz_zambia_2025.i_know_of_adults_or_places_in_my_community_that_can_give_me_mental_health_s',
                Post_13__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_deal_with_anger_without_being_violent',
                Post_14__c: 'form.post_challenge_mindskillz_zambia_2025.drinking_alcohol_can_harm_my_mental_and_physical_health',
                Post_15__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_say_no_to_peer_pressure_like_being_asked_to_drink_alcohol',
                Post_16__c: 'form.post_challenge_mindskillz_zambia_2025.i_have_talked_to_someone_about_mental_health_in_the_last_month_outside_of_m',
                Post_17__c: 'form.post_challenge_mindskillz_zambia_2025.people_with_mental_illness_are_dangerous',
                Post_18__c: 'form.post_challenge_mindskillz_zambia_2025.a_mental_illness_is_a_sign_of_personal_weakness',
                Post_19__c: 'form.post_challenge_mindskillz_zambia_2025.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Post_20__c: 'form.post_challenge_mindskillz_zambia_2025.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Post_21__c: 'form.post_challenge_mindskillz_zambia_2025.if_i_had_a_mental_illness_i_would_not_seek_help_from_a_mental_health_profes'

              }
                
            };

            const pluckSfValue = val => {
              //  if sfFieldMapping[formVersion][val] == undefined
              return sfFieldMapping[formVersion][val];
            };

            return { ...state, formVersion, pluckSfValue };
          });

          fn(state => {
            if (state.formVersion == 'post_challenge_ecap_-_post_-_season_survey_for_athletes') {
              return state;
            }
            const PID = lastReferenceValue('records[0].Participant_Identification_Number_PID__c')(state);

            if (!PID) {
              console.log(
                `Participant not found with Participant_Identification_Number_PID__c: ${state.data.form.case['@case_id']}`
              );
              return state;
            }

            return upsert(
              'Attendance__c',
              'CommCare_Ext_ID__c',
              fields(
                //field('Event__c', dataValue('form.hidden_properties.intervention_name')),

                // field('CommCare_Ext_ID__c', state => {
                //   const value =
                //     dataValue('form.case.@case_id')(state) +
                //     '-' +
                //     toUTF8(dataValue('form.hidden_properties.intervention_name')(state)).replace(/\//gi, '');
                //   return scrubEmojis(value, '');
                // }),
                field("CommCare_Ext_ID__c", (state) => {
                  return toUTF8(`${dataValue("form.case.@case_id")(state)}-${scrubEmojis(
                  dataValue("form.hidden_properties.intervention_name")(state),
                  ""
                  ).replace(/\//gi, "")}`);
                  }),

                //relationship('Event__r', 'CommCare_Ext_ID__c', dataValue('form.hidden_properties.intervention_name')),
                relationship('Person_Attendance__r', 'Participant_Identification_Number_PID__c', dataValue('form.case.@case_id')),
                field('Pre_Post_Completed__c', state => {
                  var done = dataValue('form.hidden_properties.post_questionnaire_complete')(state);
                  return done === 'Yes' ? true : done === 'No' ? false : undefined;
                }),
                field('Date_Post_Administered__c', dataValue('form.hidden_properties.date')),
                field('Post_1__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_1__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_2__c', state => {
                  if (state.pluckSfValue('Post_2__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_2__c'))(state);
                  return state.helperFunctions.transform(value);
                }),

                field('Post_3__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_3__c'))(state);
                  return state.helperFunctions.transform(value);
                }),

                field('Post_4__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_4__c'))(state);
                  return state.helperFunctions.transform(value);
                }),

                field('Post_5__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_5__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_6__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_6__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_7__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_7__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_8__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_8__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_9__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_9__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_10__c', state => {
                  if (state.pluckSfValue('Post_10__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_10__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_11__c', state => {
                  if (state.pluckSfValue('Post_11__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_10__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_12__c', state => {
                  if (state.pluckSfValue('Post_12__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_12__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_13__c', state => {
                  if (state.pluckSfValue('Post_13__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_13__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_14__c', state => {
                  if (state.pluckSfValue('Post_14__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_14__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_15__c', state => {
                  if (state.pluckSfValue('Post_15__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_15__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_16__c', state => {
                  if (state.pluckSfValue('Post_16__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_16__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_17__c', state => {
                  if (state.pluckSfValue('Post_17__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_17__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_18__c', state => {
                  if (state.pluckSfValue('Post_18__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_18__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_19__c', state => {
                  if (state.pluckSfValue('Post_19__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_19__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_20__c', state => {
                  if (state.pluckSfValue('Post_20__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_20__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_21__c', state => {
                  if (state.pluckSfValue('Post_21__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_21__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_22__c', state => {
                  if (state.pluckSfValue('Post_22__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_22__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_23__c', state => {
                  if (state.pluckSfValue('Post_23__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_23__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_24__c', state => {
                  if (state.pluckSfValue('Post_24__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_24__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_25__c', state => {
                  if (state.pluckSfValue('Post_25__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_25__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_26__c', state => {
                  if (state.pluckSfValue('Post_26__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Post_26__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Post_27__c', state => {
                  if (state.pluckSfValue('Post_27__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Post_27__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Post_28__c', state => {
                  if (state.pluckSfValue('Post_28__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Post_28__c'))(state); 
                  return state.helperFunctions.transform(value);
                })     
              )
            )(state);
          });

          //Removing mapping... need case_id to upsert Events. Date_of_Post__c update should be handled on the SF side.
          /*upsert(
              'Event__c',
              'CommCare_Ext_ID__c',
              fields(
                field('CommCare_Ext_ID__c', dataValue('form.hidden_properties.intervention_name')),
                field('Date_of_Post__c', dataValue('form.date')),
              )
            );*/
    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Post-Challenges:
        source_trigger: webhook
        target_job: Upsert-Post-Challenges
        condition_type: js_expression
        condition_label: Post Challenges
        condition_expression: |
          state.data.form["@name"] == "Post Challenges" && state.data.form["hidden_properties"]["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Upsert-Confirm-Services-Received":
    name: '? Upsert Confirm Services Received'
    jobs:
      Upsert-Confirm-Services-Received:
        name: Upsert Confirm Services Received
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // Your job goes here.
          alterState(state => {
            state.data.external_commcare_id = (
              dataValue('form.hidden_properties.intervention_name')(state) +
              dataValue('form.hidden_properties.participant_first_name')(state) +
              dataValue('form.hidden_properties.participant_surname')(state)
            )
              .toString()
              .toLowerCase()
              .replace(/\s/g, '')
              .trim();

            return state;
          });

          upsert(
            'NewReferral__c',
            'CommCare_Ext_ID__c',
            fields(
              field('Business_Unit_Site__c', state => {
                const bu = dataValue('form.business_unit')(state);
                return bu === 'X' ? 'GRS Zambia' : bu;
              }),
              field('CommCare_Ext_ID__c', dataValue('form.case.@case_id')),
               field('HIV_Testing_Services_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option1')(state)
                )
              ),
              field('TB_Screening_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option2')(state)
                )
              ),
              field('VMMC_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option3')(state)
                )
              ),
              field('Post_Exposure_Prophylaxis_Service_Provid__c', state =>
                Boolean(
                  dataValue(
                    'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option4'
                  )(state)
                )
              ),
              field('PrEP_Service_Provider__c', state =>
                Boolean(
                  dataValue(
                    'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option5'
                  )(state)
                )
              ),
              field('HIV_STI_PREVENTION_Other_Service_Provid__c', state =>
                Boolean(
                  dataValue(
                    'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option6'
                  )(state)
                )
              ),
              field('ART_Initiation_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.art_support_services.art_services_group.art_services_option1')(
                    state
                  )
                )
              ),
              field('SKILLZ_Plus_Club_Support_Service_Provid__c', state =>
                Boolean(
                  dataValue('form.referral_services.art_support_services.art_services_group.art_services_option2')(
                    state
                  )
                )
              ),
              
              field(
                'PMTCT_Service_Provider__c',
                state =>
                  Boolean(
                    dataValue('form.referral_services.art_support_services.art_services_group.art_services_option3')(
                      state
                    )
                  )
              ), 
              field('IPTG_Health_Facility__c', state =>
                Boolean(
                  dataValue('form.referral_services.mental_health_services.confirmation_of_services_provided_label.mental_health_select_services_option1')(
                    state
                  )
                )
              ),    
              field('IPTG_Specialized_to_SMZ__c', state =>
                Boolean(
                  dataValue('form.referral_services.mental_health_services.confirmation_of_services_provided_label.mental_health_select_services_option2')(
                    state
                  )
                )
              ),   
              
                field('ART_Services_Other_Service_Provider__c', state =>
                  Boolean(
                    dataValue('form.referral_services.art_support_services.referred_art_support_services')(state)
                  )
                ),
                field(
                  'Victim_Friendly_Services_Service_Provide__c',
                  state =>
                    Boolean(
                      dataValue(
                        'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option1'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option2'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option3'
                      )(state)
                    )
                ),
                field('Legal_Services_Other_Service_Provider__c', state =>
                  Boolean(
                    dataValue(
                      'form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option3'
                    )(state)
                  )
                ),

              field('STI_Screen_Testing_Service_Provider__c', state =>
                  Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option1')(state))
                ),
              
              field('Contraception_Family_Plan_Servi_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option2')(state))
              ),
              field('Cervical_Cancer_Screen_Servi_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option3')(state))
              ),
              field('HPV_vaccine_Service_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option4')(state))
              ),
              field('Antenatal_Care_ANC_Service_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option5')(state))
              ),
              field('Sexual_and_GBV_Abuse_Servi_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option6')(state))
              ),
              field(
                  'Psycho_Social_Support_Service_Provider__c',
                  state =>
                    Boolean(
                      dataValue(
                        'form.referral_services.other_srhr_services.service_label.srhr_option9'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.other_srhr_services.service_label.srhr_option8'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.other_srhr_services.service_label.srhr_option7'
                      )(state)
                    )
                ),
              field('Psycho_Social_Services_Other_Service_Pro__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option10')(state))
              ),
              field(
                  'Legal_Services_Other_Service_Provider__c',
                  state =>
                    Boolean(
                      dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_referral_services')(state)
                    ) ||
                    Boolean(
                      dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option1')(state)
                    ) ||
                    Boolean(
                      dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option2')(state)
                    )
                ),
              
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Upsert-Confirm-Services-Received:
        source_trigger: webhook
        target_job: Upsert-Confirm-Services-Received
        condition_type: js_expression
        condition_label: Confirm Services Received
        condition_expression: |
          state.data.form["@name"] == "Confirm Services Received" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-HIV-Testing-Event-Snapshot":
    name: '? HIV Testing Event Snapshot'
    jobs:
      HIV-Testing-Event-Snapshot:
        name: HIV Testing Event Snapshot
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // push to production
          upsert(
            'Event__c',
            'CommCare_Ext_ID__c',
            fields(
              field('Name', dataValue('form.basic_information.intervention')),
              field('Venue__c', dataValue('form.basic_information.venue')),
              field('Coach_A__c', dataValue('form.hidden_properties.coach_name')),
              field('Date__c', dataValue('form.basic_information.event_date')),
              field('Testing_Partner_Contact_Persion__c', dataValue('form.basic_information.testing_partner__contact_people')),
              field('of_People_in_Attendance_Testing_Events__c', dataValue('form.basic_information.number_in_attendance')),
              field('Event_Type__c', dataValue('form.basic_information.testing_event_type')),
              field('Coordinator__c', dataValue('form.basic_information.event_coordinator')),
              field(
                'What_organization_discussed_VMMC__c',
                dataValue('form.basic_information.question2.what_organisation_discussed_mmc')
              ),
              field(
                'What_organization_s_What_topic_s__c',
                dataValue(
                  'form.basic_information.information_sessions_other.what_organisations_delivered_a_session_and_what_was_the_topic_of_the_sessio'
                )
              ),
              field(
                'How_was_the_information_presented__c',
                dataValue('form.basic_information.question2.how_was_this_information_presented_eg_lecture_individua_sessions_etc')
              ),
              field('how_many_people_attended_the_sessions__c', dataValue('form.basic_information.number_in_attendance')),
              field(
                'How_many_people_attended_the_sessions_oh__c',
                dataValue('form.basic_information.question2.approximately_how_many_people_attended_the_sessions_in_total')
              ),
              field(
                'Did_other_organizations_conduct__c',
                dataValue(
                  'form.basic_information.information_sessions_other.did_other_organisations_eg_youth-friendly_clinic_ministry_of_health_etc_con'
                )
              ),
              field(
                'Testing_Key_Lesson_s_Learned__c',
                dataValue('form.basic_information.event_overview.highlights_key_challenges')
              ),
              field(
                'X2_Main_challenges__c',
                dataValue(
                  'form.basic_information.event_overview.please_describe_highlights_key_challenges_and_main_lessons_learned_from_thi'
                )
              )
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->HIV-Testing-Event-Snapshot:
        source_trigger: webhook
        target_job: HIV-Testing-Event-Snapshot
        condition_type: js_expression
        condition_label: HIV Testing Event Snapshot
        condition_expression: |
          state.data.form["@name"] == "HIV Testing Event Snapshot" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Upsert-Register-Skills-plus-Club":
    name: '? Upsert Register Skills plus Club'
    jobs:
      Upsert-Register-Skills-plus-Club:
        name: Upsert Register Skills plus Club
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // push to production
          alterState((state) => {
            
            function clean(str) {
              if (!!str)
                return str
                  .split('_')
                  .map(word => {
                    let new_word = word.toString().toLowerCase();
                    return new_word.slice(0, 1).toUpperCase() + new_word.slice(1);
                  })
                  .join(' ');
            }
            
            const coachFieldNames = ['Coach_A__r','Coach_B__r','Coach_C__r','Coach_D__r']
           
            state.data.destinationCoachFields = state.data.form.coaches
            .split(' ')
            .reduce(
              (accumulator, currentValue, currentIndex) => [
                ...accumulator,
                (currentIndex < coachFieldNames.length && !!currentValue
                  ? relationship(coachFieldNames[currentIndex], 'CommCare_Ext_ID__c', currentValue)
                  : []),
              ],
              []
            );

            return state; 
          }); 



          upsert(
            'Event__c',
            'CommCare_Case_ID__c',
            state=>({
            ...fields(
                field('Name', dataValue('form.name_of_skillz_plus_club')),
                field('CommCare_Ext_ID__c', dataValue('form.name_of_skillz_plus_club')),
                field('CommCare_Case_ID__c', dataValue('form.case.@case_id')),
                relationship('RecordType', 'Name', 'Intervention'),
                relationship('Site__r', 'CommCare_Ext_ID__c', dataValue('form.skillz_plus_site')),
                relationship('Venue__r', 'CommCare_Ext_ID__c', dataValue('form.skillz_plus_venue')),
              ),
              ...fields(...state.data.destinationCoachFields)
            })
          );

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Register-Skills-plus-Club:
        source_trigger: webhook
        target_job: Upsert-Register-Skills-plus-Club
        condition_type: js_expression
        condition_label: Register Skillz plus Club
        condition_expression: |
          state.data.form["@name"] == "Register Skillz Plus Club" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Upsert-Coach-Support-Visit-CSV":
    name: '? Upsert Coach Support Visit CSV'
    jobs:
      Upsert-Coach-Support-Visit-CSV:
        name: Upsert Coach Support Visit CSV
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          //openfn.org source
          alterState(state => {
            function clean(str) {
              console.log('str', str);

              if (!str) return '';

              return str
                .split('_')
                .map(word => {
                  let new_word = word.toString().toLowerCase();
                  return new_word.slice(0, 1).toUpperCase() + new_word.slice(1);
                })
                .join(' ');
            }
           
            if (state.data.form['step_3_-_the_big_5']  !== undefined ){ 
              state.data.form['step_3_-_the_big_5'].faciliation = clean(state.data.form['step_3_-_the_big_5'].faciliation);
            }
            else{
            state.data.form.step_4_comments.for_each_practice_component_describe_what_the_coach_did_well_and_how_the_co.faciliation = 
            clean(state.data.form.step_4_comments.for_each_practice_component_describe_what_the_coach_did_well_and_how_the_co.faciliation);
            }
            
            function transform(value) {
              if (!value) return;
              switch (value.toString().trim()) {
                case 'copy-1-of-excellent':
                  return 'Excellent'; 
                case 'needs_improvement':
                  return 'Needs Improvement';      
                case 'meets_expectations':
                  return 'Meets Expectations'; 
                case 'excellent':
                  return 'Excellent';        
                case 'unsatisfactory':
                  return 'Unsatisfactory';
                case 'exceeds_expectations':
                  return 'Exceeds Expectations';        
                default:
                  return value;
              }
            }

            state.data.form['step_3_-_the_big_5'].builds_personal_connections = 
            transform(state.data.form['step_3_-_the_big_5'].builds_personal_connections)

            state.data.form['step_3_-_the_big_5'].cool_down = 
            transform(state.data.form['step_3_-_the_big_5'].cool_down)
            
            state.data.form['step_3_-_the_big_5'].creates_safe_space = 
            transform(state.data.form['step_3_-_the_big_5'].creates_safe_space)
            
            state.data.form['step_3_-_the_big_5'].faciliation = 
            transform(state.data.form['step_3_-_the_big_5'].faciliation)
            
            state.data.form['step_3_-_the_big_5'].gives_praise = 
            transform(state.data.form['step_3_-_the_big_5'].gives_praise)
            
            state.data.form['step_3_-_the_big_5'].praise = 
            transform(state.data.form['step_3_-_the_big_5'].praise)

            state.data.form['step_3_-_the_big_5'].preparation = 
            transform(state.data.form['step_3_-_the_big_5'].preparation)
            
            state.data.form['step_3_-_the_big_5'].shares_accurate_information_about_hivaids_sexual_reproductive_health_and_ri = 
            transform(state.data.form['step_3_-_the_big_5'].shares_accurate_information_about_hivaids_sexual_reproductive_health_and_ri)
            
            state.data.form['step_3_-_the_big_5'].sparks_vital_conversations = 
            transform(state.data.form['step_3_-_the_big_5'].sparks_vital_conversations)
            
            state.data.form['step_3_-_the_big_5'].time_management = 
            transform(state.data.form['step_3_-_the_big_5'].time_management)
            
             state.data.form['step_3_-_the_big_5'].warm_up = 
            transform(state.data.form['step_3_-_the_big_5'].warm_up)
            

            return state;
          });

          upsert(
            'Coach_Support_Visit__c',
            'CommCare_Ext_ID__c',
            fields(
              field('CommCare_Ext_ID__c', dataValue('id')),
              relationship('Coach_Person__r', 'CommCare_Ext_ID__c', state => {
                return dataValue('form.step_1_basic_information.select_coach')(state) || 
                dataValue('form.step_1_csv_information.select_coach')(state); 
              }),
              relationship('Venue__r', 'CommCare_Ext_ID__c', state => {
                return dataValue('form.hidden_properties.venue')(state) || 
                dataValue('form.step_1_csv_information.venue')(state); 
              }),
              relationship('Event__r', 'CommCare_Ext_ID__c', state => {
                return dataValue('form.hidden_properties.intervention')(state) || 
                dataValue('form.step_1_csv_information.intervention')(state); 
              }),
              relationship('Curriculum_Aggregate__r', 'CommCare_Ext_ID__c', state => {
                return dataValue('form.hidden_properties.curriculum')(state) || 
                dataValue('form.step_1_csv_information.curriculum')(state); 
              }),    
               relationship('Site_Lookup__r', 'CommCare_Ext_ID__c', state => {
                return dataValue('form.hidden_properties.site')(state) || 
                dataValue('form.step_1_csv_information.site')(state); 
              }), 
              field('Date__c', dataValue('form.step_2_practice_information.date_of_csv')),
              //== TODO: FIx repeated mappings to only reference destination field 1 time ===//
              field(
                'Accurate_Information__c', state => {
                return dataValue('form.step_3_-_the_big_5.shares_accurate_information_about_hivaids_sexual_reproductive_health_and_ri')(state) || 
                dataValue(
                    'form.step_3_the_big_five.question1.shares_accurate_information_about_hivaids_sexual_reproductive_health_and_ri'
                  )(state); 
              }),
              field('Creates_safe_space__c', state => {
                return dataValue('form.step_3_-_the_big_5.creates_safe_space')(state) || 
                dataValue('form.step_3_the_big_five.question1.creates_safe_space')(state); 
                
              }),
              field('Builds_personal_connections__c', state => {
                return dataValue('form.step_3_-_the_big_5.builds_personal_connections')(state) || 
                dataValue('form.step_3_the_big_five.question1.builds_personal_connections')(state); 
              }),
              field('Gives_praise__c', state => {
                return dataValue('form.step_3_-_the_big_5.gives_praise')(state) ||
                dataValue('form.step_3_the_big_five.question1.gives_powerful_praise')(state); 
              }),
              field('Sparks_vital_conversations__c', state => {
                return dataValue('form.step_3_-_the_big_5.sparks_vital_conversations')(state) || 
                dataValue('form.step_3_the_big_five.question1.sparks_vital_conversations')(state); 
                }),
              field('X2_Warm_Up__c', state => {
                return dataValue('form.step_3_-_the_big_5.warm_up')(state) || 
                dataValue(
                    'form.step_4_comments.for_each_practice_component_describe_what_the_coach_did_well_and_how_the_co.warm_up'
                  )(state); 
                }),
              field('X3_Activity__c', state => {
                return dataValue('form.step_3_-_the_big_5.activity')(state) || dataValue(
                    'form.step_4_comments.for_each_practice_component_describe_what_the_coach_did_well_and_how_the_co.activity'
                  )(state); 
                }),
              field('X4_Cool_Down__c', state => {
                return dataValue('form.step_3_-_the_big_5.cool_down')(state) || dataValue(
                    'form.step_4_comments.for_each_practice_component_describe_what_the_coach_did_well_and_how_the_co.cool_down'
                  )(state); 
                }),
              field('X5_Facilitation__c', state => {
                return dataValue('form.step_3_-_the_big_5.faciliation')(state) || 
                dataValue(
                    'form.step_4_comments.for_each_practice_component_describe_what_the_coach_did_well_and_how_the_co.faciliation'
                  )(state); 
                }),
              field(
                'X6_Time_Management__c',
                dataValue('form.step_3_-_the_big_5.time_management')
              ),
              field(
                'X1_Preparation__c',
                dataValue('form.step_3_-_the_big_5.preparation')
              ),
              field('Introduces_micromove__c', state => {
                return //dataValue('form.step_3_-_the_big_5.faciliation')(state) || 
                dataValue(
                   'form.step_4_comments.for_each_practice_component_describe_what_the_coach_did_well_and_how_the_co.micromove'
                )(state); 
              }),
              field(
                'Notes__c',
                dataValue(
                  'form.step_3_-_the_big_5.additional_notes.include_your_obsevations_related_to_preparation_punctuality_process'
                )
              )
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Coach-Support-Visit-CSV:
        source_trigger: webhook
        target_job: Upsert-Coach-Support-Visit-CSV
        condition_type: js_expression
        condition_label: Coach Support Visit Form
        condition_expression: |
          state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816" && state.data.form["hidden_properties"].csv == "1"
        enabled: true
  "?-Malaria-Testing-Event-Snapshot":
    name: '? Malaria Testing Event Snapshot'
    jobs:
      Malaria-Testing-Event-Snapshot:
        name: Malaria Testing Event Snapshot
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // push to production
          upsert(
            'Event__c',
            'CommCare_Case_ID__c',
            fields(
              field('Name', dataValue('form.hidden_properties.event_name')),
              field('Date__c', dataValue('form.basic_information.event_details.event_date')),
              field('Testing_Partner_Contact_Persion__c', dataValue('form.event_information.testing_partner__contact_people')),
              field('of_People_in_Attendance_Testing_Events__c', dataValue('form.event_information.number_in_attendance')),
              field('Coordinator__c', dataValue('form.event_information.event_coordinator')),
              field(
                'Did_an_organization_discuss_Malaria__c',
                dataValue('form.malaria_treatment_prevention.info_malaria_treatment')
              ),
              field('What_organization_s_What_topic_s__c', dataValue('form.malaria_treatment_prevention.which_organizations')),
              field(
                'How_was_the_information_presented__c',
                dataValue('form.malaria_treatment_prevention.how_was_info_presented')
              ),
              //field('of_Participants__c', dataValue('form.malaria_treatment_prevention.how_many_total_participants')),
              field(
                'Did_other_organizations_conduct__c',
                dataValue("form.skills_activities['did_other_organisations_eg_youth-friendly_clinic_ministry_of_health_etc_con']")
              ),
              field(
                'What_organization_s_What_topic_s__c',
                dataValue('form.skills_activities.what_organisations_delivered_a_session_and_what_was_the_topic_of_the_sessio')
              ),
              field('Facilitator_1__c', dataValue('form.skills_activities.facilitators')),
              field(
                'How_many_people_attended_the_sessions__c',
                dataValue('form.skills_activities.how_many_people_attended_the_sessions_in_total')
              ),
              field(
                'How_many_people_attended_the_sessions_oh__c',
                dataValue('form.skills_activities.how_many_people_attended_the_sessions_in_total')
              ),
              field(
                'X2_Main_challenges__c',
                dataValue('form.bed_net_distribution.please_describe_highlights_key_challenges_and_main_lessons_learned_from_thi')
              ),
              field(
                'X1_Main_successes__c',
                dataValue('form.bed_net_distribution.please_describe_highlights_key_challenges_and_main_lessons_learned_from_thi')
              ),
              field(
                'Number_of_Bed_Nets_Distributed__c',
                dataValue('form.bed_net_distribution.total_number_of_bed_nets_distributed')
              ),
              //field('Site__c', dataValue('form.event_information.site')),
              //field('Venue__c', dataValue('form.event_information.venue')),
              //field('Curriculum__c', dataValue('form.event_information.curriculum')),
              field('X1_0_Intervention_Name__c', dataValue('form.event_information.intervention')),
              //field('Coach_1__c', dataValue('form.hidden_properties.coach_name')),
              field('CommCare_Case_ID__c', dataValue('form.case.@case_id')),
              field('Date__c', dataValue('form.event_information.event_date')),
              field('Testing_Partner_Contact_Persion__c', dataValue('form.event_information.testing_partner__contact_people')),
              field('of_People_in_Attendance_Testing_Events__c', dataValue('form.event_information.number_in_attendance')),
              field('Coordinator__c', dataValue('form.event_information.event_coordinator'))
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Malaria-Testing-Event-Snapshot:
        source_trigger: webhook
        target_job: Malaria-Testing-Event-Snapshot
        condition_type: js_expression
        condition_label: Malaria Testing Event Snapshot
        condition_expression: |
          state.data.form["@name"] == "Malaria Testing Event Snapshot" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Upsert-Aggregate-Service-Referrals":
    name: '? Upsert Aggregate Service Referrals'
    jobs:
      Upsert-Aggregate-Service-Referrals:
        name: Upsert Aggregate Service Referrals
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // Push to production
          upsert(
            'GRS_Referral_Agg__c',
            'CommCare_Ext_ID__c',
            fields(
              relationship(
                'SiteName__r',
                'CommCare_Ext_ID__c',
                dataValue('form.general_referral_information.event_information.site')
              ),
              field('CommCare_Ext_ID__c', dataValue('form.general_referral_information.event_information.site')),
              //TO DO
              //field('Business_Unit__c', dataValue('form.general_referral_information.event_information.business_unit')),
              field('Business_Unit__c', state => {
                const bu = dataValue('form.general_referral_information.event_information.business_unit')(state); 
                return bu==='65680f0c4c144b03ad0f86bdc46c1ebc' ? 'GRS Zambia' : 
                bu==='04d98397e28046118fade28ced6b65cb' ? 'GRS Zimbabwe' : 
                bu==='ed125ab19ec34aacab79585e59eb76f4' ? 'GRS Partnerships': undefined ; 
              }),
              relationship(
                  //Attendance looks up to Event via the intervention_name
                  'Events__r',
                  'CommCare_Ext_ID__c',
                  dataValue('form.general_referral_information.event_information.event_name')
                ),
              field('Type_of_Referral__c', dataValue('form.general_referral_information.type_of_referral')),
              field(
                'Enter_Partner_s_Name__c',
                dataValue('form.general_referral_information.partner_or_organization_referred_to')
              ),
              field('Males_Referred_HIV_Testing__c', dataValue('form.hivsti_services.males_referred_for_hiv_testing')),
              field('Males_referred_for_STI_Screening__c', dataValue('form.hivsti_services.males_referred_for_sti_screening')),
              field('Males_Referred_for_PEP__c', dataValue('form.hivsti_services.males_referred_for_pep')),
              field('Males_Referred_for_PrEP__c', dataValue('form.hivsti_services.males_referred_for_prep')),
              field('Males_Referred_for_VMMC__c', dataValue('form.hivsti_services.males_referred_for_vmmc')),
              field('Females_Referred_for_HIV_Testing__c', dataValue('form.hivsti_services.females_referred_for_hiv_testing')),
              field(
                'Females_Referred_for_STI_Screening__c',
                dataValue('form.hivsti_services.females_referred_for_sti_screening')
              ),
              field('Date_Referred__c', dataValue('form.general_referral_information.date_referred')),
              field('Females_Referred_for_PEP__c', dataValue('form.hivsti_services.females_referred_for_pep')),
              field('Females_Referred_for_PrEP__c', dataValue('form.hivsti_services.females_referred_for_prep')),
              field('Males_Referred_for_ART__c', dataValue('form.art_services.males_referred_for_art')),
              field('Males_Referred_for_SKILLZ_Club__c', dataValue('form.art_services.males_referred_for_skillz__club')),
              field('Females_Referred_for_ART__c', dataValue('form.art_services.females_referred_for_art')),
              field('Females_Referred_SKILLZ_Club__c', dataValue('form.art_services.females_referred_for_skillz__club')),
              field('Females_Referred_for_PMTCT__c', dataValue('form.art_services.females_referred_for_pmtct')),
              
              field(
                'Males_Referred_for_Psycho_Social_Support__c',
                dataValue('form.psycho_-_social_services.males_referred_for_psycho-social_support')
              ),
              field(
                'Females_Referred_Psycho_Social_Support__c',
                dataValue('form.psycho_-_social_services.females_referred_for_psycho-social_support')
              ),
              field('Males_Referred_for_TB_Screening__c', dataValue('form.tb_services.males_referred_for_tb_screening')),
              field('Females_Referred_for_TB_Screening__c', dataValue('form.tb_services.females_referred_for_rb_screening')),
              field(
                'Number_of_Male_Condoms_distributed__c',
                dataValue('form.condom_distributions.number_of_male_condoms_distributed')
              ),
              field('Number_of_Male_Condoms_Accessed__c', dataValue('form.condom_distributions.number_of_male_condoms_accessed')),
              field(
                'Number_of_Female_Condoms_distributed__c',
                dataValue('form.condom_distributions.number_of_female_condoms_distributed')
              ),
              field(
                'Number_of_Female_Condoms_Accessedx__c',
                dataValue('form.condom_distributions.number_of_female_condoms_accessed')
              ),
              field(
                'Females_Referred_for_Family_Planning__c',
                dataValue('form.other_srhr_services.females_referred_for_family_planning')
              ),
              field(
                'Females_Referred_for_Cervical_Cancer__c',
                dataValue('form.other_srhr_services.females_referred_for_cervical_cancer')
              ),
              field('Females_Referred_for_Antenatal__c', dataValue('form.other_srhr_services.females_referred_for_antenatal')),
              field(
                'Males_Referred_for_Malaria_Testing__c',
                dataValue('form.other_referral_services.males_referred_for_malaria_testing')
              ),
              field('Males_Referred_for_GBV__c', dataValue('form.other_referral_services.males_referred_for_gbv')),
              field(
                'Females_Referred_for_Malaria_Testing__c',
                dataValue('form.other_referral_services.females_referred_for_malaria_testing')
              ),
              field('Females_Referred_for_GBV__c', dataValue('form.other_referral_services.females_referred_for_gbv')),
              field(
                'Females_Referred_for_HPV_Vaccine__c',
                dataValue('form.other_referral_services.females_referred_for_hpv_vaccine')
              )
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Aggregate-Service-Referrals:
        source_trigger: webhook
        target_job: Upsert-Aggregate-Service-Referrals
        condition_type: js_expression
        condition_label: Aggregate Service Referrals
        condition_expression: |
          state.data.form["@name"] == "Aggregate Service Referrals" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Upsert-Service-Referral-Followup":
    name: '? Upsert Service Referral Followup'
    jobs:
      Upsert-Service-Referral-Followup:
        name: Upsert Service Referral Followup
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // push to production
          alterState(state => {
            state.data.external_commcare_id = (
              dataValue('form.hidden_properties.intervention_name')(state) +
              dataValue('form.hidden_properties.participant_first_name')(state) +
              dataValue('form.hidden_properties.participant_surname')(state)
            )
              .toString()
              .toLowerCase()
              .replace(/\s/g, '')
              .trim();

            return state;
          });

          upsert(
            'NewReferral__c',
            'CommCare_Ext_ID__c',
            fields(
              field('Business_Unit_Site__c', state => {
                const bu = dataValue('form.business_unit')(state);
                return bu === 'X' ? 'GRS Zambia' : bu;
              }),
              field('CommCare_Ext_ID__c', dataValue('form.case.@case_id')),
               field('HIV_Testing_Services_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option1')(state)
                )
              ),
              field('TB_Screening_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option2')(state)
                )
              ),
              field('VMMC_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option3')(state)
                )
              ),
              field('Post_Exposure_Prophylaxis_Service_Provid__c', state =>
                Boolean(
                  dataValue(
                    'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option4'
                  )(state)
                )
              ),
              field('PrEP_Service_Provider__c', state =>
                Boolean(
                  dataValue(
                    'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option5'
                  )(state)
                )
              ),
              field('HIV_STI_PREVENTION_Other_Service_Provid__c', state =>
                Boolean(
                  dataValue(
                    'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option6'
                  )(state)
                )
              ),
              field('ART_Initiation_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.art_support_services.art_services_group.art_services_option1')(
                    state
                  )
                )
              ),
              field('SKILLZ_Plus_Club_Support_Service_Provid__c', state =>
                Boolean(
                  dataValue('form.referral_services.art_support_services.art_services_group.art_services_option2')(
                    state
                  )
                )
              ),
              
              field(
                'PMTCT_Service_Provider__c',
                state =>
                  Boolean(
                    dataValue('form.referral_services.art_support_services.art_services_group.art_services_option3')(
                      state
                    )
                  )
              ), 
              field('IPTG_Health_Facility__c', state =>
                Boolean(
                  dataValue('form.referral_services.mental_health_services.confirmation_of_services_provided_label.mental_health_select_services_option1')(
                    state
                  )
                )
              ),    
              field('IPTG_Specialized_to_SMZ__c', state =>
                Boolean(
                  dataValue('form.referral_services.mental_health_services.confirmation_of_services_provided_label.mental_health_select_services_option2')(
                    state
                  )
                )
              ),   
              
                field('ART_Services_Other_Service_Provider__c', state =>
                  Boolean(
                    dataValue('form.referral_services.art_support_services.referred_art_support_services')(state)
                  )
                ),
                field(
                  'Victim_Friendly_Services_Service_Provide__c',
                  state =>
                    Boolean(
                      dataValue(
                        'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option1'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option2'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option3'
                      )(state)
                    )
                ),
                field('Legal_Services_Other_Service_Provider__c', state =>
                  Boolean(
                    dataValue(
                      'form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option3'
                    )(state)
                  )
                ),

              field('STI_Screen_Testing_Service_Provider__c', state =>
                  Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option1')(state))
                ),
              
              field('Contraception_Family_Plan_Servi_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option2')(state))
              ),
              field('Cervical_Cancer_Screen_Servi_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option3')(state))
              ),
              field('HPV_vaccine_Service_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option4')(state))
              ),
              field('Antenatal_Care_ANC_Service_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option5')(state))
              ),
              field('Sexual_and_GBV_Abuse_Servi_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option6')(state))
              ),
              field(
                  'Psycho_Social_Support_Service_Provider__c',
                  state =>
                    Boolean(
                      dataValue(
                        'form.referral_services.other_srhr_services.service_label.srhr_option9'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.other_srhr_services.service_label.srhr_option8'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.other_srhr_services.service_label.srhr_option7'
                      )(state)
                    )
                ),
              field('Psycho_Social_Services_Other_Service_Pro__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option10')(state))
              ),
              field(
                  'Legal_Services_Other_Service_Provider__c',
                  state =>
                    Boolean(
                      dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_referral_services')(state)
                    ) ||
                    Boolean(
                      dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option1')(state)
                    ) ||
                    Boolean(
                      dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option2')(state)
                    )
                ),
              
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Upsert-Service-Referral-Followup:
        source_trigger: webhook
        target_job: Upsert-Service-Referral-Followup
        condition_type: js_expression
        condition_label: Service Referral Followup
        condition_expression: |
          state.data.form.followup == "1" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "[TEST]-Upsert-Post-Challenges":
    name: '[TEST] Upsert Post Challenges'
    jobs:
      upsert-post-challenges:
        name: upsert post challenges
        adaptor: '@openfn/language-salesforce@4.3.0'
        credential: aissatou@openfn.org-GRS-Salesforce-Sandbox
        body: |
          fn(state => {
            function transform(value) {
              if (!value) return;
              switch (value.toString().trim().toLowerCase()) {
                case 'true':
                case 'yes':
                case 'agree':
                case 'concordo':
                case 'verdade':
                case 'copy-1-of-yes':
                case 'choice1':
                  return 1;
                case 'false':
                case 'no':
                case 'disagree':
                case 'discordo':
                case 'falso':
                case 'copy-1-of-no':
                case 'choice3': 
                case 'choice6': 
                  return 2;
                case 'i_dont_know':
                case 'na':
                  return 3;
                case 'unanswered':
                case `not_sexually_active`:
                  return 4;
                case 'not_applicable':
                  return 5;
                default:
                  return value;
              }
            }

            state.helperFunctions = { transform };

            return query(
              `SELECT Participant_Identification_Number_PID__c from Person__c where Participant_Identification_Number_PID__c  = '${state.data.form.case['@case_id']}'`
            )(state);
          });

          fn(state => {
            const { form } = state.data;

            const formVersion = Object.keys(form).find(key => key.includes('challenge'));
            if (formVersion == 'post_challenge_ecap_-_post_-_season_survey_for_athletes') {
              console.log('Skipping upsert for ECAP data');
              return { ...state, formVersion };
            }
            console.log('form version', formVersion);

            const sfFieldMapping = {
              'portuguese_pre_challenge_gcr_-_skillz_malaria': {
                Post_1__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.dormir_dentro_da_rede_mosquiteira_tratada_todas_as_noites_pode_proteger_me_',
                Post_2__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.posso_esperar_uns_dias_antes_de_fazer_o_teste_de_malria_se_tiver_febres',
                Post_3__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.um_mdico_tradicionalcurandeiro_pode_me_dar_um_tratamento_para_curar_a_malri',
                Post_4__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.se_tiver_malria_e_no_for_tratado_posso_transmitir_a_malria_a_algum',
                Post_5__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.somente_as_mulheres_grvidas_e_as_crianas_menores_de_5_anos__que_precisam_de',
                Post_6__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.a_malria_pode_matar_se_no_fr_tratada',
                Post_7__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.a_febre__um_sintoma_da_malria',
                Post_8__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.eu_me_sinto_bem_conmigo_mesmo',
                Post_9__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.tenho_algum_na_minha_vida_que_pode_me_dar_bons_conselhos_quando_preciso_de_',
                Post_10__c:
                  'form.portuguese_pre_challenge_gcr_-_skillz_malaria.eu_sei_onde_posso_ter_tratamento_para_malria_na_minha_comunidade',
                Post_11__c: 'form.portuguese_pre_challenge_gcr_-_skillz_malaria.posso_proteger-me_da_malria',
              },

              'post_challenge_south_africa_-_skillz_girl': {
                Post_1__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_have_an_older_person_in_my_life_i_can_go_to_for_advice_i_have_an_older_pe',
                Post_2__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_know_how_to_make_a_plan_to_deal_with_the_challenges_i_may_face_in_reachin',
                Post_3__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Post_4__c: 'form.post_challenge_south_africa_-_skillz_girl.every_day_i_can_find_something_to_be_grateful_for',
                Post_5__c:
                  'form.post_challenge_south_africa_-_skillz_girl.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Post_6__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Post_7__c:
                  'form.post_challenge_south_africa_-_skillz_girl.girls_have_a_greater_risk_of_contracting_hiv_than_boys',
                Post_8__c:
                  'form.post_challenge_south_africa_-_skillz_girl.if_i_am_sexually_active_i_go_to_a_clinic_to_get_protection_from_hivstis_and',
                Post_9__c: 'form.post_challenge_south_africa_-_skillz_girl.like_physical_health_we_all_have_mental_health',
                Post_10__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Post_11__c:
                  'form.post_challenge_south_africa_-_skillz_girl.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Post_12__c:
                  'form.post_challenge_south_africa_-_skillz_girl.if_a_girl_is_sexually_abused_she_can_reduce_her_risk_of_getting_hiv_by_goin',
                Post_13__c:
                  'form.post_challenge_south_africa_-_skillz_girl.sometimes_a_man_may_have_a_good_reason_to_hit_his_partner',
                Post_14__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Post_15__c:
                  'form.post_challenge_south_africa_-_skillz_girl.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                Post_16__c:
                  'form.post_challenge_south_africa_-_skillz_girl.if_sexually_active_i_or_my_partner_is_using_a_prevention_method_to_protect_',
                Post_17__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_know_where_to_go_to_receive_counselling_for_mental_health_challenges',
                Post_18__c:
                  'form.post_challenge_south_africa_-_skillz_girl.loss_of_interest_in_funenjoyable_activities_is_a_common_sign_of_depression',
                Post_19__c:
                  'form.post_challenge_south_africa_-_skillz_girl.i_know_at_least_three_methods_to_prevent_an_unwanted_pregnancy',
              },
              'portuguese_post_challenge_gcr_-_skillz_girl': {
                Post_1__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.falei_sobre_o_hiv_com_uma_pessoa_adulta_nos_ltimos_2_meses_fora_do_skillz',
                Post_2__c: 'form.portuguese_post_challenge_gcr_-_skillz_girl.sei_como_expressar_a_minha_raiva_sem_ser_violento',
                Post_3__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.sei_como_superar_os_desafios_que_possa_enfrentar_na_minha_vida',
                Post_4__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.sei_quais_as_decises_a_tomar_para_alcanar_os_meus_objectivos',
                Post_5__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.os_rapazes_correm_um_risco_mais_elevado_de_serem_vtimas_de_violncia_do_que_',
                Post_6__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.conheco_que_mudanas_ocorrem_no_meu_corpo_durante_a_puberdade',
                Post_7__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.conheo_pelo_menos_trs_mtodos_para_evitar_uma_gravidez_indesejada',
                Post_8__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.os_preservativos_so_o_nico_mtodo_contraceptivo_que_protege_contra_a_gravide',
                Post_9__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.conheco_onde_obter_servios_de_apoio_para_mim_ou_outra_pessoa_para_casos_de_',
                Post_10__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.se_uma_rapariga_inicia_seu_perodo_menstrual_significa_que_est_pronta_para_c',
                Post_11__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.caso_eu_seja_abusada_sexualmente_prefiro_guard-lo_para_mim_para_evitar_que_',
                Post_12__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.um_homem_tem_o_direito_de_ter_sexo_com_a_sua_namorada_mesmo_que_ela_no_o_qu',
                Post_13__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.pessoas_com_problemas_de_sade_mental_so_apenas_confusas_ou_loucas',
                Post_14__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.pessoas_com_problemas_de_sade_mental_so_apenas_confusas_ou_loucas',
                Post_15__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.informaria_a_algum_caso_fosse_tocada_por_alguem_de_uma_forma_que_me_deixass',
                Post_16__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.uma_filha_deve_sempre_respeitar_a_deciso_dos_seus_pais_para_se_casar',
                Post_17__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.um_casamento_bem_sucedido__mais_importante_para_as_raparigas_do_que_termina',
                Post_18__c: 'form.portuguese_post_challenge_gcr_-_skillz_girl.eu_no_praticaria_desporto_com_algum_que_tem_hiv',
                Post_19__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.um_namorado_pode_ter_boas_razes_para_bater_na_sua_namorada',
                Post_20__c:
                  'form.portuguese_post_challenge_gcr_-_skillz_girl.no_faz_mal_que_um_rapaz_ameace_bater_na_sua_namorada_se_nunca_a_bater_fisic',
              },
              'post_challenge_zambia_-_plus_mh_enhanced_zambia': {
                Post_1__c: 'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.in_general_i_feel_good_about_myself',
                Post_2__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.i_have_the_skills_and_knowledge_to_avoid_getting_infected_with_another_kind',
                Post_3__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_important_to_know_why_and_how_i_want_to_tell_someone_my_hiv_status',
                Post_4__c: 'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.i_accept_myself_and_my_hiv_status',
                Post_5__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Post_6__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.are_you_or_have_you_been_past_12_months_in_a_sexual_relationship_na_if_not_',
                Post_7__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
                Post_8__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                Post_9__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.there_are_people_i_trust_with_whom_i_can_talk_about_my_status',
                Post_10__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_okay_for_two_people_with_hiv_to_have_unprotected_sex_with_each_other',
                Post_11__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.it_is_okay_for_someone_with_hiv_to_stop_taking_their_arv_as_soon_as_they_st',
                Post_12__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.when_i_have_a_choice_it_is_important_to_eat_a_variety_of_foods_including_gr',
                Post_13__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.mental_health_problems_have_nothing_to_do_with_being_lazy_or_weak_and_many_',
                Post_14__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.art_adherence_is_an_important_part_of_my_overall_health_and_well-being',
                Post_15__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.the_most_common_illnesses_of_mental_health_are_depression_and_anxiety',
                Post_16__c:
                  'form.post_challenge_zambia_-_plus_mh_enhanced_zambia.biological_and_social_factors_contribute_to_females_and_males_experiencing_',
              },
              'post_challenge_nigeria_-_advanced_skills': {
                Post_1__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_have_talked_about_hiv_with_an_adult_in_the_past_two_months_outside_skillz',
                Post_2__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_have_talked_about_malaria_with_an_adult_in_the_past_two_months_outside_sk',
                Post_3__c:
                  'form.post_challenge_nigeria_-_advanced_skills.unequal_power_in_relationships_can_contribute_to_the_spread_of_hiv',
                Post_4__c:
                  'form.post_challenge_nigeria_-_advanced_skills.the_most_effective_way_to_avoid_getting_hiv_is_to_abstain_from_sex',
                Post_5__c: 'form.post_challenge_nigeria_-_advanced_skills.malaria_is_spread_by_standing_under_the_hot_sun',
                Post_6__c: 'form.post_challenge_nigeria_-_advanced_skills.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                Post_7__c:
                  'form.post_challenge_nigeria_-_advanced_skills.sleeping_under_a_mosquito_net_every_night_can_help_protect_me_from_malaria',
                Post_8__c:
                  'form.post_challenge_nigeria_-_advanced_skills.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                Post_9__c:
                  'form.post_challenge_nigeria_-_advanced_skills.it_is_okay_for_someone_with_malaria_to_stop_taking_their_medication_as_soon',
                Post_10__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_can_abstain_from_sex_until_i_am_older_even_if_it_is_difficult',
                Post_11__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Post_12__c:
                  'form.post_challenge_nigeria_-_advanced_skills.men_should_share_the_work_around_the_house_such_as_cleaning',
                Post_13__c:
                  'form.post_challenge_nigeria_-_advanced_skills.it_is_the_males_responsibilty_to_make_decisions_in_a_relationship',
                Post_14__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_can_use_drugs_and_still_easily_reach_my_goals_in_life',
                Post_15__c:
                  'form.post_challenge_nigeria_-_advanced_skills.when_sick_it_is_better_to_visit_the_herb_seller_than_to_visit_a_doctor_or_a',
                Post_16__c:
                  'form.post_challenge_nigeria_-_advanced_skills.it_is_okay_to_use_violence_with_my_partner_if_he_or_she_makes_me_angry',
                Post_17__c:
                  'form.post_challenge_nigeria_-_advanced_skills.i_have_the_power_to_change_gender_expectations_that_i_do_not_agree_with',
              },
              'post_challenge_zimbabwe_-_skillz_core_zimbabwe': {
                Post_1__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_know_what_decisions_to_make_to_achieve_my_goals',
                Post_2__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girlboy',
                Post_3__c: 'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_what_i_am_good_at',
                Post_4__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                Post_5__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Post_6__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Post_7__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_access_sexual_health_services_such_as_sti_and_hiv_testi',
                Post_8__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Post_9__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Post_10__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.girls_should_be_obedient_and_should_not_disagree_with_boys',
                Post_11__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                Post_12__c: 'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.my_skillz_coach_helps_me_to_be_a_better_person',
                Post_13__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                Post_14__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.if_i_test_positive_for_hiv_there_will_be_someone_who_will_help_and_support_',
                Post_15__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_who_to_go_to_if_i_amsomeone_i_know_is_abused_sexually_physically_and',
                Post_16__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_who_to_go_to_if_someone_touches_me_in_a_way_that_makes_me_uncomforta',
                Post_17__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                Post_18__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Post_19__c:
                  'form.post_challenge_zimbabwe_-_skillz_core_zimbabwe.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
              },
              'copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe': {
                Post_1__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_know_what_decisions_to_make_to_achieve_my_goals',
                Post_2__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_dont_always_have_to_do_what_people_expect_just_because_i_am_girlboy',
                Post_3__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Post_4__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_can_make_my_own_informed_decisions_about_my_sexual_health',
                Post_5__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Post_6__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Post_7__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.my_skillz_coach_helps_me_to_be_a_better_person',
                Post_8__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advise_or_when_i_have_a',
                Post_9__c:
                  'form.copy-1-of-post_challenge_zimbabwe_-_virtual_skillz_core_zimbabwe.copy-1-of-i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
              },
              'post_challenge_skillz_girl_-_zam_311': {
                Post_1__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_what_i_am_good_at',
                Post_2__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_how_to_overcome_challenges_that_i_may_face_in_my_life',
                Post_3__c: 'form.post_challenge_skillz_girl_-_zam_311.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girl',
                Post_4__c: 'form.post_challenge_skillz_girl_-_zam_311.i_would_be_able_to_ask_my_boyfriend_that_i_want_to_use_a_condom',
                Post_5__c: 'form.post_challenge_skillz_girl_-_zam_311.i_can_say_no_to_sex_even_if_my_boyfriend_or_friends_pressure_me_to_have_sex',
                Post_6__c: 'form.post_challenge_skillz_girl_-_zam_311.if_i_am_sexually_active_i_go_to_a_healthcare_provider_to_get_protection_fro',
                Post_7__c: 'form.post_challenge_skillz_girl_-_zam_311.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                Post_8__c: 'form.post_challenge_skillz_girl_-_zam_311.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                Post_9__c: 'form.post_challenge_skillz_girl_-_zam_311.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Post_10__c: 'form.post_challenge_skillz_girl_-_zam_311.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_or_wife',
                Post_11__c: 'form.post_challenge_skillz_girl_-_zam_311.a_successful_marriage_is_more_important_to_girls_than_completing_school',
                Post_12__c: 'form.post_challenge_skillz_girl_-_zam_311.a_daughter_should_always_respect_her_parents_decision_for_her_to_get_marrie',
                Post_13__c: 'form.post_challenge_skillz_girl_-_zam_311.i_can_decide_when_is_the_right_time_for_me_to_have_a_baby',
                Post_14__c: 'form.post_challenge_skillz_girl_-_zam_311.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                Post_15__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                Post_16__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_gender_base',
                Post_17__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_where_to_get_support_services_for_me_or_someone_else_for_prevention_',
                Post_18__c: 'form.post_challenge_skillz_girl_-_zam_311.one_sign_of_pregnancy_is_a_girl_missing_her_period',
                Post_19__c: 'form.post_challenge_skillz_girl_-_zam_311.i_know_at_least_three_methods_to_avoid_an_unwanted_pregnancy',
                Post_20__c: 'form.post_challenge_skillz_girl_-_zam_311.are_you_or_your_boyfriend_currently_using_any_contraceptive_method',
              },
              'post_challenge_skillz_core_zambia_211': {
                Post_1__c: 'form.post_challenge_skillz_core_zambia_211.question1',
                Post_2__c: 'form.post_challenge_skillz_core_zambia_211.i_know_how_to_overcome_challenges_i_may_have_in_my_life',
                Post_3__c: 'form.post_challenge_skillz_core_zambia_211.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                Post_4__c: 'form.post_challenge_skillz_core_zambia_211.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Post_5__c: 'form.post_challenge_skillz_core_zambia_211.i_dont_always_have_to_do_what_people_expect_because_i_am_a_boygirl',
                Post_6__c: 'form.post_challenge_skillz_core_zambia_211.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Post_7__c: 'form.post_challenge_skillz_core_zambia_211.girls_should_not_disagree_with_boys',
                Post_8__c: 'form.post_challenge_skillz_core_zambia_211.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                Post_9__c: 'form.post_challenge_skillz_core_zambia_211.i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                Post_10__c: 'form.post_challenge_skillz_core_zambia_211.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                Post_11__c: 'form.post_challenge_skillz_core_zambia_211.if_i_test_positive_for_hivthere_will_be_someone_who_will_help_and_support_m',
                Post_12__c: 'form.post_challenge_skillz_core_zambia_211.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                Post_13__c: 'form.post_challenge_skillz_core_zambia_211.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                Post_14__c: 'form.post_challenge_skillz_core_zambia_211.i_know_where_to_get_support_services_for_me_or_someone_elsefor_hiv_-_relate',
                Post_15__c: 'form.post_challenge_skillz_core_zambia_211.i_know_where_to_get_support_services_for_me_or_someone_elsefor_abuse',
                Post_16__c: 'form.post_challenge_skillz_core_zambia_211.i_have_the_right_to_access_sexual_health_servicessuch_as_sti_and_hiv_testin',
                Post_17__c: 'form.post_challenge_skillz_core_zambia_211.one_sign_of_pregnancy_is_a_girl_missing_her_period',
                Post_18__c: 'form.post_challenge_skillz_core_zambia_211.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                Post_19__c: 'form.post_challenge_skillz_core_zambia_211.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
                Post_20__c: 'form.post_challenge_skillz_core_zambia_211.i_know_what_decisions_to_make_to_achieve_my_goals',
              },
              'post_challenge_skillz_boy_zambia110': {
                Post_1__c: 'form.post_challenge_skillz_boy_zambia110.in_general_i_feel_good_about_myself',
                Post_2__c: 'form.post_challenge_skillz_boy_zambia110.i_would_be_able_to_ask_my_girlfriend_that_i_want_to_use_a_condom',
                Post_3__c: 'form.post_challenge_skillz_boy_zambia110.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_boy',
                Post_4__c: 'form.post_challenge_skillz_boy_zambia110.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                Post_5__c: 'form.post_challenge_skillz_boy_zambia110.it_is_more_important_for_boys_to_be_educated_than_girls',
                Post_6__c: 'form.post_challenge_skillz_boy_zambia110.men_are_better_leaders_than_women',
                Post_7__c: 'form.post_challenge_skillz_boy_zambia110.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                Post_8__c: 'form.post_challenge_skillz_boy_zambia110.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                Post_9__c: 'form.post_challenge_skillz_boy_zambia110.it_is_okay_for_a_boyfriend_to_threaten_to_hit_his_girlfriend_if_he_never_hi',
                Post_10__c: 'form.post_challenge_skillz_boy_zambia110.i_can_say_no_to_sex_even_if_my_friends_or_girlfriend_pressure_me_to_have_se',
                Post_11__c: 'form.post_challenge_skillz_boy_zambia110.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_sexual_behaviou',
                Post_12__c: 'form.post_challenge_skillz_boy_zambia110.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Post_13__c: 'form.post_challenge_skillz_boy_zambia110.i_have_a_friend_that_i_can_go_to_for_advice_when_i_have_a_problem',
                Post_14__c: 'form.post_challenge_skillz_boy_zambia110.i_have_the_right_to_access_sexual_health_services_such_as_hiv_and_sti_testi',
                Post_15__c: 'form.post_challenge_skillz_boy_zambia110.i_know_where_to_access_sexual_health_services_such_as_sti_and_hiv_testing',
                Post_16__c: 'form.post_challenge_skillz_boy_zambia110.before_making_a_decision_i_think_about_how_it_can_affect_me_or_others',
                Post_17__c: 'form.post_challenge_skillz_boy_zambia110.i_know_how_to_express_my_anger_without_being_violent_such_as_hitting_kickin',
                Post_18__c: 'form.post_challenge_skillz_boy_zambia110.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                Post_19__c: 'form.post_challenge_skillz_boy_zambia110.i_know_how_to_correctly_use_a_male_condom',
                Post_20__c: 'form.post_challenge_skillz_boy_zambia110.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
              },
              'post_challenge_skillz_guyz_mh_-_sa_100':{
                Post_1__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_have_to_be_respectful_communicate_and_take_action_to_be_a_role_model_in_m',
                Post_2__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_have_skills_that_help_me_bounce_back_from_difficult_situations',
                Post_3__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_can_identify_my_strengths_or_things_that_i_am_good_at',
                Post_4__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.when_i_am_angry_i_know_how_to_avoid_using_violent_behaviour',
                Post_5__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.when_i_express_my_feelings_clearly_people_understand_me_better',
                Post_6__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Post_7__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.sadness_and_a_loss_of_pleasure_in_things_you_enjoy_are_common_symptoms_of_d',
                Post_8__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_know_where_to_access_health_services_and_mental_health_services',
                Post_9__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_will_share_accurate_information_about_mental_health_services_to_avoid_sti',
                Post_10__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                Post_11__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.men_should_share_the_work_around_the_house_such_as_cleaning_and_taking_care',
                Post_12__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.its_okay_for_a_guy_to_beat_a_girl_when_there_is_a_misunderstanding',
                Post_13__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_should_respect_the_rights_of_others_such_as_their_right_to_their_own_opin',
                Post_14__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_feel_confident_setting_my_goals',
                Post_15__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.stress_is_a_normal_part_of_life',
                Post_16__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Post_17__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.there_are_people_i_trust_with_whom_i_can_talk_to_about_my_mental_health',
                Post_18__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_have_no_fear_or_shame_when_accessing_health_services_or_mental_health_ser',
                Post_19__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                Post_20__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Post_21__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_can_stand_up_to_peer_pressure_when_i_have_to',
                Post_22__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_should_use_a_condom_even_if_my_girlfriend_is_on_another_form_of_birth_con',
                Post_23__c: 'form.post_challenge_skillz_guyz_mh_-_sa_100.i_know_where_to_go_for_support_if_i_or_someone_i_know_abuses_alcohol',
              },
              'post_challenge_mindskillz-_zambia_100': {
                  Post_1__c:'form.post_challenge_mindskillz-_zambia_100.when_i_express_my_feelings_clearly_people_understand_me_better',
                  Post_2__c:'form.post_challenge_mindskillz-_zambia_100.i_have_skills_that_help_me_bounce_back_from_difficult_situations',
                  Post_3__c:'form.post_challenge_mindskillz-_zambia_100.stress_is_a_normal_part_of_life',
                  Post_4__c:'form.post_challenge_mindskillz-_zambia_100.i_can_reach_my_goals_in_life',
                  Post_5__c:'form.post_challenge_mindskillz-_zambia_100.if_i_have_a_problem_i_have_someone_in_my_life_i_can_go_to_for_support',
                  Post_6__c:'form.post_challenge_mindskillz-_zambia_100.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                  Post_7__c:'form.post_challenge_mindskillz-_zambia_100.self_control_helps_you_make_smart_decisions_when_you_are_angry_or_upset',
                  Post_8__c:'form.post_challenge_mindskillz-_zambia_100.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                  Post_9__c:'form.post_challenge_mindskillz-_zambia_100.i_know_how_to_express_my_anger_without_being_violent',
                  Post_10__c:'form.post_challenge_mindskillz-_zambia_100.listening_carefully_to_others_is_an_important_communication_skill',
                  Post_11__c:'form.post_challenge_mindskillz-_zambia_100.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                  Post_12__c:'form.post_challenge_mindskillz-_zambia_100.i_can_understand_how_others_are_feeling_and_be_sensitive_to_their_emotions',
                  Post_13__c:'form.post_challenge_mindskillz-_zambia_100.i_am_confident_that_i_know_where_to_seek_information_about_mental_illness',
                  Post_14__c:'form.post_challenge_mindskillz-_zambia_100.i_am_confident_using_the_computer_or_telephone_to_seek_information_about_me',
                  Post_15__c:'form.post_challenge_mindskillz-_zambia_100.i_am_confident_attending_face_to_face_appointments_to_seek_information_abou',
                  Post_16__c:'form.post_challenge_mindskillz-_zambia_100.i_am_confident_i_have_access_to_resources_eg_doctor_internet_friends_that_i',
                  Post_17__c:'form.post_challenge_mindskillz-_zambia_100.people_with_mental_illness_could_snap_out_of_it_if_they_wanted',
                  Post_18__c:'form.post_challenge_mindskillz-_zambia_100.a_mental_illness_is_a_sign_of_personal_weakness',
                  Post_19__c:'form.post_challenge_mindskillz-_zambia_100.a_mental_illness_is_not_a_real_medical_illness',
                  Post_20__c:'form.post_challenge_mindskillz-_zambia_100.people_with_mental_illness_are_dangerous',
                  Post_21__c:'form.post_challenge_mindskillz-_zambia_100.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                  Post_22__c:'form.post_challenge_mindskillz-_zambia_100.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                  Post_23__c:'form.post_challenge_mindskillz-_zambia_100.seeing_a_mental_health_professional_means_you_are_not_strong_enough_to_mana',
                  Post_24__c:'form.post_challenge_mindskillz-_zambia_100.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi',
                  Post_25__c:'form.post_challenge_mindskillz-_zambia_100.i_believe_treatment_for_a_mental_illness_provided_by_a_mental_health_profes',
                        },
                        
                'post_challenge_skillz_girl_nih200': {
                  Post_1__c:'form.post_challenge_skillz_girl_nih200.i_have_talked_about_hiv_with_an_adult_in_the_past_two_months_outside_skillz',
          Post_2__c:'form.post_challenge_skillz_girl_nih200.i_have_talked_about_hiv_with_a_friend_in_the_past_two_months_outside_skillz',
          Post_3__c:'form.post_challenge_skillz_girl_nih200.having_sex_with_an_older_partner_increases_my_risk_of_getting_hiv',
          Post_4__c:'form.post_challenge_skillz_girl_nih200.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
          Post_5__c:'form.post_challenge_skillz_girl_nih200.i_know_someone_in_my_community_who_distributes_contraceptives_and_other_sex',
          Post_6__c:'form.post_challenge_skillz_girl_nih200.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
          Post_7__c:'form.post_challenge_skillz_girl_nih200.i_have_the_right_to_say_no_to_sex_no_matter_who_asks',
          Post_8__c:'form.post_challenge_skillz_girl_nih200.as_a_girl_i_have_a_greater_risk_of_getting_hiv_than_boys',
          Post_9__c:'form.post_challenge_skillz_girl_nih200.i_know_where_to_get_support_services_for_rape',
          Post_10__c:'form.post_challenge_skillz_girl_nih200.if_a_girl_is_sexually_abused_she_can_reduce_her_risk_of_getting_hiv_by_taki',
          Post_11__c:'form.post_challenge_skillz_girl_nih200.i_feel_good_about_being_a_girl',
          Post_12__c:'form.post_challenge_skillz_girl_nih200.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
          Post_13__c:'form.post_challenge_skillz_girl_nih200.boys_should_share_the_work_around_the_home_such_as_household_chores',
          Post_14__c:'form.post_challenge_skillz_girl_nih200.i_know_what_i_want_to_be_after_finishing_secondary_school',
          Post_15__c:'form.post_challenge_skillz_girl_nih200.if_i_have_a_problem_i_have_someone_in_my_life_i_can_talk_to_for_advise',
          Post_16__c:'form.post_challenge_skillz_girl_nih200.a_boyfriend_may_have_good_reason_to_hit_his_girlfriend',
          Post_17__c:'form.post_challenge_skillz_girl_nih200.i_would_tell_someone_if_i_were_touched_in_a_manner_that_made_me_uncomfortab',
          Post_18__c:'form.post_challenge_skillz_girl_nih200.i_can_reach_my_goals_in_life',
          Post_19__c:'form.post_challenge_skillz_girl_nih200.a_girl_should_wait_to_get_married_until_after_college',
          Post_20__c:'form.post_challenge_skillz_girl_nih200.biological_and_social_factors_contribute_to_females_and_males_experiencing_',
          Post_21__c:'form.post_challenge_skillz_girl_nih200.the_most_common_illness_of_mental_health_are_depression_and_anxiety',
          Post_22__c:'form.post_challenge_skillz_girl_nih200.mental_health_problems_have_nothing_to_do_with_being_lazy_or_weak_and_many_',
          Post_23__c:'form.post_challenge_skillz_girl_nih200.i_am_ready_to_take_an_hiv_test',
          Post_24__c:'form.post_challenge_skillz_girl_nih200.are_you_or_your_boyfriendgirlfriend_currently_using_any_contraceptive_or_pr',
                },
                
                'post_challenge_mindskillz_pamumvuri':{
                  Post_1__c: 'form.post_challenge_mindskillz_pamumvuri.when_i_express_my_feelings_clearly_people_understand_me_better',
                  Post_2__c: 'form.post_challenge_mindskillz_pamumvuri.have_skills_that_help_me_bounce_back_from_difficult_situations',
                  Post_3__c: 'form.post_challenge_mindskillz_pamumvuri.stress_is_a_normal_part_of_life',
                  Post_4__c: 'form.post_challenge_mindskillz_pamumvuri.i_can_reach_my_goals_in_life',
                  Post_5__c: 'form.post_challenge_mindskillz_pamumvuri.if_i_have_a_problem_i_have_someone_in_my_life_i_can_go_to_for_support',
                  Post_6__c: 'form.post_challenge_mindskillz_pamumvuri.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                  Post_7__c: 'form.post_challenge_mindskillz_pamumvuri.self_control_helps_you_make_smart_decisions_when_you_are_angry_or_upset',
                  Post_8__c: 'form.post_challenge_mindskillz_pamumvuri.society_expects_boys_and_girls_to_deal_with_their_emotions_differently',
                  Post_9__c: 'form.post_challenge_mindskillz_pamumvuri.i_know_how_to_express_my_anger_without_being_violent',
                  Post_10__c: 'form.post_challenge_mindskillz_pamumvuri.listening_carefully_to_others_is_an_important_communication_skill',
                  Post_11__c: 'form.post_challenge_mindskillz_pamumvuri.drinking_too_much_alcohol_can_have_serious_negative_consequences_for_mental',
                  Post_12__c: 'form.post_challenge_mindskillz_pamumvuri.i_can_understand_how_others_are_feeling_and_be_sensitive_to_their_emotions',
                  Post_13__c: 'form.post_challenge_mindskillz_pamumvuri.i_am_confident_that_i_know_where_to_seek_information_about_mental_illness',
                  Post_14__c: 'form.post_challenge_mindskillz_pamumvuri.i_am_confident_using_the_computer_or_telephone_to_seek_information_about_me',
                  Post_15__c: 'form.post_challenge_mindskillz_pamumvuri.i_am_confident_attending_face_to_face_appointments_to_seek_information_abou',
                  Post_16__c: 'form.post_challenge_mindskillz_pamumvuri.i_am_confident_i_have_access_to_resources_eg_doctor_internet_friends_that_i',
                  Post_17__c: 'form.post_challenge_mindskillz_pamumvuri.people_with_mental_illness_could_snap_out_of_it_if_they_wanted',
                  Post_18__c: 'form.post_challenge_mindskillz_pamumvuri.a_mental_illness_is_a_sign_of_personal_weakness',
                  Post_19__c: 'form.post_challenge_mindskillz_pamumvuri.a_mental_illness_is_not_a_real_medical_illness',
                  Post_20__c: 'form.post_challenge_mindskillz_pamumvuri.people_with_mental_illness_are_dangerous',
                  Post_21__c: 'form.post_challenge_mindskillz_pamumvuri.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                  Post_22__c: 'form.post_challenge_mindskillz_pamumvuri.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                  Post_23__c: 'form.post_challenge_mindskillz_pamumvuri.seeing_a_mental_health_professional_means_you_are_not_strong_enough_to_mana',
                  Post_24__c: 'form.post_challenge_mindskillz_pamumvuri.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi',
                  Post_25__c: 'form.post_challenge_mindskillz_pamumvuri.i_believe_treatment_for_a_mental_illness_provided_by_a_mental_health_profes',

                },
              
              'post_challenge_south_africa_-_skillz_girl_mh_sa_211':{
                Post_1__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_my_rights_and_responsibilities',
                Post_2__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Post_3__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Post_4__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.stress_is_a_normal_part_of_life',
                Post_5__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.like_physical_health_we_all_have_mental_health',
                Post_6__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Post_7__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.healthy_relationships_are_based_on_healthy_communication_and_mutual_respect',
                Post_8__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_partner_or_wif',
                Post_9__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Post_10__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Post_11__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.taking_prep_and_using_a_condom_can_lower_my_risk_of_getting_hiv',
                Post_12__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Post_13__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Post_14__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.post_exposure_prophylaxis_pep_can_reduce_my_risk_of_getting_hiv_if_taken_1-',
                Post_15__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.it_is_my_right_to_access_health_services',
                Post_16__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_have_an_adult_or_someone_in_my_life_i_can_go_to_for_advice',
                Post_17__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_can_give_support_and_encouragement_to_a_friend_or_family_member_who_is_li',
                Post_18__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.using_a_condom_and_another_contraceptive_method_can_help_prevent_unwanted_p',
                Post_19__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Post_20__c: 'form.post_challenge_south_africa_-_skillz_girl_mh_sa_211.drinking_too_much_alcohol_can_harm_the_body_and_the_mind',
              },
              
               'post_challenge_skillz_girl_abbreviated_south_africa':{
                Post_1__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_know_my_rights_and_responsibilities',
                Post_2__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_can_identify_my_strengths_or_things_that_i_am_good_at_in_life',
                Post_3__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_know_where_to_get_contraception_to_prevent_unwanted_pregnancy',
                Post_4__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.stress_is_a_normal_part_of_life',
                Post_5__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.like_physical_health_we_all_have_mental_health',
                Post_6__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                Post_7__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.in_a_relationship_it_is_both_partners_responsibility_to_prevent_unwanted_pr',
                Post_8__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.healthy_relationships_are_based_on_healthy_communication_and_respect',
                Post_9__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_partner_or_wif',
                Post_10__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.a_person_has_the_right_to_have_sex_with_their_partner_even_if_the_partner_d',
                Post_11__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_can_say_no_to_sex_even_if_my_partner_or_friends_pressure_me_to_have_sex',
                Post_12__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.having_more_than_one_sexual_partner_increases_my_risk_of_getting_hiv',
                Post_13__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.taking_prep_and_using_a_condom_can_lower_my_risk_of_getting_hiv',
                Post_14__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                Post_15__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.deep_breathing_is_a_healthy_way_to_deal_with_difficult_and_stressful_situat',
                Post_16__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_can_use_coping_skills_to_handle_stress',
                Post_17__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.post_exposure_prophylaxis_pep_can_reduce_my_risk_of_getting_hiv_if_taken_1-',
                Post_18__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.it_is_my_right_to_access_health_services',
                Post_19__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_have_an_adult_or_someone_in_my_life_i_can_go_to_for_advice',
                Post_20__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.using_a_condom_and_another_contraceptive_method_can_help_prevent_unwanted_p',
                Post_21__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_know_what_changes_to_expect_in_my_body_during_puberty',
                Post_22__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.drinking_too_much_alcohol_can_harm_the_body_and_mind',
                Post_23__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_know_at_least_two_ways_of_saving_money',
                Post_24__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.a_budget_is_the_estimated_income_and_expenses_for_a_certain_time_period',
                Post_25__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.accepting_money_for_sexual_favors_can_create_risks_to_my_health_and_safety',
                Post_26__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.using_assertive_communication_means_respectfully_sharing_my_thoughts_and_fe',
                Post_27__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.i_have_the_right_to_access_emergency_contraception',
                Post_28__c: 'form.post_challenge_skillz_girl_abbreviated_south_africa.if_a_girl_has_unprotected_sex_and_misses_her_period_this_could_mean_she_is_',
              },
              
              'post_challenge_skillz_guyz_-_yedi__323':{
                 Post_1__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_know_how_to_stand_up_to_peer_pressure_ie_to_drink_alcohol_or_have_sex_fro',
                 Post_2__c: 'form.post_challenge_skillz_guyz_-_yedi__323.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Post_3__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_have_someone_i_can_go_to_for_advice',
                 Post_4__c: 'form.post_challenge_skillz_guyz_-_yedi__323.no_one_has_the_right_to_touch_me_in_a_way_that_makes_me_uncomfortable_such_',
                 Post_5__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                 Post_6__c: 'form.post_challenge_skillz_guyz_-_yedi__323.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_behaviours_such',
                 Post_7__c: 'form.post_challenge_skillz_guyz_-_yedi__323.it_is_the_males_responsibility_to_make_decisions_in_a_relationship',
                 Post_8__c: 'form.post_challenge_skillz_guyz_-_yedi__323.a_mental_illness_is_a_sign_of_personal_weakness',
                 Post_9__c: 'form.post_challenge_skillz_guyz_-_yedi__323.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Post_10__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                 Post_11__c: 'form.post_challenge_skillz_guyz_-_yedi__323.a_boys_opinion_is_more_important_than_a_girls',
                 Post_12__c: 'form.post_challenge_skillz_guyz_-_yedi__323.men_should_share_the_work_around_the_house_such_as_cleaning_and_taking_care',
                 Post_13__c: 'form.post_challenge_skillz_guyz_-_yedi__323.its_okay_for_a_guy_to_beat_a_girl_when_she_misbehaves',
                 Post_14__c: 'form.post_challenge_skillz_guyz_-_yedi__323.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Post_15__c: 'form.post_challenge_skillz_guyz_-_yedi__323.it_is_only_the_girls_responsibility_to_avoid_getting_pregnant',
                 Post_16__c: 'form.post_challenge_skillz_guyz_-_yedi__323.condoms_are_the_only_contraceptive_method_that_protect_against_pregnancy_as',
                 Post_17__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_would_stand_up_to_my_friends_if_they_were_harming_others_such_as_touching',
                 Post_18__c: 'form.post_challenge_skillz_guyz_-_yedi__323.having_more_than_one_sexual_partner_over_the_same_time_period_increases_my_',
                 Post_19__c: 'form.post_challenge_skillz_guyz_-_yedi__323.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                 Post_20__c: 'form.post_challenge_skillz_guyz_-_yedi__323.i_have_the_ability_to_shape_my_own_life',
              },
              
                'post_challenge_skillz_girl_mh_zambia':{
                 Post_1__c: 'form.post_challenge_skillz_girl_mh_zambia.a_mental_illness_is_a_sign_of_personal_weakness',
                 Post_2__c: 'form.post_challenge_skillz_girl_mh_zambia.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Post_3__c: 'form.post_challenge_skillz_girl_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girl',
                 Post_4__c: 'form.post_challenge_skillz_girl_mh_zambia.if_i_had_a_boyfriend_i_would_be_able_to_ask_him_to_use_a_condom_before_havi',
                 Post_5__c: 'form.post_challenge_skillz_girl_mh_zambia.i_can_say_no_to_sex_even_if_my_boyfriend_or_friends_pressure_to_have_sex',
                 Post_6__c: 'form.post_challenge_skillz_girl_mh_zambia.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Post_7__c: 'form.post_challenge_skillz_girl_mh_zambia.i_can_make_my_own_informed_decisions_about_my_sexual_healthcare',
                 Post_8__c: 'form.post_challenge_skillz_girl_mh_zambia.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Post_9__c: 'form.post_challenge_skillz_girl_mh_zambia.a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want',
                 Post_10__c: 'form.post_challenge_skillz_girl_mh_zambia.sometimes_a_man_may_have_a_good_reason_to_hit_his_girlfriend_or_wife',
                 Post_11__c: 'form.post_challenge_skillz_girl_mh_zambia.a_successful_marrige_is_more_important_to_girls_than_completing_school',
                 Post_12__c: 'form.post_challenge_skillz_girl_mh_zambia.a_daughter_should_always_respect_her_parents_decision_to_get_married',
                 Post_13__c: 'form.post_challenge_skillz_girl_mh_zambia.i_can_decide_when_is_the_right_time_for_me_to_have_a_baby',
                 Post_14__c: 'form.post_challenge_skillz_girl_mh_zambia.i_have_someone_in_my_life_i_can_turn_to_when_i_need_advice_or_when_i_have_a',
                 Post_15__c: 'form.post_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related',
                 Post_16__c: 'form.post_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_gender_base',
                 Post_17__c: 'form.post_challenge_skillz_girl_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_prevention_',
                 Post_18__c: 'form.post_challenge_skillz_girl_mh_zambia.if_sexually_active_one_sign_of_pregnance_is_a_girl_missing_her_period',
                 Post_19__c: 'form.post_challenge_skillz_girl_mh_zambia.i_know_at_least_three_methods_to_avoid_an_unwanted_pregnancy',
                 Post_20__c: 'form.post_challenge_skillz_girl_mh_zambia.are_you_or_your_boyfriend_currently_using_any_contraceptive_method',
                 
              },
              
              'post_challenge_skillz_core_mh_zambia':{
                 Post_1__c: 'form.post_challenge_skillz_core_mh_zambia.i_know_what_i_am_good_at',
                 Post_2__c: 'form.post_challenge_skillz_core_mh_zambia.i_know_how_to_overcome_challenges_that_i_may_have_in_life',
                 Post_3__c: 'form.post_challenge_skillz_core_mh_zambia.i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others',
                 Post_4__c: 'form.post_challenge_skillz_core_mh_zambia.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                 Post_5__c: 'form.post_challenge_skillz_core_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_girlboy',
                 Post_6__c: 'form.post_challenge_skillz_core_mh_zambia.a_man_has_the_right_to_have_sex_with_his_wifegirlfriend_even_if_she_doesnt_',
                 Post_7__c: 'form.post_challenge_skillz_core_mh_zambia.girls_should_not_disagree_with_boys',
                 Post_8__c: 'form.post_challenge_skillz_core_mh_zambia.if_a_girl_gets_pregnant_she_should_drop_out_of_school',
                 Post_9__c: 'form.post_challenge_skillz_core_mh_zambia.i_have_the_right_to_say_no_to_sex_no_matter_who_asks_me',
                 Post_10__c: 'form.post_challenge_skillz_core_mh_zambia.i_have_an_older_person_in_my_life_i_can_go_to_for_advice',
                 Post_11__c: 'form.post_challenge_skillz_core_mh_zambia.if_i_test_positive_for_hiv_there_will_be_someone_who_will_help_and_support_',
                 Post_12__c: 'form.post_challenge_skillz_core_mh_zambia.people_with_mental_illness_live_on_the_streets_and_eat_dirty_food_from_garb',
                 Post_13__c: 'form.post_challenge_skillz_core_mh_zambia.drinking_alcohol_can_increase_my_risk_of_getting_hiv',
                 Post_14__c: 'form.post_challenge_skillz_core_mh_zambia.i_only_use_violent_behaviour_when_someone_angers_me',
                 Post_15__c: 'form.post_challenge_skillz_core_mh_zambia.i_know_where_to_get_support_services_for_me_or_someone_else_for_abuse_or_hi',
                 Post_16__c: 'form.post_challenge_skillz_core_mh_zambia.i_have_the_right_to_access_sexual_health_services_such_as_sti_and_hiv_testi',
                 Post_17__c: 'form.post_challenge_skillz_core_mh_zambia.if_sexually_active_one_sign_of_pregnancy_can_be_a_girl_missing_her_period',
                 Post_18__c: 'form.post_challenge_skillz_core_mh_zambia.i_would_say_no_to_playing_sport_with_someone_who_has_hiv',
                 Post_19__c: 'form.post_challenge_skillz_core_mh_zambia.i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her',
                 Post_20__c: 'form.post_challenge_skillz_core_mh_zambia.i_know_what_decisions_to_make_to_achieve_my_goals',
              },
              
              'post_challenge_skillz_guyz_mh_zambia':{
                 Post_1__c: 'form.post_challenge_skillz_guyz_mh_zambia.a_mental_illness_is_a_sign_of_personal_weakness',
                 Post_2__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_would_be_able_to_tell_my_girlfriend_that_i_want_to_use_a_condom',
                 Post_3__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_dont_always_have_to_do_what_people_expect_just_because_i_am_a_boy',
                 Post_4__c: 'form.post_challenge_skillz_guyz_mh_zambia.it_is_the_mans_responsibility_to_make_decisions_in_a_relationship',
                 Post_5__c: 'form.post_challenge_skillz_guyz_mh_zambia.it_is_more_important_for_boys_to_be_educated_than_girls',
                 Post_6__c: 'form.post_challenge_skillz_guyz_mh_zambia.men_are_better_leaders_than_women',
                 Post_7__c: 'form.post_challenge_skillz_guyz_mh_zambia.a_manboy_has_the_right_to_have_sex_with_his_girlfriendwomanwife_even_if_she',
                 Post_8__c: 'form.post_challenge_skillz_guyz_mh_zambia.it_is_better_to_express_yourself_with_anger_when_upset_than_to_use_self-con',
                 Post_9__c: 'form.post_challenge_skillz_guyz_mh_zambia.it_is_okay_for_a_boyfriend_to_threaten_to_hit_his_girlfriend_if_he_never_hi',
                 Post_10__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_can_say_no_to_sex_even_if_my_friends_or_girlfriend_pressure_me_to_have_se',
                 Post_11__c: 'form.post_challenge_skillz_guyz_mh_zambia.people_who_abuse_alcohol_are_more_likely_to_engage_in_risky_sexual_behaviou',
                 Post_12__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh',
                 Post_13__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_have_a_friend_that_i_can_go_to_for_advice_when_i_have_a_problem',
                 Post_14__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_have_the_right_to_access_sexual_health_services_such_as_hiv_and_sti_testi',
                 Post_15__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_know_where_to_access_sexual_health_services_such_as_sti_and_hiv_testing',
                 Post_16__c: 'form.post_challenge_skillz_guyz_mh_zambia.seeking_help_for_mental_health_challenges_is_a_sign_of_weakness',
                 Post_17__c: 'form.post_challenge_skillz_guyz_mh_zambia.young_people_should_avoid_people_with_mental_illness_as_they_are_always_vio',
                 Post_18__c: 'form.post_challenge_skillz_guyz_mh_zambia.male_circumcision_reduces_a_males_risk_of_getting_hiv',
                 Post_19__c: 'form.post_challenge_skillz_guyz_mh_zambia.i_know_how_to_correctly_use_a_male_condom',
                 Post_20__c: 'form.post_challenge_skillz_guyz_mh_zambia.are_you_or_your_girlfriend_currently_using_any_contraceptive_or_protective_',
                 
              },
              
              'post_challenge_mindskillz_sa_10':{
                Post_1__c: 'form.post_challenge_mindskillz_sa_10.mental_health_is_about_how_we_think_feel_and_act',
                Post_2__c: 'form.post_challenge_mindskillz_sa_10.i_can_name_the_feelings_i_have_when_im_happy_sad_or_angry',
                Post_3__c: 'form.post_challenge_mindskillz_sa_10.i_know_how_to_share_my_feelings_with_other_people_in_healthy_ways',
                Post_4__c: 'form.post_challenge_mindskillz_sa_10.mental_health_is_the_same_thing_as_mental_illness',
                Post_5__c: 'form.post_challenge_mindskillz_sa_10.stress_is_a_normal_part_of_life_but_too_much_stress_can_hurt_your_mental_he',
                Post_6__c: 'form.post_challenge_mindskillz_sa_10.i_can_tell_when_stress_is_making_me_feel_upset',
                Post_7__c: 'form.post_challenge_mindskillz_sa_10.i_know_two_ways_to_calm_myself_down_when_i_feel_stressed',
                Post_8__c: 'form.post_challenge_mindskillz_sa_10.taking_care_of_my_mental_health_can_help_me_achieve_my_goals',
                Post_9__c: 'form.post_challenge_mindskillz_sa_10.i_can_identify_my_strengths_or_things_i_am_good_at',
                Post_10__c: 'form.post_challenge_mindskillz_sa_10.i_know_how_to_support_my_friends_in_making_good_choices_for_their_mental_he',
                Post_11__c: 'form.post_challenge_mindskillz_sa_10.i_can_name_three_people_i_can_talk_to_if_i_need_help',
                Post_12__c: 'form.post_challenge_mindskillz_sa_10.i_know_of_adults_or_places_in_my_community_that_can_give_me_mental_health_s',
                Post_13__c: 'form.post_challenge_mindskillz_sa_10.i_can_deal_with_anger_without_being_violent',
                Post_14__c: 'form.post_challenge_mindskillz_sa_10.drinking_alcohol_can_harm_my_mental_and_physical_health',
                Post_15__c: 'form.post_challenge_mindskillz_sa_10.i_can_say_no_to_peer_postssure_like_being_asked_to_drink_alcohol',
                Post_16__c: 'form.post_challenge_mindskillz_sa_10.i_have_talked_to_someone_about_mental_health_in_the_last_month_outside_of_m',
                Post_17__c: 'form.post_challenge_mindskillz_sa_10.people_with_mental_illness_are_dangerous',
                Post_18__c: 'form.post_challenge_mindskillz_sa_10.a_mental_illness_is_a_sign_of_personal_weakness',
                Post_19__c: 'form.post_challenge_mindskillz_sa_10.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Post_20__c: 'form.post_challenge_mindskillz_sa_10.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Post_21__c: 'form.post_challenge_mindskillz_sa_10.if_i_had_mental_illness_i_would_not_seek_help_from_a_mental_health_professi'
              },

              'post_challenge_mindskillz_zambia_2025':{
                Post_1__c: 'form.post_challenge_mindskillz_zambia_2025.mental_health_is_about_how_we_think_feel_and_act',
                Post_2__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_name_the_feelings_i_have_when_im_happy_sad_or_angry',
                Post_3__c: 'form.post_challenge_mindskillz_zambia_2025.i_know_how_to_share_my_feelings_with_other_people_in_healthy_ways',
                Post_4__c: 'form.post_challenge_mindskillz_zambia_2025.mental_health_is_the_same_thing_as_mental_illness',
                Post_5__c: 'form.post_challenge_mindskillz_zambia_2025.stress_is_a_normal_part_of_life_but_too_much_stress_can_hurt_your_mental_he',
                Post_6__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_tell_when_stress_is_making_me_feel_upset',
                Post_7__c: 'form.post_challenge_mindskillz_zambia_2025.i_know_two_ways_to_calm_myself_down_when_i_feel_stressed',
                Post_8__c: 'form.post_challenge_mindskillz_zambia_2025.taking_care_of_my_mental_health_can_help_me_achieve_my_goals',
                Post_9__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_identify_my_strengths_or_things_i_am_good_at',
                Post_10__c: 'form.post_challenge_mindskillz_zambia_2025.i_know_how_to_support_my_friends_in_making_good_choices_for_their_mental_he',
                Post_11__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_name_three_people_i_can_talk_to_if_i_need_help',
                Post_12__c: 'form.post_challenge_mindskillz_zambia_2025.i_know_of_adults_or_places_in_my_community_that_can_give_me_mental_health_s',
                Post_13__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_deal_with_anger_without_being_violent',
                Post_14__c: 'form.post_challenge_mindskillz_zambia_2025.drinking_alcohol_can_harm_my_mental_and_physical_health',
                Post_15__c: 'form.post_challenge_mindskillz_zambia_2025.i_can_say_no_to_peer_pressure_like_being_asked_to_drink_alcohol',
                Post_16__c: 'form.post_challenge_mindskillz_zambia_2025.i_have_talked_to_someone_about_mental_health_in_the_last_month_outside_of_m',
                Post_17__c: 'form.post_challenge_mindskillz_zambia_2025.people_with_mental_illness_are_dangerous',
                Post_18__c: 'form.post_challenge_mindskillz_zambia_2025.a_mental_illness_is_a_sign_of_personal_weakness',
                Post_19__c: 'form.post_challenge_mindskillz_zambia_2025.it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi',
                Post_20__c: 'form.post_challenge_mindskillz_zambia_2025.if_i_had_a_mental_illness_i_would_not_tell_anyone',
                Post_21__c: 'form.post_challenge_mindskillz_zambia_2025.if_i_had_a_mental_illness_i_would_not_seek_help_from_a_mental_health_profes'

              }
                
            };

            const pluckSfValue = val => {
              //  if sfFieldMapping[formVersion][val] == undefined
              return sfFieldMapping[formVersion][val];
            };

            return { ...state, formVersion, pluckSfValue };
          });

          fn(state => {
            if (state.formVersion == 'post_challenge_ecap_-_post_-_season_survey_for_athletes') {
              return state;
            }
            const PID = lastReferenceValue('records[0].Participant_Identification_Number_PID__c')(state);

            if (!PID) {
              console.log(
                `Participant not found with Participant_Identification_Number_PID__c: ${state.data.form.case['@case_id']}`
              );
              return state;
            }

            return upsert(
              'Attendance__c',
              'CommCare_Ext_ID__c',
              fields(
                //field('Event__c', dataValue('form.hidden_properties.intervention_name')),

                // field('CommCare_Ext_ID__c', state => {
                //   const value =
                //     dataValue('form.case.@case_id')(state) +
                //     '-' +
                //     toUTF8(dataValue('form.hidden_properties.intervention_name')(state)).replace(/\//gi, '');
                //   return scrubEmojis(value, '');
                // }),
                field("CommCare_Ext_ID__c", (state) => {
                  return toUTF8(`${dataValue("form.case.@case_id")(state)}-${scrubEmojis(
                  dataValue("form.hidden_properties.intervention_name")(state),
                  ""
                  ).replace(/\//gi, "")}`);
                  }),

                //relationship('Event__r', 'CommCare_Ext_ID__c', dataValue('form.hidden_properties.intervention_name')),
                relationship('Person_Attendance__r', 'Participant_Identification_Number_PID__c', dataValue('form.case.@case_id')),
                field('Pre_Post_Completed__c', state => {
                  var done = dataValue('form.hidden_properties.post_questionnaire_complete')(state);
                  return done === 'Yes' ? true : done === 'No' ? false : undefined;
                }),
                field('Date_Post_Administered__c', dataValue('form.hidden_properties.date')),
                field('Post_1__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_1__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_2__c', state => {
                  if (state.pluckSfValue('Post_2__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_2__c'))(state);
                  return state.helperFunctions.transform(value);
                }),

                field('Post_3__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_3__c'))(state);
                  return state.helperFunctions.transform(value);
                }),

                field('Post_4__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_4__c'))(state);
                  return state.helperFunctions.transform(value);
                }),

                field('Post_5__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_5__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_6__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_6__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_7__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_7__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_8__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_8__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_9__c', state => {
                  const value = dataValue(state.pluckSfValue('Post_9__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_10__c', state => {
                  if (state.pluckSfValue('Post_10__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_10__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_11__c', state => {
                  if (state.pluckSfValue('Post_11__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_10__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_12__c', state => {
                  if (state.pluckSfValue('Post_12__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_12__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_13__c', state => {
                  if (state.pluckSfValue('Post_13__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_13__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_14__c', state => {
                  if (state.pluckSfValue('Post_14__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_14__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_15__c', state => {
                  if (state.pluckSfValue('Post_15__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_15__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_16__c', state => {
                  if (state.pluckSfValue('Post_16__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_16__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_17__c', state => {
                  if (state.pluckSfValue('Post_17__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_17__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_18__c', state => {
                  if (state.pluckSfValue('Post_18__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_18__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_19__c', state => {
                  if (state.pluckSfValue('Post_19__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_19__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_20__c', state => {
                  if (state.pluckSfValue('Post_20__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_20__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_21__c', state => {
                  if (state.pluckSfValue('Post_21__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_21__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_22__c', state => {
                  if (state.pluckSfValue('Post_22__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_22__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_23__c', state => {
                  if (state.pluckSfValue('Post_23__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_23__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_24__c', state => {
                  if (state.pluckSfValue('Post_24__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_24__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_25__c', state => {
                  if (state.pluckSfValue('Post_25__c') == null) return undefined;
                  const value = dataValue(state.pluckSfValue('Post_25__c'))(state);
                  return state.helperFunctions.transform(value);
                }),
                field('Post_26__c', state => {
                  if (state.pluckSfValue('Post_26__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Post_26__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Post_27__c', state => {
                  if (state.pluckSfValue('Post_27__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Post_27__c'))(state); 
                  return state.helperFunctions.transform(value);
                }),
                field('Post_28__c', state => {
                  if (state.pluckSfValue('Post_28__c') == null) return undefined
                  const value = dataValue(state.pluckSfValue('Post_28__c'))(state); 
                  return state.helperFunctions.transform(value);
                })     
              )
            )(state);
          });

          //Removing mapping... need case_id to upsert Events. Date_of_Post__c update should be handled on the SF side.
          /*upsert(
              'Event__c',
              'CommCare_Ext_ID__c',
              fields(
                field('CommCare_Ext_ID__c', dataValue('form.hidden_properties.intervention_name')),
                field('Date_of_Post__c', dataValue('form.date')),
              )
            );*/
    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->upsert-post-challenges:
        source_trigger: webhook
        target_job: upsert-post-challenges
        condition_type: always
        enabled: true
  PHQ9:
    name: PHQ9
    jobs:
      PHQ9:
        name: PHQ9
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          alterState(state => {
            function capitalizeFirstLetter(str) {
              if (!str) return;
              let new_str = str.toString().toLowerCase();
              return new_str.slice(0, 1).toUpperCase() + new_str.slice(1);
            }

            function transform(value) {
              if (!value) return;
              switch (value.toString().trim()) {
                case 'Daughterson':
                  return 'Daughter/Son';
                case 'Other_specify':
                  return 'Other';
                case 'Single_never_married':
                  return 'Single/Never Married';
                case 'Divorced__separated':
                  return 'Divorced/separated';
                default:
                  return value;
              }
            }

            function getAge(dateString) {
              if (!dateString) return;

              const today = new Date();
              const birthDate = new Date(dateString);
              var age = today.getFullYear() - birthDate.getFullYear();
              var m = today.getMonth() - birthDate.getMonth();
              if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                age--;
              }
              return age;
            }
            
            state.data.form.begin_interview.what_is_your_marital_status = state.data.form.begin_interview && state.data.form.begin_interview.what_is_your_marital_status  ? transform(
              capitalizeFirstLetter(state.data.form.begin_interview.what_is_your_marital_status) 
            ): undefined;

            state.data.form.begin_interview.position_of_respondent_in_the_household = state.data.form.begin_interview && state.data.form.begin_interview.position_of_respondent_in_the_household ? transform(
              capitalizeFirstLetter(state.data.form.begin_interview.position_of_respondent_in_the_household)
            ): undefined;

            state.helperFunctions = { getAge };
            return state;
          });

          upsert(
            'PHQ_9_Strong_Minds__c',
            'CommCare_Ext_ID__c',
            fields(
              field('CommCare_Ext_ID__c', dataValue('id')),
              
              // relationship('Intervention_Name__r', 'CommCare_Case_ID__c', state => {
              //   if (state.data.form.hidden_properties.intervention_id) return state.data.form.hidden_properties.intervention_id;
              //   else return "990221ac-3c05-475d-87c7-24d8a5fcb63e";
              // }),
              relationship('Intervention_Name__r', 'CommCare_Case_ID__c', dataValue('form.hidden_properties.intervention_id')),
              
              
              //relationship('Participant__r','CommCare_Ext_ID__c', dataValue('form.hidden_properties.participant_fullname')),
              field('Mobile_Contact_Information__c', dataValue('form.hidden_properties.mobile_number')),
              field('Curriculum__c', dataValue('form.hidden_properties.curriculum')),
              //field('Intervention__c', dataValue('form.hidden_properties.intervention')),
              field('Gender__c', dataValue('form.hidden_properties.gender')),
              field('Participant_Name__c', state => {
                const firstname = state.data.form.hidden_properties.participant_first_name;
                const lastname = state.data.form.hidden_properties.participant_surname;
                return firstname + ' ' + lastname;
              }),

              field('Coach_Name__c', dataValue('form.hidden_properties.coach_name')),
               relationship(
                'Venue2__r',
                'CommCare_Ext_ID__c',
                dataValue('form.hidden_properties.venue')
              ),    
              //field('Venue__c', dataValue('form.hidden_properties.venue')), replacing with the lookup
               relationship(
                'Site2__r',
                'CommCare_Ext_ID__c',
                dataValue('form.hidden_properties.site')
              ),
              //field('Site__c', dataValue('form.hidden_properties.site')), replacing with the lookup
              field('Interview_Date__c', dataValue('form.interview_date')),
              field('Resident_not_shifting_in_3_months_time__c', dataValue('form.full_time_resident')),
              field('Participant_DOB__c', state => {
                const dob  = dataValue('form.hidden_properties.date_of_birth')(state); 
                return dob ? dob : null; 
              }),
              //field('Area_Center__c', dataValue('form.hidden_properties.venue')), //Can get from Intervention
              field('Age_of_Participant__c', state => {
                const dob = dataValue('form.hidden_properties.date_of_birth')(state);

                return dob ? state.helperFunctions.getAge(dob) : null;
              }),
              
              
              field('Marital_Status__c', dataValue('form.begin_interview.what_is_your_marital_status')),
              field(
                'Position_of_Respondent_in_Household__c',
                dataValue('form.begin_interview.position_of_respondent_in_the_household')
              ),
              field('Q1_Little_interest_pleasure__c', dataValue('form.begin_interview.questions.little_interest')),
              field('Q2_Sad_Down_Depressed_Hopeless__c', dataValue('form.begin_interview.questions.depressed_sad_hopeless')),
              field('Q3_Trouble_sleeping__c', dataValue('form.begin_interview.questions.trouble_sleeping')),
              field('Q4_Feeling_tired__c', dataValue('form.begin_interview.questions.heavy_burden')),
              field('Q5_Appetite_problems__c', dataValue('form.begin_interview.questions.appetite_problems')),
              field('Q6_Failure_Worthless_Guilt__c', dataValue('form.begin_interview.questions.feeling_bad')),
              field('Q7_Trouble_concentrating__c', dataValue('form.begin_interview.questions.trouble_concentrating')),
              field('Q8_Trouble_in_speech__c', dataValue('form.begin_interview.questions.moving_slowly')),
              field('Q9_Suicidal_thoughts__c', dataValue('form.begin_interview.questions.thoughts_suicide'))
              //field('PHQ9_Total_Score__c', dataValue('form.begin_interview.questions.phq9_result.PHQ9_score'))
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->PHQ9:
        source_trigger: webhook
        target_job: PHQ9
        condition_type: js_expression
        condition_label: PHQ9
        condition_expression: |
          state.data.form["@name"] == "PHQ9" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Upsert-Service-Referral-2":
    name: '? Upsert Service Referral 2'
    jobs:
      Upsert-Service-Referral-2:
        name: Upsert Service Referral 2
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // push to production
          alterState(state => {
            state.data.external_commcare_id = (
              dataValue('form.hidden_properties.intervention_name')(state) +
              dataValue('form.hidden_properties.participant_first_name')(state) +
              dataValue('form.hidden_properties.participant_surname')(state)
            )
              .toString()
              .toLowerCase()
              .replace(/\s/g, '')
              .trim();

            return state;
          });

          upsert(
            'NewReferral__c',
            'CommCare_Ext_ID__c',
            fields(
              field('Business_Unit_Site__c', state => {
                const bu = dataValue('form.business_unit')(state);
                return bu === 'X' ? 'GRS Zambia' : bu;
              }),
              field('CommCare_Ext_ID__c', dataValue('form.case.@case_id')),
               field('HIV_Testing_Services_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option1')(state)
                )
              ),
              field('TB_Screening_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option2')(state)
                )
              ),
              field('VMMC_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option3')(state)
                )
              ),
              field('Post_Exposure_Prophylaxis_Service_Provid__c', state =>
                Boolean(
                  dataValue(
                    'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option4'
                  )(state)
                )
              ),
              field('PrEP_Service_Provider__c', state =>
                Boolean(
                  dataValue(
                    'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option5'
                  )(state)
                )
              ),
              field('HIV_STI_PREVENTION_Other_Service_Provid__c', state =>
                Boolean(
                  dataValue(
                    'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option6'
                  )(state)
                )
              ),
              field('ART_Initiation_Service_Provider__c', state =>
                Boolean(
                  dataValue('form.referral_services.art_support_services.art_services_group.art_services_option1')(
                    state
                  )
                )
              ),
              field('SKILLZ_Plus_Club_Support_Service_Provid__c', state =>
                Boolean(
                  dataValue('form.referral_services.art_support_services.art_services_group.art_services_option2')(
                    state
                  )
                )
              ),
              
              field(
                'PMTCT_Service_Provider__c',
                state =>
                  Boolean(
                    dataValue('form.referral_services.art_support_services.art_services_group.art_services_option3')(
                      state
                    )
                  )
              ), 
              field('IPTG_Health_Facility__c', state =>
                Boolean(
                  dataValue('form.referral_services.mental_health_services.confirmation_of_services_provided_label.mental_health_select_services_option1')(
                    state
                  )
                )
              ),    
              field('IPTG_Specialized_to_SMZ__c', state =>
                Boolean(
                  dataValue('form.referral_services.mental_health_services.confirmation_of_services_provided_label.mental_health_select_services_option2')(
                    state
                  )
                )
              ),   
              
                field('ART_Services_Other_Service_Provider__c', state =>
                  Boolean(
                    dataValue('form.referral_services.art_support_services.referred_art_support_services')(state)
                  )
                ),
                field(
                  'Victim_Friendly_Services_Service_Provide__c',
                  state =>
                    Boolean(
                      dataValue(
                        'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option1'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option2'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option3'
                      )(state)
                    )
                ),
                field('Legal_Services_Other_Service_Provider__c', state =>
                  Boolean(
                    dataValue(
                      'form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option3'
                    )(state)
                  )
                ),

              field('STI_Screen_Testing_Service_Provider__c', state =>
                  Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option1')(state))
                ),
              
              field('Contraception_Family_Plan_Servi_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option2')(state))
              ),
              field('Cervical_Cancer_Screen_Servi_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option3')(state))
              ),
              field('HPV_vaccine_Service_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option4')(state))
              ),
              field('Antenatal_Care_ANC_Service_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option5')(state))
              ),
              field('Sexual_and_GBV_Abuse_Servi_Provider__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option6')(state))
              ),
              field(
                  'Psycho_Social_Support_Service_Provider__c',
                  state =>
                    Boolean(
                      dataValue(
                        'form.referral_services.other_srhr_services.service_label.srhr_option9'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.other_srhr_services.service_label.srhr_option8'
                      )(state)
                    ) ||
                    Boolean(
                      dataValue(
                        'form.referral_services.other_srhr_services.service_label.srhr_option7'
                      )(state)
                    )
                ),
              field('Psycho_Social_Services_Other_Service_Pro__c', state =>
                Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option10')(state))
              ),
              field(
                  'Legal_Services_Other_Service_Provider__c',
                  state =>
                    Boolean(
                      dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_referral_services')(state)
                    ) ||
                    Boolean(
                      dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option1')(state)
                    ) ||
                    Boolean(
                      dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option2')(state)
                    )
                ),
              
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Upsert-Service-Referral-2:
        source_trigger: webhook
        target_job: Upsert-Service-Referral-2
        condition_type: js_expression
        condition_label: Service Referral Followup Name
        condition_expression: |
          state.data.form["@name"] == "Service Referral Followup" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Upsert-Attendance-Skillz-Plus-Club":
    name: '? Upsert Attendance Skillz Plus Club'
    jobs:
      Upsert-Attendance-Skillz-Plus-Club:
        name: Upsert Attendance Skillz Plus Club
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          query(
            `SELECT Participant_Identification_Number_PID__c from Person__c where Participant_Identification_Number_PID__c  = '${state.data.form.attendance_list.update_participant_cases.item[0]['@id']}'`
          );

          fn(state => {
            const PID = lastReferenceValue('records[0].Participant_Identification_Number_PID__c')(state);

            if (!PID) {
              console.log(
                `Participant not found with Participant_Identification_Number_PID__c: ${state.data.form.attendance_list.update_participant_cases.item[0]['@id']}`
              );
              return state;
            }
            return execute(
              // Set state.references to event record
              query(
                `SELECT Id, Name, CommCare_Ext_ID__c FROM Event__c WHERE CommCare_Case_ID__c = '${state.data.form.case['@case_id']}'`
              ),
              // Organise data and keep it safe
              fn(state => {
                function objectToArray(object) {
                  if (!object) return [];
                  return !Array.isArray(object) ? [object] : object;
                }

                const eventName = lastReferenceValue('records[0].CommCare_Ext_ID__c')(state);
                state.data.eventName = eventName;

                state.data.form.attendance_list.update_participant_cases.item = objectToArray(
                  state.data.form.attendance_list.update_participant_cases.item
                );

                state.data.form.attendance_list.update_participant_cases.item =
                  state.data.form.attendance_list.update_participant_cases.item.map(item => ({
                    ...item,
                    CommCare_Ext_ID__c: `${item['@id']}-${eventName}`,
                    event_case_id: state.data.form.case['@case_id'],
                  }));

                //  Keep our data safe
                state.items = state.data.form.attendance_list.update_participant_cases.item;

                // Reset references
                state.references = [];

                return state;
              }),
              // Set state.references to an array of attendance records for each participant
              beta.each(
                '$.items[*]',
                query(
                  state => `SELECT CommCare_Ext_ID__c, Session_1__c, Session_2__c, Session_3__c, Session_4__c, Session_5__c, Session_6__c, Session_7__c, Session_8__c, Session_9__c, Session_10__c, Session_11__c, Session_12__c, Session_13__c, Session_14__c, Session_15__c, Session_16__c, Session_17__c, Session_18__c, Session_19__c, Session_20__c, Session_21__c, Session_22__c, Session_23__c,Session_24__c, Session_25__c, Session_26__c, Session_27__c, Session_28__c
                   FROM Attendance__c
                   WHERE CommCare_Ext_ID__c = '${state.data.CommCare_Ext_ID__c}'
                   `
                )
              ),
              // Calculate dynamic fields
              fn(state => {
                state.items = state.items.map(item => {
                  const record = state.references.find(rec =>
                    rec.records[0] ? rec.records[0].CommCare_Ext_ID__c === item.CommCare_Ext_ID__c : true
                  ).records[0];

                  function getSessionValue(present) {
                    if (!present) return 'U';
                    switch (present.toString().toLowerCase()) {
                      case 'yes':
                        return 'X';
                      case 'no':
                        return 'A';
                      case '':
                        return 'N';
                      default:
                        return 'U';
                    }
                  }

                  function getSessionFieldName(record) {
                    if (!record || Object.keys(record).length === 0) {
                      return 'Session_1__c';
                    }

                    const fieldName = Object.entries(record)
                      .filter(rec => rec[1] === null && rec[0] !== 'CommCare_Ext_ID__c')
                      .sort(function (a, b) {
                        return a[0].split('_')[1] - b[0].split('_')[1];
                      })[0][0];

                    return fieldName;
                  }

                  const sessionValue = getSessionValue(item.attendance_session);
                  const sessionDate = item.date;
                  const sessionFieldName = getSessionFieldName(record);
                  const sessionDateFieldName = `Session_${sessionFieldName.split('_')[1]}_Date__c`;

                  return {
                    ...item,
                    dynamicFields: {
                      [sessionFieldName]: sessionValue,
                      [sessionDateFieldName]: sessionDate,
                    },
                  };
                });

                //  Reset state.references
                state.references = [];

                return state;
              }),

              // Upsert
              beta.each(
                '$.items[*]',
                upsert('Attendance__c', 'CommCare_Ext_ID__c', state => ({
                  ...fields(
                    field('CommCare_Ext_ID__c', dataValue('CommCare_Ext_ID__c')),
                    relationship('Person_Attendance__r', 'Participant_Identification_Number_PID__c', dataValue('@id')),
                    relationship('Event__r', 'CommCare_Case_ID__c', dataValue('event_case_id'))
                  ),
                  ...state.data.dynamicFields,
                }))
              )
            )(state);
          });

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Attendance-Skillz-Plus-Club:
        source_trigger: webhook
        target_job: Upsert-Attendance-Skillz-Plus-Club
        condition_type: js_expression
        condition_label: Attendance Skillz Plus Club
        condition_expression: |
          state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816" && state.data.form["skillz_attendance"] == "1"
        enabled: true
  Coach-Session-Register:
    name: Coach Session Register
    jobs:
      Coach-Session-Register:
        name: Coach Session Register
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // push to production
          query(
            `SELECT Coach_A__c, Coach_A__r.Name from Event__c where CommCare_Case_ID__c = '${state.data.form.case['@case_id']}'`
          );

          fn(state => {
            const present = dataValue('form.present')(state).toLowerCase();

            function getSessionValue() {
              let value;
              switch (present) {
                case 'yes':
                  value = 'X';
                  break;
                case 'no':
                  value = 'A';
                  break;
                case '':
                  value = 'N';
                  break;
                default:
                  value = 'U';
                  break;
              }
              return value;
            }

            const session_text = dataValue('form.session')(state);

            const session_id = session_text.trim().slice(0, session_text.indexOf(' ')).slice(1);
            console.log("session_id: ", session_id);

            const coachname = dataValue('form.coach_name')(state)
              ? dataValue('form.coach_name')(state)
              : state.references[0].records[0].Coach_A__r.Name;

            let external_id = `${dataValue('form.case.@case_id')(state)}
              ${coachname}`; //case_id + coach_name for external Id

            state.data.commcare_external_id = external_id.toLowerCase().replace(/\s/g, '').trim();

            state.data.dynamicFields = [
              field(`Session_${session_id}__c`, getSessionValue()),
              field(`Session_${session_id}_Date__c`, dataValue('form.date')(state)),
              //field(`Session_${session_id}_Duration__c`, dataValue('form.duration')(state)), //NOTE: Duration fields don't exist in SF?
            ];

            state.data.durationFields = [field(`Session_${session_id}_Duration__c`, dataValue('form.duration')(state))];
            console.log(state.data.durationFields);

            return state;
          });

          upsert('Event__c', 'CommCare_Case_ID__c', state => ({
            ...fields(field('CommCare_Case_ID__c', dataValue('form.case.@case_id'))),
            ...fields(...state.data.durationFields),
          }));

          query(
            `SELECT Coach_A__c, Coach_A__r.CommCare_Ext_ID__c from Event__c where CommCare_Case_ID__c = '${state.data.form.case['@case_id']}'`
          );

          fn(state => {
            const coaches = dataValue('form.coach_name')(state).split(' ');
            const dynamicFields = state.data.dynamicFields;
            const commcare_external_id = state.data.commcare_external_id;
            const caseid = state.data.form.case['@case_id'];
            return each(
              coaches,
              upsert('Attendance__c', 'CommCare_Ext_ID__c', state => ({
                ...fields(
                  //relationship('RecordType', 'Name', 'Coach Development'),
                  field('RecordTypeId', '012500000009jqaAAA'),
                  relationship('Event__r', 'CommCare_Case_ID__c', caseid),
                  relationship('Person_Attendance__r', 'CommCare_Ext_ID__c', state => {
                    const coach_name = state.data;
                    return coach_name;
                  }),
                  field('CommCare_Ext_ID__c', commcare_external_id)
                ),
                ...fields(...dynamicFields),
              }))
            )(state);
          });

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Coach-Session-Register:
        source_trigger: webhook
        target_job: Coach-Session-Register
        condition_type: js_expression
        condition_label: Coach Session Register
        condition_expression: |
          state.data.form["@name"] == "Coach Session Register" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  Upsert-Register-Participant:
    name: Upsert Register Participant
    jobs:
      Upsert-Register-Participant:
        name: Upsert Register Participant
        adaptor: '@openfn/language-salesforce@4.3.0'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          query(
            `SELECT Id, Name, CommCare_Ext_ID__c FROM Event__c WHERE CommCare_Case_ID__c = '${state.data.form.case['@case_id']}'`
          );

          fn(state => {
            // Note: lastReferenceValue selects the first item in the references array.
            state.data.eventName = lastReferenceValue('records[0].CommCare_Ext_ID__c')(state);
            state.data.eventCase = dataValue('form.case.@case_id')(state);

            function objectToArray(object) {
              return !Array.isArray(object) ? [object] : object;
            }

            const { form } = state.data;
            if (form.question1) {
              console.log('Ensuring that "question1" is an array.');
              form.question1 = objectToArray(form.question1);
            } else if (!form.new_participants) {
              console.log('Nothing to upsert. No participants were registered');
            } else {
              console.log('Shifting "new_participants" to "question1" array.');
              form.question1 = objectToArray(form.new_participants);
              console.log('Creating a "case" object inside each item in that array.');
              form.question1 = form.question1.map(item => ({
                ...item,
                case: item.create_skillz_plus_participant.case,
              }));
            }

            console.log('Done with initial data manipulation.');
            const persons = merge(
              dataPath('form.question1[*]'),
              fields(field('intervention_notes_to_save', dataValue('form.intervention_notes_to_save')))
            )(state);

            const attendances = merge(
              dataPath('form.question1[*]'),
              fields(
                field('intervention_name', dataValue('form.intervention_name')),
                field('eventCase', dataValue('eventCase')),
                field('eventName', dataValue('eventName'))
              )
            )(state);

            return { ...state, persons, attendances };
          });

          each(
            'persons[*]',
            upsert(
              'Person__c',
              'Participant_Identification_Number_PID__c',
              fields(
                field('Notes__c', dataValue('intervention_notes_to_save')),
                field('First_Name__c', dataValue('participant_first_name')),
                field('Surname__c', dataValue('participant_surname')),
                relationship('RecordType', 'Name', 'Participant'),
                relationship('Site__r', 'CommCare_Ext_ID__c', dataValue('grp_location.site_id')),
                field('Participant_Identification_Number_PID__c', state => state.data.case['@case_id']),
                field('Sex__c', dataValue('gender')),
                field('Mobile_Number_1__c', dataValue('mobile_number')), //QUESTION: In CommCare, phone doesn't look like it's saving?
                field('School_name_person__c', dataValue('school_name')),
                field('Date_of_Birth__c', dataValue('date_of_birth')),
                field('School_name_person__c', dataValue('school_name')),
                field('Physical_Address__c', dataValue('participants_home_address')),
                field('Age_1_0__c', dataValue('participants_age_to_save'))
              )
            )
          );

          each(
            'attendances[*]',
            upsert(
              'Attendance__c',
              'CommCare_Ext_ID__c',
              fields(
                field('CommCare_Ext_ID__c', state => {
                  const eventid = toUTF8(`${state.data.intervention_name}` || `${state.data.eventName}`); //dataValue('intervention_name')(state) || `${state.data.eventName}`;
                  const personid = state.data.case['@case_id'];
                  const value = personid + '-' + eventid.replace(/\//gi, '');
                  return scrubEmojis(value, '');
                }),
                relationship(
                  //Attendance looks up to Persn via the case_id
                  'Person_Attendance__r',
                  'Participant_Identification_Number_PID__c',
                  state => state.data.case['@case_id']
                ),
                relationship(
                  //Attendance looks up to Event via the Event case_id
                  'Event__r',
                  'CommCare_Case_ID__c',
                  state => `${state.data.eventCase}`
                ),
                // relationship(
                //   //Attendance looks up to Event via the intervention_name
                //   'Event__r',
                //   'CommCare_Ext_ID__c',
                //   state => `${state.data.intervention_name}` || `${state.data.eventName}`
                // ),
                field('Date_of_Birth__c', dataValue('date_of_birth'))
              )
            )
          );

          //First we insert Person record
          // fn(state => {
          //   return upsert(
          //     'Person__c',
          //     'Participant_Identification_Number_PID__c',
          //     fields(
          //       field('Notes__c', dataValue('form.intervention_notes_to_save')),
          //       field('First_Name__c', dataValue('form.question1.participant_first_name')),
          //       field('Surname__c', dataValue('form.question1.participant_surname')),
          //       relationship('RecordType', 'Name', 'Participant'),
          //       field('Participant_Identification_Number_PID__c', state => state.data.case['@case_id']),
          //       field('Sex__c', dataValue('form.question1.gender')),
          //       //field('Age__c', dataValue('form.question1.age_in_years')), //This is a SF formula field, cannot map
          //       field('Mobile_Number_1__c', dataValue('form.question1.mobile_number')),
          //       field('School_name_person__c', dataValue('form.question1.school_name'))
          //     )
          //   )(state);
          // });

          // fn(state => {
          //   //Then we upsert related Attendance records
          //   return upsert(
          //     'Attendance__c',
          //     'CommCare_Ext_ID__c',
          //     fields(
          //       field('CommCare_Ext_ID__c', state => {
          //         var eventid = dataValue('form.intervention_name')(state);
          //         var personid = dataValue('form.case.@case_id')(state);
          //         return personid + '-' + eventid;
          //       }),
          //       relationship(
          //         //Attendance looks up to Persn via the case_id
          //         'Person_Attendance__r',
          //         'Participant_Identification_Number_PID__c',
          //         dataValue('form.case.@case_id')
          //       ),
          //       relationship(
          //         //Attendance looks up to Event via the intervention_name
          //         'Event__r',
          //         'Name',
          //         dataValue('form.intervention_name')
          //       ),
          //       field('Date_of_Birth__c', dataValue('form.question1.date_of_birth'))
          //     )
          //   )(state);
          // });

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Register-Participant:
        source_trigger: webhook
        target_job: Upsert-Register-Participant
        condition_type: js_expression
        condition_label: Register Participant
        condition_expression: |
          state.data.form["@name"] == "Register Participant" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  1-Get-CommCare-Forms-Bulk-Extract:
    name: 1 Get CommCare Forms Bulk Extract
    jobs:
      1-Get-CommCare-Forms-Bulk-Extract:
        name: 1 Get CommCare Forms Bulk Extract
        adaptor: '@openfn/language-http@3.1.11'
        credential: rita@openfn.org-GRS-CommCare-Prod-with-Webhook-URLs
        body: |
          get(
            'https://www.commcarehq.org/a/grassrootsoccertrial/api/v0.5/form/',
            {
              query: {
                limit: 1000, //max limit: 1000
                offset: state.meta && state.meta.next ? state.meta.limit + state.meta.offset : 0,
                received_on_start: '2024-11-10',
                received_on_end: '2024-11-14',
                xmlns: 'http://openrosa.org/formdesigner/A3AF9DA6-1D57-46E4-8431-A5C262DC2DBA',
              },
            },
            state => {
              const { meta, objects } = state.data;
              // const { openfnInboxUrl } = state.configuration;
              const xmlnsList = [
                // `http://openrosa.org/formdesigner/6F130211-5A05-4915-8F55-A413A6B9D61B`, //Outcome Survey form
                // 'http://openrosa.org/formdesigner/40BBC9E3-C650-4F72-A027-235BF33D87AB', //Create Intervention form
                // 'http://openrosa.org/formdesigner/D50A9A33-B1B4-41B2-9ACA-15DBBDFBCF8C', //  My Team/Group Name form
                //'http://openrosa.org/formdesigner/D771417E-354E-4906-A686-DF0BA230F16A', // Register Participant form
                // 'http://openrosa.org/formdesigner/2B9F69A2-7E51-49F6-9FF9-F72F3EC14A9E', // Register Participant skillz
                // 'http://openrosa.org/formdesigner/304CABA9-C8A8-4360-83C6-5E2EC1D2C2AC', // Intervention notes
                //'http://openrosa.org/formdesigner/56DB98AC-67EC-4BBA-91FC-9443E84E43CE', //PHQ9
                //  'http://openrosa.org/formdesigner/5E2E3990-2C3C-42F5-BE0B-922ED29939C4', // ART Adherence Self-Reporting Tool
                //  'http://openrosa.org/formdesigner/4CFAC371-88F7-4349-BEB2-3DA2BDE445EA', //Malaria Testing Event Snapshot
                // 'http://openrosa.org/formdesigner/FAF8F169-0FF1-4DE4-98B7-E4450BECBC84', //Malaria Testing Event Statistics
                // 'http://openrosa.org/formdesigner/E31B9126-1DCA-4603-AD57-271A843448B3', //Register Skillz Plus Club
                //'http://openrosa.org/formdesigner/5D8455CE-6044-471D-83BB-131A3D52794B', // Service Referral Followup -> confirm services received
                // 'http://openrosa.org/formdesigner/0B3DD3B4-A767-4671-A63C-8A352DAA8E2D', // service referral followup
                //'http://openrosa.org/formdesigner/59E1207B-969F-402D-9EEE-675504036F78', //Home Visit log form
                // 'http://openrosa.org/formdesigner/3B4B1C64-092A-4922-B033-94D80A11D960', // Coach Session Register form
                //  'http://openrosa.org/formdesigner/41DF97A0-0E4B-460D-B983-13D404565009', //HIV Testing Event Snapshot
                //  'http://openrosa.org/formdesigner/EAA0ABBB-C517-4E7F-82A9-5799E944FE52', //HIV Testing Event Statistics
                // 'http://openrosa.org/formdesigner/EA6C0348-91F7-44FC-8786-B34F50B0CB62', //Register Event
                // 'http://openrosa.org/formdesigner/34DD6DFD-13E7-4E19-8A27-F18B6D39E12E', //Attendance
                //'http://openrosa.org/formdesigner/F55C4DF9-0CCD-4AED-A5C4-1E39ED2E45C4', //Attendance skillz plus club
                //  'http://openrosa.org/formdesigner/A3AF9DA6-1D57-46E4-8431-A5C262DC2DBA', // Pre Challenges
                // 'http://openrosa.org/formdesigner/D2F0F23F-9C0E-41E7-9C46-7553F8B5DCC8', // Post Challenges
                //'http://openrosa.org/formdesigner/0DAB6FD9-A7C1-4F56-A1C8-794B7C123F95', // Service Referral
                // 'http://openrosa.org/formdesigner/98041DA3-B37D-4E8E-A9B9-29EDC036A46A', // Aggregate Service Referrals
                // 'http://openrosa.org/formdesigner/50A337EB-FBD8-4607-A664-21AAE51DFCD1', // Coach Support Visit form
                // 'http://openrosa.org/formdesigner/AA396157-EBF9-4B51-B25A-D5BDA4F3DF73', // Coach Support Visit form Zambia
                // 'http://openrosa.org/formdesigner/3FFDCE4F-35A9-4FA9-971F-EFFDC94E597F', //Risk & vulnerability assessment
                //'http://openrosa.org/formdesigner/3DAF13EC-FA77-4480-8946-667D841B439A', //risk & vulnerability assessment | new Referrals
              ];

              // const forms = objects.filter(obj => xmlnsList.includes(obj.form['@xmlns']));
              

              // const { meta, objects } = state.data.body;
              //  const webhookUrl  = state.configuration.attendanceNonSkillzWebhookUrl;
              //   const { webhookUrl } = state.configuration.coachSessionRegisterWebhookUrl;
                // const { webhookUrl } = state.configuration.createInterventionWebhookUrl;
                // const { webhookUrl } = state.configuration.upsertInterventionNotesWebhookUrl;
                // const { webhookUrl } = state.configuration.upsertRegisterParticipantWebhookUrl;
                // const { webhookUrl } = state.configuration.upsertPreChallengesWebhookUrl;
                // const { webhookUrl } = state.configuration.upsertPostChallengesWebhookUrl;
                // const { webhookUrl } = state.configuration.hivTestingEventStatisticsWebhookUrl;
                // const { webhookUrl } = state.configuration.outcomeSurveyWebhookUrl;
                // const { webhookUrl } = state.configuration.PHQ9WebhookUrl;
                // const { webhookUrl } = state.configuration.upserHomeVisitLogFormWebhookUrl;
                // const { webhookUrl } = state.configuration.upsertRegisterEventWebhookUrl;
                // const { webhookUrl } = state.configuration.riskAndVulnerabilityWebhookUrl;
                // const { webhookUrl } = state.configuration.upsertServiceReferralWebhookUrl;
                // const { webhookUrl } = state.configuration.upsertTeamOrGroupNameWebhookUrl;

              const forms = objects;

              console.log('Posting form submissions to OpenFn Webhook...');

              return each(forms, state => {
                
                return post(`${webhookUrl}`, { body: state.data }, state => ({
                  ...state,
                  data: {},
                  references: [],
                }))(state);
              })(state);
            }
          );
          //ALL form xmlns codes
          //xmlns: 'http://openrosa.org/formdesigner/D50A9A33-B1B4-41B2-9ACA-15DBBDFBCF8C', //  My Team/Group Name form
          //xmlns: 'http://openrosa.org/formdesigner/D771417E-354E-4906-A686-DF0BA230F16A', // Register Participant form
          //xmlns: 'http://openrosa.org/formdesigner/2B9F69A2-7E51-49F6-9FF9-F72F3EC14A9E', // Register Participant skillz
          //xmlns: 'http://openrosa.org/formdesigner/304CABA9-C8A8-4360-83C6-5E2EC1D2C2AC', // Intervention notes
          //xmlns: 'http://openrosa.org/formdesigner/304CABA9-C8A8-4360-83C6-5E2EC1D2C2AC', // Intervention Notes form
          //xmlns: 'http://openrosa.org/formdesigner/AA396157-EBF9-4B51-B25A-D5BDA4F3DF73', // Coach Support Visit form Zambia
          //xmlns: 'http://openrosa.org/formdesigner/50A337EB-FBD8-4607-A664-21AAE51DFCD1', // Coach Support Visit form
          //xmlns: 'http://openrosa.org/formdesigner/3B4B1C64-092A-4922-B033-94D80A11D960', // Coach Session Register form
          //xmlns: 'http://openrosa.org/formdesigner/34DD6DFD-13E7-4E19-8A27-F18B6D39E12E', //Attendance
          //xmlns: 'http://openrosa.org/formdesigner/4CFAC371-88F7-4349-BEB2-3DA2BDE445EA', //Malaria Testing Event Snapshot
          //xmlns: 'http://openrosa.org/formdesigner/59E1207B-969F-402D-9EEE-675504036F78', //Home Visit log form
          //xmlns: 'http://openrosa.org/formdesigner/41DF97A0-0E4B-460D-B983-13D404565009', //HIV Testing Event Snapshot
          //xmlns: 'http://openrosa.org/formdesigner/551BCED9-077B-40EE-849D-0416756B9A75', // PHQ9
          //xmlns: 'http://openrosa.org/formdesigner/0DAB6FD9-A7C1-4F56-A1C8-794B7C123F95', // Service Referral
          //xmlns: 'http://openrosa.org/formdesigner/0B3DD3B4-A767-4671-A63C-8A352DAA8E2D', // Service Referral Followup
          //xmlns: 'http://openrosa.org/formdesigner/98041DA3-B37D-4E8E-A9B9-29EDC036A46A', // Aggregate Service Referrals
          //xmlns: 'http://openrosa.org/formdesigner/5E2E3990-2C3C-42F5-BE0B-922ED29939C4', // ART Adherence Self-Reporting Tool
          //xmlns: 'http://openrosa.org/formdesigner/A3AF9DA6-1D57-46E4-8431-A5C262DC2DBA', // Pre Challenges
          //xmlns: 'http://openrosa.org/formdesigner/D2F0F23F-9C0E-41E7-9C46-7553F8B5DCC8', // Post Challenges
          //xmlns: 'http://openrosa.org/formdesigner/FAF8F169-0FF1-4DE4-98B7-E4450BECBC84', // Malaria Testing Event Statistics
          //xmlns: 'http://openrosa.org/formdesigner/EA6C0348-91F7-44FC-8786-B34F50B0CB62', //Register Event
          //xmlns: 'http://openrosa.org/formdesigner/EAA0ABBB-C517-4E7F-82A9-5799E944FE52', //HIV Testing Event Statistics

    triggers:
      cron:
        type: cron
        cron_expression: '0 0 * * *'
        enabled: false
    edges:
      cron->1-Get-CommCare-Forms-Bulk-Extract:
        source_trigger: cron
        target_job: 1-Get-CommCare-Forms-Bulk-Extract
        condition_type: always
        enabled: true
  Upsert-Register-Event:
    name: Upsert Register Event
    jobs:
      Upsert-Register-Event:
        name: Upsert Register Event
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          alterState((state) => {
            
            function clean(str) {
              if (!!str)
                return str
                  .split('_')
                  .map(word => {
                    let new_word = word.toString().toLowerCase();
                    return new_word.slice(0, 1).toUpperCase() + new_word.slice(1);
                  })
                  .join(' ');
            }
            
            const coachFieldNames = ['Coach_A__r','Coach_B__r','Coach_C__r','Coach_D__r']
           
            state.data.destinationCoachFields = state.data.form.event_information.coaches
            .split(' ')
            .reduce(
              (accumulator, currentValue, currentIndex) => [
                ...accumulator,
                (currentIndex < coachFieldNames.length && !!currentValue
                  ? relationship(coachFieldNames[currentIndex], 'CommCare_Ext_ID__c', currentValue)
                  : []),
              ],
              []
            );
            
            const eventtype = state.data.form.event_information.event_type; 
            
            const recordtype = eventtype==='community_health_event' || eventtype==='soccer_tournament' ? 'Testing Event' : 'Malaria Testing Event'; 
            console.log(recordtype)
            
            state.data.recordtype = recordtype; 
            
            return state; 
          }); 

          upsert(
            'Event__c',
            'CommCare_Case_ID__c',
            state=>({
            ...fields(
              field('Name', dataValue('form.event_information.Event_Name')),
              relationship('RecordType', 'Name', dataValue('recordtype')),
              field('CommCare_Ext_ID__c', state => {
                var event = dataValue('form.event_information.Event_Name')(state);
                return event ? event.replace(/\//gi, '') : event;
                }),
              field('CommCare_Case_ID__c', dataValue('form.case.@case_id')),
              field('Business_Unit__c', state => {
                const bu = dataValue('form.event_information.business_unit')(state); 
                return bu==='65680f0c4c144b03ad0f86bdc46c1ebc' ? 'GRS Zambia' : 
                bu==='04d98397e28046118fade28ced6b65cb' ? 'GRS Zimbabwe' : 
                bu==='ed125ab19ec34aacab79585e59eb76f4' ? 'GRS Partnerships': undefined ; 
              }),
              relationship('Site__r','CommCare_Ext_ID__c', dataValue('form.event_information.site')),
              relationship('Venue__r', 'CommCare_Ext_ID__c',dataValue('form.event_information.Venue')),
              field('Date__c', dataValue('form.event_information.event_date')),
              field('Event_Type__c', dataValue('recordtype')),
              field('Testing_Event_Type__c', state => {
                const type = dataValue('form.event_information.event_type')(state); 
                return type.includes('malaria') ? 'Malaria Testing Event (General Event)' : 'Other';
              }),
              field('Coordinator__c', dataValue('form.event_information.event_coordinator')),
            ),
            ...fields(...state.data.destinationCoachFields)
            })
          );

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Register-Event:
        source_trigger: webhook
        target_job: Upsert-Register-Event
        condition_type: js_expression
        condition_label: Register Event
        condition_expression: |
          state.data.form["@name"] == "Register Event" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  Upsert-Risk-and-Vulnerability-Assessment---Service-Referral:
    name: Upsert Risk and Vulnerability Assessment - Service Referral
    jobs:
      Upsert-Risk-and-Vulnerability-Assessment---Service-Referral:
        name: Upsert Risk and Vulnerability Assessment - Service Referral
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // Your job goes here.
          alterState(state => {
            function split(str, separator) {
              if (!str) {
                return [];
              } else {
                return str.toString().split(separator);
              }
            }
            function checked(key, str) {
              if (!str) return false;
              return split(str.toString(), ' ').indexOf(key) >= 0;
            }

            function capitalizeFirstLetter(str) {
              if (!str) return;
              let new_str = str.toString().toLowerCase();
              return new_str.slice(0, 1).toUpperCase() + new_str.slice(1);
            }

            function transformDont(str) {
              if (!str) return str;
              return split(str.toString(), '_')
                .map(word => word.replace(/dont/i, "don't"))
                .join('_')
                .toString()
                .trim();
            }

            function transformCant(str) {
              if (!str) return str;
              return split(str.toString(), '_')
                .map(word => word.replace(/cant/i, "can't"))
                .join('_')
                .toString()
                .trim();
            }

            function splitAndJoin(str, splitDelimiter, joinDelimiter) {
              if (!str) return;

              return split(str.toString(), splitDelimiter).join(joinDelimiter).toString().trim();
            }

            function transformHowOften(str) {
              if (!str) return;
              if (str === 'special_occasions') return 'Special Occasions';
              if (str === 'no_dont_want_to_disclose') return "Don't want to disclose";
              if (str === 'dont_want_to_disclose') return "Don't want to disclose";
              return transformGenericText(str).toString().trim();
            }

            function transformHIVStatus(status) {
              switch (status) {
                case 'yes_negative':
                  return 'Yes,Negative';
                case 'yes_positive':
                  return 'Yes,Positive';
                case 'no_i_dont':
                  return "No,I don't know";
                case 'yes_dont_want_to_disclose':
                  return "Yes, don't want to disclose";
                default:
                  return;
              }
            }

            function transformLastTested(str) {
              if (!str) return;
              switch (str.toString()) {
                case 'yes_negative':
                  return 'Yes,Negative';
                case 'yes_positive':
                  return 'Yes,Positive';
                case 'no_i_dont':
                  return "No,I don't know";
                case 'yes_dont_want_to_disclose':
                  return "Yes, don't want to disclose";
                default:
                  return;
              }
            }

            function transformMonthAgo(str) {
              if (!str) return;
              switch (str) {
                case 'month_ago':
                  return '1 month ago';
                case 'months_ago':
                  return '3 months ago';
                case 'month_ago':
                  return 'copy-1-of-months_ago ';
                case 'month_ago':
                  return '6 months ago';
                case 'a_year_or_more_ago':
                  return 'A year or more';
                default:
                  return;
              }
            }

            function transformGenericText(str) {
              if (!str) return;
              return capitalizeFirstLetter(splitAndJoin(transformDont(str), '_', ' '))
                .toString()
                .trim();
            }

            function transformRange(range) {
              if (!range) return;
              return range
                .toString()
                .replace(/\d_\d/i, match => match.replace('_', '-'))
                .toString()
                .trim();
            }

            function transformAgeRange(range) {
              if (!range) return;
              if (range === '10_years') return '< 10 years';
              if (range === 'greater_than_19') return '> 19 years';
              return capitalizeFirstLetter(transformDont(transformCant(splitAndJoin(transformRange(range), '_', ' '))))
                .toString()
                .trim();
            }

            function transformAbuseExperienced(str) {
              if (!str) return;
              return split(str, ' ')
                .map(word => capitalizeFirstLetter(word))
                .join(';')
                .toString()
                .trim();
            }

            function getAge(dateString) {
              if (!dateString) return;

              const today = new Date();
              const birthDate = new Date(dateString);
              var age = today.getFullYear() - birthDate.getFullYear();
              var m = today.getMonth() - birthDate.getMonth();
              if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                age--;
              }
              return age;
            }

            state.data.perform_a_risk_assessment = state.data.form.do_you_want_to_perform_a_risk_assessment === 'yes';

            state.data.complete_service_referrals = state.data.form.referral_services ? true : false;

            state.data.form.client_information.gender = capitalizeFirstLetter(state.data.form.client_information.gender);

            state.helperFunctions = {
              split,
              checked,
              transformAgeRange,
              transformHIVStatus,
              transformLastTested,
              transformMonthAgo,
              transformGenericText,
              transformDont,
              splitAndJoin,
              transformHowOften,
              transformAbuseExperienced,
              getAge,
            };
            return state;
          });

          upsertIf(
            dataValue('perform_a_risk_assessment'),
            'Risk_Assessment__c',
            'CommCare_Ext_ID__c',
            fields(
              field('CommCare_Ext_ID__c', dataValue('id')),
              field('Date__c', dataValue('form.risk_assessment.date')),
              field('Participant_Name__c', dataValue('form.client_information.participant_full_name')),
              field('Participant_Age__c', state => {
                const dob = dataValue('form.client_information.date_of_birth')(state);

                return state.helperFunctions.getAge(dob);
              }),
              relationship('Site2__r', 'CommCare_Ext_ID__c', dataValue('form.client_information.site')),
              relationship('EventLink__r', 'CommCare_Ext_ID__c', dataValue('form.client_information.intervention_name')),
              relationship('Venue__r', 'CommCare_Ext_ID__c', dataValue('form.client_information.venue')),

              field('Participant_Sex__c', dataValue('form.client_information.gender')),
              field('X1_0_Sexually_Active_past_12_month__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.risk_assessment.sexual_risk_and_pregnancy.sexually_active_12_months')(state)
                )
              ),
              field('X1_1_Age_at_first_sex__c', state =>
                state.helperFunctions.transformAgeRange(
                  dataValue('form.risk_assessment.sexual_risk_and_pregnancy.age_at_first_sex')(state)
                )
              ),
              field('X1_2_Have_you_ever_had_unprotected_sex__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.risk_assessment.sexual_risk_and_pregnancy.have_you_ever_had_unprotected_sex')(state)
                )
              ),
              field('X1_3_Sex_for_monetary_or_material_benefi__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.risk_assessment.sexual_risk_and_pregnancy.sex_monetary_material')(state)
                )
              ),
              field('Do_you_know_your_HIV_status__c', state =>
                state.helperFunctions.transformHIVStatus(
                  dataValue('form.risk_assessment.hiv_status.do_you_know_your_hiv_status')(state)
                )
              ),
              field('X2_1_When_last_did_you_test_for_HIV__c', state =>
                state.helperFunctions.transformMonthAgo(
                  dataValue('form.risk_assessment.hiv_status.when_last_did_you_test_for_hiv')(state)
                )
              ),
              field('X2_2_Are_you_on_treatment_ART__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.risk_assessment.hiv_status.are_you_on_treatment_art')(state)
                )
              ),
              field('X3_0_Had_an_STI_in_the_last_12months_yea__c', state =>
                state.helperFunctions.transformHowOften(dataValue('form.risk_assessment.sti_and_pep.hiv_last_12_months')(state))
              ),
              field('X3_1_Past_12_months_sex_HIV_status_part__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.risk_assessment.sti_and_pep.knowing_partners_hiv_status')(state)
                )
              ),
              field('X4_0_Forms_of_abuse_experienced_before__c', state => {
                const abusesArray = state.helperFunctions.split(
                  dataValue('form.risk_assessment.gender_based_violence.abuse_experienced')(state),
                  ' '
                );
                const abuses = [];
                abusesArray.forEach(ab => {
                  abuses.push(state.helperFunctions.transformGenericText(ab));
                });
                return abuses.join(';');
              }),
              field('X4_1_Feel_unsafe_any1_interact_with_ofte__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.risk_assessment.gender_based_violence.unsafe_with_others')(state)
                )
              ),
              field('X4_2_Of_what_relationship_person_to_you__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.risk_assessment.gender_based_violence.relationship_of_abuser')(state)
                )
              ),
              field('X5_0_Do_you_take_alcohol_or_drugs__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.risk_assessment.drugs_and_alcohol_use.do_you_take_alcohol_andor_drugs')(state)
                )
              ),
              field('X5_1_On_average_how_often_drink_alcohol__c', state =>
                state.helperFunctions.transformHowOften(
                  dataValue('form.risk_assessment.drugs_and_alcohol_use.how_often_alcohol')(state)
                )
              ),
              field('X5_2_On_average_how_often_take_drugs__c', state =>
                state.helperFunctions.transformHowOften(
                  dataValue('form.risk_assessment.drugs_and_alcohol_use.how_often_drugs')(state)
                )
              ),
              field('X5_3_Easy_for_teens_to_obtain_alcohol__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.risk_assessment.drugs_and_alcohol_use.alcohol_19')(state)
                )
              ),
              field('X5_4__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.risk_assessment.drugs_and_alcohol_use.illegal_drugs_19')(state)
                )
              )
            )
          );

          fn(state => {
            state.data.intervention_name = state.data.form.client_information.intervention_name
              ? [relationship('Event__r', 'CommCare_Ext_ID__c', dataValue('form.client_information.intervention_name'))]
              : [];

            return state;
          });

          upsertIf(
            state => {
              const referralServices = state.data.form.referral_services;
              return (
                referralServices &&
                (parseInt(referralServices.art_support_services.count_of_art_support_services) > 0 ||
                 parseInt(referralServices.child_protection_support_services.count_child_protection_support_services) > 0 ||
                 parseInt(referralServices.hiv_support__care.count_of_hiv_support_care) > 0 ||
                 parseInt(referralServices.legal_services.count_legal_services) > 0 ||
                 parseInt(referralServices.mental_health_services.count_mental_health_services) > 0)
              );
            }, 'NewReferral__c', 'CommCare_Ext_ID__c', state => ({
            ...fields(
              field('CommCare_Ext_ID__c', state => {
                if (state.data.form.subcase_0.case) return state.data.form.subcase_0.case['@case_id'];
                else if (state.data.form.referral_services) {
                  if (state.data.form.referral_services.art_support_services.skillz_plus_club_details)
                    return state.data.form.referral_services.art_support_services.skillz_plus_club_details
                      .create_skillz_plus_club_participant_case.case['@case_id'];
                }
                return undefined;
              }),
              field('Participants_Full_Name__c', dataValue('form.client_information.participant_full_name')),
              field('Service_Provider_Name__c', dataValue('form.client_information.coach_name')),
              field('Parent_Guardian_Full_Name__c', dataValue('form.parent__guardian_information.parent__guardian_full_name')),
              field('Relationship__c', dataValue('form.parent__guardian_information.relationship_to_client')),
              //field('', dataValue('form.parent__guardian_information.please_specify')),
              field('Parent_Guardian_Contact_Number__c', dataValue('form.parent__guardian_information.contact_number')),
              //field('', dataValue('form.parent__guardian_information.guardian_consent')),
              field('Institution_Referred_To_1__c', dataValue('form.referral_information.institution_referred_to')),
              field('Institution_Referred_To_2__c', dataValue('form.referral_information.copy-1-of-institution_referred_to')),
              field('Institution_Referred_To_3__c', dataValue('form.referral_information.copy-2-of-institution_referred_to')),
              field('HIV_Testing_Services_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'hiv_testing_services',
                  dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('HIV_Other__c', dataValue('form.referral_services.hiv_support__care.please_specify')),
              field('ART_Initiation_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'art_initiationenrollment',
                  dataValue('form.referral_services.art_support_services.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('SKILLZ_Plus_Club_Support_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'grs_skillz_plus_club',
                  dataValue('form.referral_services.art_support_services.skillz_plus_club_option')(state)
                )
              ),
              field('PMTCT_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'pmtct',
                  dataValue('form.referral_services.art_support_services.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('VMMC_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'vmmc',
                  dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('TB_Screening_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'tb_screening_treatment_adherence',
                  dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('Legal_Other__c', dataValue('form.referral_services.legal_services.please_specify_other_legal')),
              field('Post_Exposure_Prophylaxis_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'post_exposure_prophylaxis',
                  dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('PrEP_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'prep',
                  dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('HIV_STI_PREVENTION_Other_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'other',
                  dataValue('form.referral_services.hiv_support__care.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('HIV_Other__c', dataValue('form.referral_services.hiv_support__care.please_specify')),
              field(
                'Victim_Friendly_Services_GRS_Staff__c',
                state =>
                  state.helperFunctions.checked(
                    'suspected_abuse_reported_police_court_other_authority',
                    dataValue(
                      'form.referral_services.child_protection_support_services.check_the_services_that_client_was_referred_to'
                    )(state)
                  ) ||
                  state.helperFunctions.checked(
                    'post_violence_care_medical_legal_counseling',
                    dataValue(
                      'form.referral_services.child_protection_support_services.check_the_services_that_client_was_referred_to'
                    )(state)
                  ) ||
                  state.helperFunctions.checked(
                    'child_support_grant_social_foster_general_support',
                    dataValue(
                      'form.referral_services.child_protection_support_services.check_the_services_that_client_was_referred_to'
                    )(state)
                  ) ||
                  state.helperFunctions.checked(
                    'other',
                    dataValue(
                      'form.referral_services.child_protection_support_services.check_the_services_that_client_was_referred_to'
                    )(state)
                  )
              ),

              field('Sexual_and_GBV_Abuse_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'sexual__gender-based_violenceabus',
                  dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                )
              ),

              // field('missing in SF', dataValue('form.referral_services.child_protection_support_services.type_of_post_violence_care')),
              // field('missing in SF', dataValue('form.referral_services.child_protection_support_services.child_support_grant_for')),
              field(
                'Legal_Services_Other_GRS_Staff__c',
                state =>
                  state.helperFunctions.checked(
                    'other',
                    dataValue('form.referral_services.legal_services.legal_services')(state)
                  ) ||
                  state.helperFunctions.checked('id', dataValue('form.referral_services.legal_services.legal_services')(state)) ||
                  state.helperFunctions.checked(
                    'birth_bertificate',
                    dataValue('form.referral_services.legal_services.legal_services')(state)
                  )
              ),
              field('Legal_Other__c', dataValue('form.referral_services.legal_services.please_specify_other_legal')),
              field('IPTG_Health_Facility__c', state =>
                state.helperFunctions.checked(
                  'iptg_to_health_facility',
                  dataValue('form.referral_services.mental_health_services.mental_health_select_services')
                )
              ),
              field('IPTG_Specialized_to_SMZ__c', state =>
                state.helperFunctions.checked(
                  'iptg_specialised_to_smz',
                  dataValue('form.referral_services.mental_health_services.mental_health_select_services')
                )
              ),
              field('STI_Screen_Testing_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'sti_screening_diagnosis_treatment',
                  dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('Contraception_Family_Plan_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'contraceptivesfamily_planning',
                  dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('Cervical_Cancer_Screening_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'cervical_cancer_screening',
                  dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('HPV_vaccine_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'hpv',
                  dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('Antenatal_Care_ANC_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'antenatal_care_anc',
                  dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                )
              ),

              field(
                'Psycho_Social_Support_GRS_Staff__c',
                state =>
                  state.helperFunctions.checked(
                    'drug_or_alcohol_abuse',
                    dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                  ) ||
                  state.helperFunctions.checked(
                    'psychiatric_careintensive_counseling',
                    dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                  ) ||
                  state.helperFunctions.checked(
                    'psychosocial_support',
                    dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                  )
              ),
              field('Psycho_Social_Services_Other_GRS_Staff__c', state =>
                state.helperFunctions.checked(
                  'other',
                  dataValue('form.referral_services.other_srhr_services.check_the_services_that_client_was_referred_to')(state)
                )
              ),
              field('Psycho_Other__c', dataValue('form.referral_services.other_srhr_services.please_specify_srhr_referred')),

              field('Date_Referred__c', dataValue('form.follow-up.date_referred')),
              field('Expected_Visit_Date__c', dataValue('form.follow-up.expected_visit_date')),
              field('Client_Follow_up_Consent_given__c', state =>
                state.helperFunctions.checked('client_follow-up_consent_given', dataValue('form.follow-up.select')(state))
              ),
              field('Client_Linked_to_care__c', state =>
                state.helperFunctions.checked('client_linked_to_care', dataValue('form.follow-up.select')(state))
              ),

              field('Business_Unit_Site__c', state => {
                const bu = dataValue('form.client_information.business_unit')(state);
                return bu === '65680f0c4c144b03ad0f86bdc46c1ebc'
                  ? 'GRS Zambia'
                  : bu === '04d98397e28046118fade28ced6b65cb'
                  ? 'GRS Zimbabwe'
                  : bu === 'ed125ab19ec34aacab79585e59eb76f4'
                  ? 'GRS Partnerships'
                  : bu === '26ed0b3dfc7d4dd09be5182c18fc0638'
                  ? 'GRS South Africa'
                  : undefined;
              })
            ),
            ...fields(...state.data.intervention_name),
          }));

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Risk-and-Vulnerability-Assessment---Service-Referral:
        source_trigger: webhook
        target_job: Upsert-Risk-and-Vulnerability-Assessment---Service-Referral
        condition_type: js_expression
        condition_label: 'Risk & Vulnerability Assessment | Service Referral'
        condition_expression: |
          state.data.form["@name"] == "Risk & Vulnerability Assessment | Service Referral - Treatment, Care and Support" && state.data.form["client_information"]["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Risk-and-Vulnerability-Assessment":
    name: '? Risk and Vulnerability Assessment'
    jobs:
      Risk-and-Vulnerability-Assessment:
        name: Risk and Vulnerability Assessment
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // Your job goes here. Testing github
          alterState(state => {
            function checked(key, str) {
              if (!str) return false;
              return str.toString().split(' ').indexOf(key) >= 0;
            }

            function capitalizeFirstLetter(str) {
              if (!str) return;
              let new_str = str.toString().toLowerCase();
              return new_str.slice(0, 1).toUpperCase() + new_str.slice(1);
            }

            function transformDont(str) {
              if (!str) return str;
              return str
                .toString()
                .split('_')
                .map(word => word.replace(/dont/i, "don't"))
                .join('_')
                .toString()
                .trim();
            }

            function transformCant(str) {
              if (!str) return str;
              return str
                .toString()
                .split('_')
                .map(word => word.replace(/cant/i, "can't"))
                .join('_')
                .toString()
                .trim();
            }

            function splitAndJoin(str, splitDelimiter, joinDelimiter) {
              if (!str) return;

              return str.toString().split(splitDelimiter).join(joinDelimiter).toString().trim();
            }

            function transformHowOften(str) {
              if (!str) return;
              if (str === 'special_occasions') return 'Special Occasions';
              return transformGenericText(str).toString().trim();
            }

            function transformHIVStatus(status) {
              switch (status) {
                case 'yes_negative':
                  return 'Yes,Negative';
                case 'yes_positive':
                  return 'Yes,Positive';
                case 'no_i_dont':
                  return "No,I don't know";
                case 'yes_dont_want_to_disclose':
                  return "Yes, don't want to disclose";
                default:
                  return;
              }
            }

            function transformLastTested(str) {
              if (!str) return;
              switch (str.toString()) {
                case 'yes_negative':
                  return 'Yes,Negative';
                case 'yes_positive':
                  return 'Yes,Positive';
                case 'no_i_dont':
                  return "No,I don't know";
                case 'yes_dont_want_to_disclose':
                  return "Yes, don't want to disclose";
                default:
                  return;
              }
            }

            function transformMonthAgo(str) {
              if (!str) return;
              switch (str) {
                case 'month_ago':
                  return '1 month ago';
                case 'months_ago':
                  return '3 months ago';
                case 'month_ago':
                  return 'copy-1-of-months_ago ';
                case 'month_ago':
                  return '6 months ago';
                case 'a_year_or_more_ago':
                  return 'A year or more';
                default:
                  return;
              }
            }

            function transformGenericText(str) {
              if (!str) return;
              return capitalizeFirstLetter(splitAndJoin(transformDont(str), '_', ' '))
                .toString()
                .trim();
            }

            function transformRange(range) {
              if (!range) return;
              return range
                .toString()
                .replace(/\d_\d/i, match => match.replace('_', '-'))
                .toString()
                .trim();
            }

            function transformAgeRange(range) {
              if (!range) return;
              if (range === '10_years') return '< 10 years';
              if (range === 'greater_than_19') return '> 19 years';
              return capitalizeFirstLetter(transformDont(transformCant(splitAndJoin(transformRange(range), '_', ' '))))
                .toString()
                .trim();
            }

            function transformAbuseExperienced(str) {
              if (!str) return;
              return str
                .split(' ')
                .map(word => capitalizeFirstLetter(word))
                .join(' ')
                .toString()
                .trim();
            }
            
            function getAge(dateString) {
              if (!dateString) return;

              const today = new Date();
              const birthDate = new Date(dateString);
              var age = today.getFullYear() - birthDate.getFullYear();
              var m = today.getMonth() - birthDate.getMonth();
              if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                age--;
              }
              return age;
            }

            state.data.perform_a_risk_assessment = state.data.form.do_you_want_to_perform_a_risk_assessment === 'yes';

            state.data.complete_service_referrals = state.data.form.referral_services ? true : false;
            
            state.data.form.hidden_properties.gender = 
              capitalizeFirstLetter(state.data.form.hidden_properties.gender);

            state.helperFunctions = {
              checked,
              transformAgeRange,
              transformHIVStatus,
              transformLastTested,
              transformMonthAgo,
              transformGenericText,
              transformDont,
              splitAndJoin,
              transformHowOften,
              transformAbuseExperienced,
              getAge,
            };
            return state;
          });

          upsert(
            'Risk_Assessment__c',
            'CommCare_Ext_ID__c',
            fields(
              field('CommCare_Ext_ID__c', dataValue('id')),
              field('Date__c', dataValue('form.date')),
              field('Participant_Name__c', state => {
                  var firstname = state.data.form.hidden_properties.praticipant_first_name;
                  var lastname = state.data.form.hidden_properties.participant_surname;
                  return firstname + ' ' + lastname;
                }),
              field('Participant_Age__c', state => {
                const dob = dataValue('form.hidden_properties.date_of_birth')(state);

                return state.helperFunctions.getAge(dob);
              }),
              field('Participant_Sex__c', dataValue('form.hidden_properties.gender')),
              field('X1_0_Sexually_Active_past_12_month__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.sexually_active_12_months')(state)
                )
              ),
              field('X1_1_Age_at_first_sex__c', state =>
                state.helperFunctions.transformAgeRange(
                  dataValue('form.sexual_risk_and_pregnancy.age_at_first_sex')(state)
                )
              ),
              field('X1_2_Have_you_ever_had_unprotected_sex__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.have_you_ever_had_unprotected_sex')(state)
                )
              ),
              field('X1_3_Sex_for_monetary_or_material_benefi__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.sex_monetary_material')(state)
                )
              ),
              field('Do_you_know_your_HIV_status__c', state =>
                state.helperFunctions.transformHIVStatus(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.do_you_know_your_hiv_status')(state)
                )
              ),
              field('X2_1_When_last_did_you_test_for_HIV__c', state =>
                state.helperFunctions.transformMonthAgo(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.when_last_did_you_test_for_hiv')(state)
                )
              ),
              field('X2_2_Are_you_on_treatment_ART__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.are_you_on_treatment_art')(state)
                )
              ),
              field('X3_0_Had_an_STI_in_the_last_12months_yea__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.sti_and_pep.hiv_last_12_months')(state)
                )
              ),
              field('X3_1_Past_12_months_sex_HIV_status_part__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.sti_and_pep.knowing_partners_hiv_status')(state)
                )
              ),
              //PENDING Donny change data type in SF
              // field('X4_0_Forms_of_abuse_experienced_before__c', state =>
              //   state.helperFunctions.transformAbuseExperienced(
              //     dataValue('form.risk_assessment.gender_based_violence.abuse_experienced')(state)
              //   )
              // ),
              field('X4_1_Feel_unsafe_any1_interact_with_ofte__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.sti_and_pep.gender_based_violence.unsafe_with_others')(state)
                )
              ),
              field('X4_2_Of_what_relationship_person_to_you__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.sti_and_pep.gender_based_violence.relationship_of_abuser')(state)
                )
              ),
              field('X5_0_Do_you_take_alcohol_or_drugs__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.sti_and_pep.gender_based_violence.drugs_and_alcohol_use.do_you_take_alcohol_andor_drugs')(state)
                )
              ),
              field('X5_1_On_average_how_often_drink_alcohol__c', state =>
                state.helperFunctions.transformHowOften(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.sti_and_pep.gender_based_violence.drugs_and_alcohol_use.how_often_alcohol')(state)
                )
              ),
              field('X5_2_On_average_how_often_take_drugs__c', state =>
                state.helperFunctions.transformHowOften(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.sti_and_pep.gender_based_violence.drugs_and_alcohol_use.how_often_drugs')(state)
                )
              ),
              field('X5_3_Easy_for_teens_to_obtain_alcohol__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.sti_and_pep.gender_based_violence.drugs_and_alcohol_use.alcohol_19')(state)
                )
              ),
              field('X5_4__c', state =>
                state.helperFunctions.transformGenericText(
                  dataValue('form.sexual_risk_and_pregnancy.hiv_status.sti_and_pep.gender_based_violence.drugs_and_alcohol_use.illegal_drugs_19')(state)
                )
              )
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Risk-and-Vulnerability-Assessment:
        source_trigger: webhook
        target_job: Risk-and-Vulnerability-Assessment
        condition_type: js_expression
        condition_label: 'Risk & Vulnerability Assessment'
        condition_expression: |
          state.data.form["@name"] == "Risk and Vulnerability Assessment" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  Upsert-Team-or-Group-Name:
    name: Upsert Team or Group Name
    jobs:
      Upsert-Team-or-Group-Name:
        name: Upsert Team or Group Name
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: null
        body: |
          // Upsert event by unique 'Name'
          upsert(
            'Event__c',
            'CommCare_Case_ID__c',
            fields(
              field(
                'Class_Group_Team__c',
                dataValue('form.question_group.group__team_name')
              ),
              relationship('RecordType', 'Name', 'Intervention'), 
              field(
                'CommCare_Case_ID__c',
                dataValue('form.case.@case_id')
              ),
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Team-or-Group-Name:
        source_trigger: webhook
        target_job: Upsert-Team-or-Group-Name
        condition_type: js_expression
        condition_label: 'My Team/Group Name'
        condition_expression: |
          state.data.form["@name"] == "My Team/Group Name" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Malaria-Testing-Event-Statistics":
    name: '? Malaria Testing Event Statistics'
    jobs:
      Malaria-Testing-Event-Statistics:
        name: Malaria Testing Event Statistics
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // push to production
          upsert(
            'Event__c',
            'CommCare_Case_ID__c',
          fields(
            field('Name', dataValue('form.event_information.event_name')),
            field('CommCare_Case_ID__c', dataValue('form.case.@case_id')),
            field(
              'Tested_Negative_Males_0_9__c',
              dataValue('form.table_1_testing_results_malaria.male_malaria_negative.question2')
            ),
            field(
              'Tested_Negative_Males_10_14__c',
              dataValue('form.table_1_testing_results_malaria.male_malaria_negative.question7')
            ),
            field(
              'Tested_Negative_Males_15_19__c',
              dataValue('form.table_1_testing_results_malaria.male_malaria_negative.question13')
            ),
            field(
              'Tested_Negative_Males_20_24__c',
              dataValue('form.table_1_testing_results_malaria.male_malaria_negative.question18')
            ),
            field(
              'Tested_Negative_Males_25_49__c',
              dataValue('form.table_1_testing_results_malaria.male_malaria_negative.question28')
            ),
            field(
              'Tested_Negative_Males_50__c',
              dataValue('form.table_1_testing_results_malaria.male_malaria_negative.question32')
            ),
            field('Tested_Positive_Males_0_9__c', dataValue('form.table_1_testing_results_malaria.question33.question36')),
            field('Tested_Positive_Males_10_14__c', dataValue('form.table_1_testing_results_malaria.question33.question41')),
            field('Tested_Positive_Males_15_19__c', dataValue('form.table_1_testing_results_malaria.question33.question45')),
            field('Tested_Positive_Males_20_24__c', dataValue('form.table_1_testing_results_malaria.question33.question50')),
            field('Tested_Positive_Males_25_49__c', dataValue('form.table_1_testing_results_malaria.question33.question56')),
            field('Tested_Positive_Males_50__c', dataValue('form.table_1_testing_results_malaria.question33.question60')),
            field('Tested_Negative_Females_0_9__c', dataValue('form.table_1_testing_results_malaria.question61.question65')),
            field('Tested_Negative_Females_10_14__c', dataValue('form.table_1_testing_results_malaria.question61.question69')),
            field('Tested_Negative_Females_15_19__c', dataValue('form.table_1_testing_results_malaria.question61.question73')),
            field('Tested_Negative_Females_20_24__c', dataValue('form.table_1_testing_results_malaria.question61.question78')),
            field('Tested_Negative_Females_25_49__c', dataValue('form.table_1_testing_results_malaria.question61.question84')),
            field('Tested_Negative_Females_50__c', dataValue('form.table_1_testing_results_malaria.question61.question88')),
            field('Tested_Positive_Females_0_9__c', dataValue('form.table_1_testing_results_malaria.question89.question92')),
            field('Tested_Positive_Females_10_14__c', dataValue('form.table_1_testing_results_malaria.question89.question97')),
            field('Tested_Positive_Females_15_19__c', dataValue('form.table_1_testing_results_malaria.question89.question101')),
            field('Tested_Positive_Females_20_24__c', dataValue('form.table_1_testing_results_malaria.question89.question106')),
            field('Tested_Positive_Females_25_49__c', dataValue('form.table_1_testing_results_malaria.question89.question112')),
            field('Tested_Positive_Females_50__c', dataValue('form.table_1_testing_results_malaria.question89.question116'))
          ));

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Malaria-Testing-Event-Statistics:
        source_trigger: webhook
        target_job: Malaria-Testing-Event-Statistics
        condition_type: js_expression
        condition_label: Malaria Testing Event Statistics
        condition_expression: |
          state.data.form["@name"] == "Malaria Testing Event Statistics" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  Attendance-Non-Skillz:
    name: Attendance Non Skillz
    jobs:
      Attendance-Non-Skillz:
        name: Attendance Non Skillz
        adaptor: '@openfn/language-salesforce@4.3.0'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          fn(state => {
            if (!state.data.form.attendance_list.update_participant_cases.item) {
              console.log('No participant attendance data was provided, not upserting to Salesforce.');
              return state;
            } else {
              // query(
              //   `SELECT Id, Name, CommCare_Ext_ID__c FROM Event__c WHERE CommCare_Case_ID__c = '${state.data.form.attendance_list.update_participant_cases.item[0]['@id']}'`
              // );

              // fn(state => {
              const records = lastReferenceValue('records')(state);
              const eventName = lastReferenceValue('records[0].CommCare_Ext_ID__c')(state);

              // if (!eventName) {
              //   console.log(
              //     `Participant not found with CommCare_Case_ID__c: ${state.data.form.attendance_list.update_participant_cases.item[0]['@id']}`
              //   );
              //   return state;
              // }

              return execute(
                fn(state => {
                  // Note: lastReferenceValue selects the first item in the references array.
                  state.data.eventName = eventName ? eventName.replace(/\//gi, '') : null;

                  function getSessionValue(present) {
                    switch (present.toString().toLowerCase()) {
                      case 'yes':
                        return 'X';
                      case 'no':
                        return 'A';
                      case '':
                        return 'N';
                      default:
                        return 'U';
                    }
                  }

                  function getSessionId(session_text) {
                    return session_text.toString().trim().slice(0, session_text.indexOf(' ')).slice(1);
                  }

                  function objectToArray(object) {
                    if (!object) return [];
                    return !Array.isArray(object) ? [object] : object;
                  }

                  state.data.form.attendance_list.update_participant_cases.item = objectToArray(
                    state.data.form.attendance_list.update_participant_cases.item
                  );
                  
                  //When GRS enters session names incorrectly in CommCare (e.g., session: "P8 // My body is mine)
                  function findPValue(input) {
                    // Regular expression to match "P" followed by one or more digits, then "//"
                      const regex = /P(\d+)\s*\/\//;
              
                    // Match the input against the regex
                    const match = input.match(regex);
              
                    // If a match is found, return the captured digits as an integer
                    if (match) {
                      return parseInt(match[1], 10);
                    } else {
                      // If no match is found, return null or handle as needed
                    return 'Session_not_found';
                  }
          }

                  const sessionText = dataValue('form.attendance_list.session')(state);
                  const sessionId = sessionText.includes('//') ? findPValue(sessionText) : getSessionId(sessionText);
                  
                  console.log('sessionText:: ', sessionText); 
                  console.log('sessionId:: ', sessionText); 
                  
                  const sessionDate = dataValue("form.case['@date_modified']")(state);

                  state.data.form.attendance_list.update_participant_cases.item =
                    state.data.form.attendance_list.update_participant_cases.item.map(item => {
                      const sessionValue = getSessionValue(item.attendance_session);
                      return {
                        ...item,
                        dynamicFields: {
                          [`Session_${sessionId}__c`]: sessionValue,
                          [`Session_${sessionId}_Date__c`]: sessionDate,
                        },
                      };
                    });

                  return state;
                }),

                each(
                  merge(
                    dataPath('form.attendance_list.update_participant_cases.item[*]'),
                    fields(
                      field('intervention_name', dataValue('form.intervention_name')),
                      field('eventName', dataValue('eventName')),
                      field('caseid', dataValue('form.case.@case_id'))
                    )
                  ),
                  upsert('Attendance__c', 'CommCare_Ext_ID__c', state => ({
                    ...fields(
                      relationship('Event__r', 'CommCare_Case_ID__c', dataValue('caseid')),
                      field(
                        'CommCare_Ext_ID__c',
                        state => `${state.data['@id']}-${toUTF8(state.data.intervention_name)}`
                      ),
                      relationship('Person_Attendance__r', 'Participant_Identification_Number_PID__c', dataValue('@id'))
                    ),
                    ...state.data.dynamicFields,
                  }))
                )
              )(state);
            }
          });

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Attendance-Non-Skillz:
        source_trigger: webhook
        target_job: Attendance-Non-Skillz
        condition_type: js_expression
        condition_label: Attendance Generic
        condition_expression: |
          state.data.form["@name"] == "Attendance" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  Create-Intervention:
    name: Create Intervention
    jobs:
      Create-Intervention:
        name: Create Intervention
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          alterState((state) => {
            
            function clean(str) {
              if (!!str)
                return str
                  .split('_')
                  .map(word => {
                    let new_word = word.toString().toLowerCase();
                    return new_word.slice(0, 1).toUpperCase() + new_word.slice(1);
                  })
                  .join(' ');
            }
            
            state.data.form.delivery_method = clean(state.data.form.delivery_method);
            
            const coachFieldNames = ['Coach_A__r','Coach_B__r','Coach_C__r','Coach_D__r']
           
            state.data.destinationCoachFields = state.data.form.coaches
            .split(' ')
            .reduce(
              (accumulator, currentValue, currentIndex) => [
                ...accumulator,
                (currentIndex < coachFieldNames.length && !!currentValue
                  ? relationship(coachFieldNames[currentIndex], 'CommCare_Ext_ID__c', currentValue)
                  : []),
              ],
              []
            );
            
            return state; 
          }); 

          upsert(
            'Event__c',
            'CommCare_Case_ID__c',
            state=>({
            ...fields(
              field('Name', dataValue('form.name_of_intervention')),
              field('CommCare_Ext_ID__c', state => {
                return dataValue('form.name_of_intervention')(state).replace(/\//gi, ''); 
              }),
              field('CommCare_Case_ID__c', dataValue('form.case.@case_id')),
              relationship('RecordType', 'Name', 'Intervention'),
              field('Business_Unit__c', state => {
                const bu = dataValue('form.business_unit')(state); 
                return bu==='65680f0c4c144b03ad0f86bdc46c1ebc' ? 'GRS Zambia' : 
                bu==='04d98397e28046118fade28ced6b65cb' ? 'GRS Zimbabwe' : 
                bu==='ed125ab19ec34aacab79585e59eb76f4' ? 'GRS Partnerships': undefined ; 
              }),
              relationship(
                'Site__r',
                'CommCare_Ext_ID__c',
                dataValue('form.site')
              ),
              relationship(
                'Venue__r',
                'CommCare_Ext_ID__c',
                dataValue('form.Venue')
                
              ),
              relationship(
                'Curriculum__r',
                'CommCare_Ext_ID__c',
                dataValue('form.curriculum_selection.curriculum')
              ),
              // relationship(
              //   'Grant__r',
              //   'CommCare_Ext_ID__c',
              //   dataValue('form.grant')
              // ),
              field('Delivery_Method__c', dataValue('form.delivery_method')),
              field('Class_Group_Team__c', dataValue('form.class_grade')),
              field('Pre_Post_Administered__c', dataValue('form.prepost_administered')),
              field('Start_Date__c', dataValue('form.intervention_dates.start_date')),
              field('End_Date__c', dataValue('form.intervention_dates.end_date'))
            ),
            ...fields(...state.data.destinationCoachFields)
            })
          );

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Create-Intervention:
        source_trigger: webhook
        target_job: Create-Intervention
        condition_type: js_expression
        condition_label: Create Intervention
        condition_expression: |
          state.data.form["@name"] == "Create Intervention" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Register-Participant---V2-Skillz":
    name: '? Register Participant - V2 Skillz'
    jobs:
      Register-Participant---V2-Skillz:
        name: Register Participant - V2 Skillz
        adaptor: '@openfn/language-salesforce@5.0.5'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          query(`SELECT Id, Name, CommCare_Ext_ID__c FROM Event__c WHERE CommCare_Case_ID__c = '${state.data.form.case['@case_id']}'`);

          alterState(state => {
            // Note: lastReferenceValue selects the first item in the references array.
            state.data.eventName = lastReferenceValue('records[0].CommCare_Ext_ID__c')(state);

            function objectToArray(object) {
              return !Array.isArray(object) ? [object] : object;
            }

            // if (state.data.form.question1) {
            //   console.log('Ensuring that "question1" is an array.');
            //   state.data.form.question1 = objectToArray(state.data.form.question1);
            // } else {
            //   console.log('Shifting "new_participants" to "question1" array.');
            //   state.data.form.question1 = objectToArray(state.data.form.new_participants);
            //   console.log('Creating a "case" object inside each item in that array.');
            //   state.data.form.question1 = state.data.form.question1.map(item => ({
            //     ...item,
            //     case: item.create_skillz_plus_participant.case,
            //   }));
            // }

            console.log('Done with initial data manipulation.');

            return state;
          });

          // beta.each(
          //   merge(
          //     dataPath('form.question1[*]'),
          //     fields(
          //       field('intervention_notes_to_save', dataValue('form.intervention_notes_to_save')))
          //   ),

            upsert(
              'Person__c',
              'Participant_Identification_Number_PID__c',
              fields(
                field('Notes__c', dataValue('form.intervention_notes_to_save')),
                field('First_Name__c', dataValue('form.new_participants.participant_first_name')),
                field('Surname__c', dataValue('form.new_participants.participant_surname')),
                relationship('RecordType', 'Name', 'Participant'),
                field('Participant_Identification_Number_PID__c', state => state.data.form.new_participants.create_skillz_plus_participant.case['@case_id']),
                field('Sex__c', dataValue('gender')),
                field('Mobile_Number_1__c', dataValue('form.new_participants.mobile_number')), //QUESTION: In CommCare, phone doesn't look like it's saving?
                field('School_name_person__c', dataValue('form.new_participants.school_name')),
                field('Date_of_Birth__c', dataValue('date_of_birth')),
                field('School_name_person__c', dataValue('form.new_participants.school_name')),
                field('Physical_Address__c', dataValue('form.new_participants.participants_home_address'))
                //field('Age__c', dataValue('form.question1.age_in_years')), //This is a SF formula field, cannot map
              )
            )
          //);

          // each(
          //   merge(dataPath('form.question1[*]'), fields(
          //     field('intervention_name', dataValue('form.intervention_name')),
          //     field('eventName', dataValue('eventName')))),
            upsert(
              'Attendance__c',
              'CommCare_Ext_ID__c',
              fields(
                field('CommCare_Ext_ID__c', state => {
                  var eventid = `${state.data.eventName}` || dataValue('form.intervention_name')(state);
                  var personid = state.data.form.new_participants.create_skillz_plus_participant.case['case_id'];//state.data.case['@case_id'];
                  return personid + '-' + eventid;
                }),
                relationship(
                  //Attendance looks up to Persn via the case_id
                  'Person_Attendance__r',
                  'Participant_Identification_Number_PID__c',
                  state => state.data.case['@case_id']
                ),
                relationship(
                  //Attendance looks up to Event via the intervention_name
                  'Event__r',
                  'CommCare_Case_ID__c',
                  state.data.form.new_participants.create_skillz_plus_participant.case.index.parent['#text']
                ),
                field('Date_of_Birth__c', dataValue('form.new_participants.date_of_birth'))
              )
            )
          //);

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Register-Participant---V2-Skillz:
        source_trigger: webhook
        target_job: Register-Participant---V2-Skillz
        condition_type: js_expression
        condition_label: Register Participants skillz
        condition_expression: |
          state.data.form["@name"] == "Register Participants" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "x-[archived]-Attendance":
    name: 'x [archived] Attendance'
    jobs:
      Attendance:
        name: Attendance
        adaptor: '@openfn/language-salesforce@v2.0.0'
        credential: null
        body: |
          query(`SELECT Id, Name, CommCare_Ext_ID__c FROM Event__c WHERE CommCare_Case_ID__c = '${state.data.form.case['@case_id']}'`);

          alterState(state => {
            // Note: lastReferenceValue selects the first item in the references array.
            state.data.eventName = lastReferenceValue('records[0].CommCare_Ext_ID__c')(state);
            
            function getSessionValue(present) {
              switch (present.toString().toLowerCase()) {
                case 'yes':
                  return 'X';
                case 'no':
                  return 'A';
                case '':
                  return 'N';
                default:
                  return 'U';
              }
            }

            function getSessionId(session_text) {
              return session_text.toString().trim().slice(0, session_text.indexOf(' ')).slice(1);
            }

            function objectToArray(object) {
              if (!object) return [];
              return !Array.isArray(object) ? [object] : object;
            }

            state.data.form.attendance_list.update_participant_cases.item = objectToArray(
              state.data.form.attendance_list.update_participant_cases.item
            );

            const sessionText = dataValue('form.attendance_list.session')(state);
            const sessionId = getSessionId(sessionText);

            //   @aleksa-krolls confirm the path for the session date
            const sessionDate = dataValue("form.case['@date_modified']")(state);

            state.data.form.attendance_list.update_participant_cases.item =
              state.data.form.attendance_list.update_participant_cases.item.map(item => {
                const sessionValue = getSessionValue(item.attendance_session);
                return {
                  ...item,
                  dynamicFields: { [`Session_${sessionId}__c`]: sessionValue, [`Session_${sessionId}_Date__c`]: sessionDate },
                };
              });

            return state;
          });

          each(
            merge(
              dataPath('form.attendance_list.update_participant_cases.item[*]'),
              fields(
                field('intervention_name', dataValue('form.intervention_name')),
                field('eventName', dataValue('eventName')),
                field('caseid', dataValue('form.case.@case_id'))
              )
            ),
            upsert('Attendance__c', 'CommCare_Ext_ID__c', state => ({
              ...fields(
                relationship('Event__r', 'CommCare_Case_ID__c', dataValue('caseid')),
                //relationship('Event__r', 'CommCare_Ext_ID__c', dataValue('eventName')),
                field('CommCare_Ext_ID__c', state => `${state.data['@id']}-${state.data.eventName}`),
                relationship('Person_Attendance__r', 'Participant_Identification_Number_PID__c', dataValue('@id'))
              ),
              ...state.data.dynamicFields,
            }))
          );

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Attendance:
        source_trigger: webhook
        target_job: Attendance
        condition_type: js_expression
        condition_label: 'Attendance (Non Skillz Only)'
        condition_expression: |
          state.data.form.attendance == "1" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  HIV-Testing-Event-Statistics:
    name: HIV Testing Event Statistics
    jobs:
      HIV-Testing-Event-Statistics:
        name: HIV Testing Event Statistics
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          // push to production
          upsert(
            'Event__c',
            'CommCare_Case_ID__c',
            fields(
              field('Name', dataValue('form.event_name')),
              field('CommCare_Case_ID__c', dataValue('form.case.@case_id')),
              field('Tested_Negative_Males_0_9__c', dataValue('form.table_1_testing_results.male_hiv_negative.question2')),
              field('Tested_Negative_Males_10_14__c', dataValue('form.table_1_testing_results.male_hiv_negative.question7')),
              field('Tested_Negative_Males_15_19__c', dataValue('form.table_1_testing_results.male_hiv_negative.question13')),
              field('Tested_Negative_Males_20_24__c', dataValue('form.table_1_testing_results.male_hiv_negative.question18')),
              field('Tested_Negative_Males_25_49__c', dataValue('form.table_1_testing_results.male_hiv_negative.question28')),
              field('Tested_Negative_Males_50__c', dataValue('form.table_1_testing_results.male_hiv_negative.question32')),
              field('Tested_Positive_Males_0_9__c', dataValue('form.table_1_testing_results.question33.question36')),
              field('Tested_Positive_Males_10_14__c', dataValue('form.table_1_testing_results.question33.question41')),
              field('Tested_Positive_Males_15_19__c', dataValue('form.table_1_testing_results.question33.question45')),
              field('Tested_Positive_Males_20_24__c', dataValue('form.table_1_testing_results.question33.question50')),
              field('Tested_Positive_Males_25_49__c', dataValue('form.table_1_testing_results.question33.question56')),
              field('Tested_Positive_Males_50__c', dataValue('form.table_1_testing_results.question33.question60')),
              field('Tested_Negative_Females_0_9__c', dataValue('form.table_1_testing_results.question61.question65')),
              field('Tested_Negative_Females_10_14__c', dataValue('form.table_1_testing_results.question61.question69')),
              field('Tested_Negative_Females_15_19__c', dataValue('form.table_1_testing_results.question61.question73')),
              field('Tested_Negative_Females_20_24__c', dataValue('form.table_1_testing_results.question61.question78')),
              field('Tested_Negative_Females_25_49__c', dataValue('form.table_1_testing_results.question61.question84')),
              field('Tested_Negative_Females_50__c', dataValue('form.table_1_testing_results.question61.question88')),
              field('Tested_Positive_Females_0_9__c', dataValue('form.table_1_testing_results.question89.question92')),
              field('Tested_Positive_Females_10_14__c', dataValue('form.table_1_testing_results.question89.question97')),
              field('Tested_Positive_Females_15_19__c', dataValue('form.table_1_testing_results.question89.question101')),
              field('Tested_Positive_Females_20_24__c', dataValue('form.table_1_testing_results.question89.question106')),
              field('Tested_Positive_Females_25_49__c', dataValue('form.table_1_testing_results.question89.question112')),
              field('Tested_Positive_Females_50__c', dataValue('form.table_1_testing_results.question89.question116')),
              field(
                'Pregnant_Women_Tested_0_9__c',
                dataValue(
                  'form.table_3_pregnant_women_tested.enter_the_number_of_pregnant_women_tested_for_each_following_age_group.question120'
                )
              ),
              field(
                'Pregnant_Women_Tested_10_14__c',
                dataValue(
                  'form.table_3_pregnant_women_tested.enter_the_number_of_pregnant_women_tested_for_each_following_age_group.question124'
                )
              ),
              field(
                'Pregnant_Women_Tested_15_19__c',
                dataValue(
                  'form.table_3_pregnant_women_tested.enter_the_number_of_pregnant_women_tested_for_each_following_age_group.question129'
                )
              ),
              field(
                'Pregnant_Women_Tested_20_24__c',
                dataValue(
                  'form.table_3_pregnant_women_tested.enter_the_number_of_pregnant_women_tested_for_each_following_age_group.question134'
                )
              ),
              field(
                'Pregnant_Women_Tested_25_49__c',
                dataValue(
                  'form.table_3_pregnant_women_tested.enter_the_number_of_pregnant_women_tested_for_each_following_age_group.question140'
                )
              ),
              field(
                'Pregnant_Women_Tested_50__c',
                dataValue(
                  'form.table_3_pregnant_women_tested.enter_the_number_of_pregnant_women_tested_for_each_following_age_group.question144'
                )
              ),
              //field(
              //  'Total_Pregnant_Women_Tested__c',
              //  dataValue(
              //    'form.table_3_pregnant_women_tested.enter_the_number_of_pregnant_women_tested_for_each_following_age_group.total_tested_pregnant'
              //  )
              //),
              field(
                'First_Time_Females_0_9__c',
                state =>
                  dataValue('form.table_4_first_time_testers.question61.question65')(state) +
                  dataValue('form.table_4_first_time_testers.question89.question92')(state)
              ),
              field(
                'First_Time_Females_10_14__c',
                state =>
                  dataValue('form.table_4_first_time_testers.question61.question69')(state) +
                  dataValue('form.table_4_first_time_testers.question89.question97')(state)
              ),
              field(
                'First_Time_Females_15_19__c',
                state =>
                  dataValue('form.table_4_first_time_testers.question61.question73')(state) +
                  dataValue('form.table_4_first_time_testers.question89.question101')(state)
              ),
              field(
                'First_Time_Females_20_24__c',
                state =>
                  dataValue('form.table_4_first_time_testers.question61.question78')(state) +
                  dataValue('form.table_4_first_time_testers.question89.question106')(state)
              ),
              field(
                'First_Time_Females_25_49__c',
                state =>
                  dataValue('form.table_4_first_time_testers.question61.question84')(state) +
                  dataValue('form.table_4_first_time_testers.question89.question112')(state)
              ),
              field(
                'First_Time_Females_50__c',
                state =>
                  dataValue('form.table_4_first_time_testers.question61.question88')(state) +
                  dataValue('form.table_4_first_time_testers.question89.question116')(state)
              ),
              field(
                'First_Time_Males_0_9__c',
                state =>
                  dataValue('form.table_4_first_time_testers.male_hiv_negative.question2')(state) +
                  dataValue('form.table_4_first_time_testers.question33.question36')(state)
              ),
              field(
                'First_Time_Males_10_14__c',
                state =>
                  dataValue('form.table_4_first_time_testers.male_hiv_negative.question7')(state) +
                  dataValue('form.table_4_first_time_testers.question33.question41')(state)
              ),
              field(
                'First_Time_Males_15_19__c',
                state =>
                  dataValue('form.table_4_first_time_testers.male_hiv_negative.question13')(state) +
                  dataValue('form.table_4_first_time_testers.question33.question45')(state)
              ),
              field(
                'First_Time_Males_20_24__c',
                state =>
                  dataValue('form.table_4_first_time_testers.male_hiv_negative.question18')(state) +
                  dataValue('form.table_4_first_time_testers.question33.question50')(state)
              ),
              field(
                'First_Time_Males_25_49__c',
                state =>
                  dataValue('form.table_4_first_time_testers.male_hiv_negative.question28')(state) +
                  dataValue('form.table_4_first_time_testers.question33.question56')(state)
              ),
              field(
                'First_Time_Males_50__c',
                state =>
                  dataValue('form.table_4_first_time_testers.male_hiv_negative.question32')(state) +
                  dataValue('form.table_4_first_time_testers.question33.question60')(state)
              ),
              field(
                'of_Males_Referred_to_Sexual_Abuse__c',
                dataValue(
                  'form.table5_referrals.enter_the_number_of_men_and_women_referred_for_each_referral_tye_and_the_or.abuseviolence_referral'
                )
              ),
              field(
                'of_Males_Referred_to_Family_Referral__c',
                dataValue(
                  'form.table5_referrals.enter_the_number_of_men_and_women_referred_for_each_referral_tye_and_the_or.family_planning_referral'
                )
              ),
              field(
                'of_Males_Referred_for_HIV_Positive__c',
                dataValue(
                  'form.table5_referrals.enter_the_number_of_men_and_women_referred_for_each_referral_tye_and_the_or.hiv_positive_referral'
                )
              ),
              field(
                'of_Males_Referred_to_MMC_Referral__c',
                dataValue(
                  'form.table5_referrals.enter_the_number_of_men_and_women_referred_for_each_referral_tye_and_the_or.medical_male_circumcision_referral'
                )
              ),
              field(
                'of_Males_Referred_to_STI__c',
                dataValue(
                  'form.table5_referrals.enter_the_number_of_men_and_women_referred_for_each_referral_tye_and_the_or.sexually_transmitted_infection_sti_referral'
                )
              ),
              field(
                'of_Males_Referred_to_Tuberculosis__c',
                dataValue(
                  'form.table5_referrals.enter_the_number_of_men_and_women_referred_for_each_referral_tye_and_the_or.tuberculosis_tb_referral'
                )
              ),
              field(
                'of_Females_Referred_to_Sexual_Abuse__c',
                dataValue('form.table5_referrals.women_referred_number.abuseviolence_referral_women')
              ),
              field(
                'of_Females_Referred_to_Antenatal_Care__c',
                dataValue('form.table5_referrals.women_referred_number.antenatal_care_anc_referral_women')
              ),
              field(
                'of_Females_Referred_to_Family_Referral__c',
                dataValue('form.table5_referrals.women_referred_number.family_planning_referral_women')
              ),
              field(
                'of_Females_Referred_for_HIV_Positive__c',
                dataValue('form.table5_referrals.women_referred_number.hiv_positive_referral_women')
              ),
              field(
                'of_Females_Referred_to_PMTCT__c',
                dataValue('form.table5_referrals.women_referred_number.prevention_of_mother-to-child_transmission_women')
              ),
              field(
                'of_Females_Referred_to_STI__c',
                dataValue('form.table5_referrals.women_referred_number.sexually_transmitted_infection_sti_referral_women')
              ),
              field(
                'of_Females_Referred_to_Tuberculosis__c',
                dataValue('form.table5_referrals.women_referred_number.tuberculosis_tb_referral_women')
              ),
              
              field('Community_Members__c', dataValue('form.table_2_tested_profile.enter_the_number_tested_for_each_following_profile.community_members')),
              field('GRS_Coaches__c', dataValue('form.table_2_tested_profile.enter_the_number_tested_for_each_following_profile.skillz_coaches')),
              field('GRS_Participants__c', dataValue('form.table_2_tested_profile.enter_the_number_tested_for_each_following_profile.skillz_participants')),
              field('GRS_Staff__c', dataValue('form.table_2_tested_profile.enter_the_number_tested_for_each_following_profile.staff')),
              //field('Total_Tested__c', dataValue('form.table_2_tested_profile.enter_the_number_tested_for_each_following_profile.total_tested')),
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->HIV-Testing-Event-Statistics:
        source_trigger: webhook
        target_job: HIV-Testing-Event-Statistics
        condition_type: js_expression
        condition_label: HIV Testing Event Statistics
        condition_expression: |
          state.data.form["@name"] == "HIV Testing Event Statistics" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  "?-Upsert-Register-Participant-Skillz":
    name: '? Upsert Register Participant Skillz'
    jobs:
      Upsert-Register-Participant-Skillz:
        name: Upsert Register Participant Skillz
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          query(
            `SELECT Id, Name, CommCare_Ext_ID__c FROM Event__c WHERE CommCare_Case_ID__c = '${state.data.form.case['@case_id']}'`
          );

          fn(state => {
            // Note: lastReferenceValue selects the first item in the references array.
            state.data.eventName = lastReferenceValue('records[0].CommCare_Ext_ID__c')(state);
            state.data.eventCase = dataValue('form.case.@case_id')(state);

            function objectToArray(object) {
              return !Array.isArray(object) ? [object] : object;
            }

            const { form } = state.data;
            if (form.question1) {
              console.log('Ensuring that "question1" is an array.');
              form.question1 = objectToArray(form.question1);
            } else if (!form.new_participants) {
              console.log('Nothing to upsert. No participants were registered');
            } else {
              console.log('Shifting "new_participants" to "question1" array.');
              form.question1 = objectToArray(form.new_participants);
              console.log('Creating a "case" object inside each item in that array.');
              form.question1 = form.question1.map(item => ({
                ...item,
                case: item.create_skillz_plus_participant.case,
              }));
            }

            console.log('Done with initial data manipulation.');
            const persons = merge(
              dataPath('form.question1[*]'),
              fields(field('intervention_notes_to_save', dataValue('form.intervention_notes_to_save')))
            )(state);

            const attendances = merge(
              dataPath('form.question1[*]'),
              fields(
                field('intervention_name', dataValue('form.intervention_name')),
                field('eventCase', dataValue('eventCase')),
                field('eventName', dataValue('eventName'))
              )
            )(state);

            return { ...state, persons, attendances };
          });

          each(
            'persons[*]',
            upsert(
              'Person__c',
              'Participant_Identification_Number_PID__c',
              fields(
                field('Notes__c', dataValue('intervention_notes_to_save')),
                field('First_Name__c', dataValue('participant_first_name')),
                field('Surname__c', dataValue('participant_surname')),
                relationship('RecordType', 'Name', 'Participant'),
                relationship('Site__r', 'CommCare_Ext_ID__c', dataValue('grp_location.site_id')),
                field('Participant_Identification_Number_PID__c', state => state.data.case['@case_id']),
                field('Sex__c', dataValue('gender')),
                field('Mobile_Number_1__c', dataValue('mobile_number')), //QUESTION: In CommCare, phone doesn't look like it's saving?
                field('School_name_person__c', dataValue('school_name')),
                field('Date_of_Birth__c', dataValue('date_of_birth')),
                field('School_name_person__c', dataValue('school_name')),
                field('Physical_Address__c', dataValue('participants_home_address')),
                field('Age_1_0__c', dataValue('participants_age_to_save'))
              )
            )
          );

          each(
            'attendances[*]',
            upsert(
              'Attendance__c',
              'CommCare_Ext_ID__c',
              fields(
                field('CommCare_Ext_ID__c', state => {
                  const eventid = toUTF8(`${state.data.intervention_name}` || `${state.data.eventName}`); //dataValue('intervention_name')(state) || `${state.data.eventName}`;
                  const personid = state.data.case['@case_id'];
                  const value = personid + '-' + eventid.replace(/\//gi, '');
                  return scrubEmojis(value, '');
                }),
                relationship(
                  //Attendance looks up to Persn via the case_id
                  'Person_Attendance__r',
                  'Participant_Identification_Number_PID__c',
                  state => state.data.case['@case_id']
                ),
                relationship(
                  //Attendance looks up to Event via the Event case_id
                  'Event__r',
                  'CommCare_Case_ID__c',
                  state => `${state.data.eventCase}`
                ),
                // relationship(
                //   //Attendance looks up to Event via the intervention_name
                //   'Event__r',
                //   'CommCare_Ext_ID__c',
                //   state => `${state.data.intervention_name}` || `${state.data.eventName}`
                // ),
                field('Date_of_Birth__c', dataValue('date_of_birth'))
              )
            )
          );

          //First we insert Person record
          // fn(state => {
          //   return upsert(
          //     'Person__c',
          //     'Participant_Identification_Number_PID__c',
          //     fields(
          //       field('Notes__c', dataValue('form.intervention_notes_to_save')),
          //       field('First_Name__c', dataValue('form.question1.participant_first_name')),
          //       field('Surname__c', dataValue('form.question1.participant_surname')),
          //       relationship('RecordType', 'Name', 'Participant'),
          //       field('Participant_Identification_Number_PID__c', state => state.data.case['@case_id']),
          //       field('Sex__c', dataValue('form.question1.gender')),
          //       //field('Age__c', dataValue('form.question1.age_in_years')), //This is a SF formula field, cannot map
          //       field('Mobile_Number_1__c', dataValue('form.question1.mobile_number')),
          //       field('School_name_person__c', dataValue('form.question1.school_name'))
          //     )
          //   )(state);
          // });

          // fn(state => {
          //   //Then we upsert related Attendance records
          //   return upsert(
          //     'Attendance__c',
          //     'CommCare_Ext_ID__c',
          //     fields(
          //       field('CommCare_Ext_ID__c', state => {
          //         var eventid = dataValue('form.intervention_name')(state);
          //         var personid = dataValue('form.case.@case_id')(state);
          //         return personid + '-' + eventid;
          //       }),
          //       relationship(
          //         //Attendance looks up to Persn via the case_id
          //         'Person_Attendance__r',
          //         'Participant_Identification_Number_PID__c',
          //         dataValue('form.case.@case_id')
          //       ),
          //       relationship(
          //         //Attendance looks up to Event via the intervention_name
          //         'Event__r',
          //         'Name',
          //         dataValue('form.intervention_name')
          //       ),
          //       field('Date_of_Birth__c', dataValue('form.question1.date_of_birth'))
          //     )
          //   )(state);
          // });

    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Upsert-Register-Participant-Skillz:
        source_trigger: webhook
        target_job: Upsert-Register-Participant-Skillz
        condition_type: js_expression
        condition_label: Register Participants skillz
        condition_expression: |
          state.data.form["@name"] == "Register Participants" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  Outcome-Survey:
    name: Outcome Survey
    jobs:
      Outcome-Survey:
        name: Outcome Survey
        adaptor: '@openfn/language-salesforce@4.6.0'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          fn((state) => {

            
            state.capitalizeFirstLetter = (text) => {
              if (!text) return text; // Return the text if it's empty or undefined
                return text.charAt(0).toUpperCase() + text.slice(1);
            };
            
            state.replaceUnderscoreWithSpace = (text) => {
              if (typeof text !== 'string') {
                return ''; // Return an empty string if input is not a string
            }
            return text.replace(/_/g, ' ');
          }

          state.replaceSpaceWithSemiColon = (text) => {
              if (typeof text !== 'string') {
                return ''; // Return an empty string if input is not a string
            }
            return text.replace(/ /g, ';');
            
          }

          state.HIVtestMap = {
              agree: "Positive",
              negative: "Negative",
              "copy-2-of-days": "5 - 6 days",
              "i_dont_knowdeclined": "I don't know / Declined to answer",
              "i_dont_knowdeclined_answer": "I don't know / Declined to answer",
              "i_dont_knowdeclined_to_answer": "I don't know / Declined to answer"
            };



          state.daysMap = {
              days: "1 - 2 days",
              "copy-1-of-days": "3 - 4 days",
              "copy-2-of-days": "5 - 6 days",
              "more_than_6_days": "More than 6 days",
              "none": "None"
            };
            
            state.agreeDisagreeMap = {
              Agree: 'Yes', //New
              Disagree: 'No', // Continued
              "I don't know/Declined to answer": "Declined to answer",
              "I_dont_know_declined_to_answer": "Declined to answer",
              "I_dont_knowdeclined_to_answer": "I don't know",
              "choice2": "No"
            };
            
            state.agreeDisagreeMap2 = {
              Agree: 'Yes', //New
              Disagree: 'No', // Continued
              "I don't know/Declined to answer": "Declined to answer",
              "I_dont_know_declined_to_answer": "Declined to answer",
              "I_dont_knowdeclined_to_answer": "Declined to answer",
              "choice2": "No"
            };
            
            state.timeMap = {
              "all_of_the_time": "All of the time",
              "most_of_the_time": "Most of the time", 
              "more_than_half_of_the_time": "More than half of the time",
              "less_than_half_of_the_time": "Less than half of the time",
              "some_of_the_time": "Some of the time",
              "at_no_time": "At no time",
              "choice10": "Less than half of the time"
            }
            
            state.choiceMapping = {
              "choice1": "Confidentiality concerns",
              "choice2": "Contraceptives including pills, injections, implants or similar",
              "choice3": "Condoms  male or female",
              "choice4": "Voluntary medical male circumcision",
              "choice10": "Less than half of the time",
              "Sexual and reproductive health informationtalks": "Sexual and reproductive health information/talks"

            }
            
            state.choiceMapping2 = {
              "Choice2": "Yes",
            }
            
            state.idkdeclinedtodeclined = {
              "I_dont_know_declined_to_answer": "Declined to answer",
            }
            
             state.idkdeclinedtoidkdeclined = {
              "I_dont_know_declined_to_answer": "I don't know / Declined to answer",
              "I_dont_knowdeclined_to_answer": "I don't know / Declined to answer"
            }
            
            
            // function capitalizeFirstLetter(text) {
            // if (!text) return text; // Return the text if it's empty or undefined
            // return text.charAt(0).toUpperCase() + text.slice(1);
            // }

            function transform(value) {
              if (!value) return;
              //console.log("value in switch", value.toString().trim().toLowerCase());
              switch (value.toString().trim().toLowerCase()) {
                case "Agree":
                  return "Yes";
                case "Disagree":
                  return "No";
                case "I don't know/Declined to answer":
                  return "Declined to answer";
                default:
                  return value;
              }
            }

            state.helperFunctions = { transform };

            return state;
          });

          fn((state) => {
            const { form } = state.data;
            state.surveyMappings = {
              CommCare_Ext_ID__c: dataValue("id"),
              Name_of_Interviewer__c: form["name_of_interviewer"],
              Date__c: form.date,
              Interview_Start_Time__c: form.interview_start_time,
              Interview_End_Time__c: form.interview_end_time,
              What_was_the_main_reason_the_participant__c:
                form[
                  "copy-1-of-what_was_the_main_reason_the_participant_did_not_consent_to_participate_in_"
                ],
              Site_Name__c: state.capitalizeFirstLetter(form.site),
              Venue_Name__c: form.venue,
              Group_Name__c: form.group_name,
              //Grade__c: 'form.grade',
              Curriculum_Attended__c: form.curriculum,
              Give_permission_to_participate__c:
                form["did_the_individual_give_permission_to_participate_in_the_survey"],
              Main_reason_of_not_consenting__c: state.choiceMapping[state.replaceUnderscoreWithSpace(state.capitalizeFirstLetter(
                form["what_was_the_main_reason_the_participant_did_not_consent_to_participate_in_"]))],
              Participant_Name__c: form.participant_name,
              Participant_Gender__c: state.capitalizeFirstLetter(form.participant_gender),
              Participant_DOB__c: form.participant_date_of_birth,
              Currently_live_with_at_home__c: state.replaceUnderscoreWithSpace(state.capitalizeFirstLetter(form["who_do_you_currently_live_with_at_home"])),
              Days_did_you_go_without_food__c: state.daysMap[form["in_the_last_week_how_many_days_did_you_go_without_food"]],
              Ever_been_in_any_kind_of_sexual_relation__c: state.capitalizeFirstLetter(form["have_you_ever_been_in_any_kind_of_sexual_relationship_with_someone"]),
              In_any_form_of_sexual_relationship__c: state.choiceMapping2[state.capitalizeFirstLetter(form["are_you_currently_in_any_form_of_sexual_relationship"])],
              Age_of_your_current_last_sexual_partner__c: state.capitalizeFirstLetter(form["what_is_the_age_of_your_currentlast_sexual_partner"]),
              Ever_had_sexual_intercourse__c: state.capitalizeFirstLetter(form["have_you_ever_had_sexual_intercourse"]),
              Age_at_first_sex__c: state.capitalizeFirstLetter(form["how_old_were_you_when_you_had_sexual_intercourse_for_the_first_time"]),
              La__c: state.replaceUnderscoreWithSpace(state.capitalizeFirstLetter(form["the_last_time_you_had_sexual_intercourse_why_did_you_do_it"])),
              Last_2_years_pregnant_or_given_birth__c: state.capitalizeFirstLetter(form["in_the_last_2_years_did_you_ever_get_pregnant_or_give_birth_instruction_thi"]),
              HIV_positive_should_hide_it_from_others__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["people_who_test_hiv_positive_should_hide_it_from_others"])],
              I_would_rather_not_know_if_I_have_HIV__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["i_would_rather_not_know_if_i_have_hiv"])],
              someone_with_HIV_to_stop_taking_their_AR__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["it_is_okay_for_someone_with_hiv_to_stop_taking_their_arv_as_soon_as_they_st"])],
              People_with_HIV_to_have_unprotected_sex__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["it_is_okay_for_two_people_with_hiv_to_have_unprotected_sex_with_each_other"])],
              Someone_has_HIV_by_looking_at_him_or_her__c: state.capitalizeFirstLetter(form["i_can_tell_whether_someone_has_hiv_by_looking_at_him_or_her"]),
              talk_to_a_partner_about_HIV_STI_testing__c: state.capitalizeFirstLetter(form["i_know_how_to_talk_to_a_partner_about_hivsti_testing"]),
              HIV_testing_is_free_at_government_health__c: state.agreeDisagreeMap2[state.capitalizeFirstLetter(form["hiv_testing_is_free_at_government_health_facilities"])],
              Have_you_ever_tested_for_HIV__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["have_you_ever_tested_for_hiv"])],
              Result_of_your_last_HIV_test__c: state.HIVtestMap[form["what_was_the_result_of_your_last_most_recent_hiv_test"]],
              Where_to_get_support_services__c: state.capitalizeFirstLetter(form["i_know_where_to_get_support_services_for_me_or_someone_else_for_hiv-related"]),
              Right_to_access_sexual_health_services__c: state.capitalizeFirstLetter(form["i_have_the_right_to_access_sexual_health_services_such_as_sti_and_hiv_testi"]),
              Where_to_get_support_services_for_GBV__c: state.agreeDisagreeMap[state.capitalizeFirstLetter[form["i_know_where_to_get_support_services_for_me_or_someone_else_for_gender-base"]]],
              Services_accessed_in_the_past_2_years__c: state.choiceMapping[state.replaceUnderscoreWithSpace(state.capitalizeFirstLetter(form["in_the_last_2_years_which_of_these_services_have_you_accessed_through_the_c"]))],
              Accessed_the_above_services__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["did_you_access_the_above_services_more_than_once_per_year"])],
              The_staff_at_my_nearest_clinic_are_frien__c: state.capitalizeFirstLetter(form["the_staff_at_my_nearest_clinic_are_friendly"]),
              Keep_my_personal_information_private__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["the_staff_at_my_nearest_clinic_will_keep_my_personal_information_private"])],
              Feel_stigmatism_or_judged__c: state.agreeDisagreeMap2[state.capitalizeFirstLetter(form["i_do_not_feel_stigmatism_or_judged_when_i_go_to_access_sexual_reproductive_"])],
              Suggests_using_a_condom__c: state.agreeDisagreeMap[state.capitalizeFirstLetter[form["when_a_partner_suggests_using_a_condom_it_means_he_or_she_has_had_sex_with_"]]],
              //A_condom_would_make_sex_less_pleasing__c: state.agreeDisagreeMap2[state.capitalizeFirstLetter(form["using_a_condom_would_make_sex_less_pleasant"])],
              I_know_how_to_correctly_use_a_condom__c: state.agreeDisagreeMap2[state.capitalizeFirstLetter(form["i_know_how_to_correctly_use_a_condom"])],
              Able_to_refuse_to_have_sex__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["i_would_be_able_to_refuse_to_have_sex_if_my_partner_did_not_want_to_use_a_c"])],
              Condoms_are_the_only_contraceptive__c: state.agreeDisagreeMap2[state.capitalizeFirstLetter(form["condoms_are_the_only_contraceptive_method_that_protect_against_pregnancy_as"])],
              Use_a_condom__c: state.idkdeclinedtoidkdeclined[state.capitalizeFirstLetter(form["i_should_use_a_condom_even_if_my_girlfriend_is_on_another_form_of_birth_con"])],
              The_last_time_you_had_sexual_intercourse__c: state.capitalizeFirstLetter(form["the_last_time_you_had_sexual_intercourse_did_you_and_your_partner_use_a_con"]),
              A_girl_woman_can_get_pregnant__c: state.idkdeclinedtoidkdeclined[state.capitalizeFirstLetter(form["a_girl_or_woman_can_get_pregnant_the_very_first_time_she_has_sex"])],
              Sign_of_Pregnancy__c: state.capitalizeFirstLetter(form["one_sign_of_pregnancy_is_a_girl_missing_her_period"]),
              Ever_used_family_planning_method__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["have_you_ever_used_any_type_of_family_planning"])],
              Recieved_Family_Planning__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["in_the_last_2_years_did_you_ask_for_or_receive_family_planning"])],
              Type_of_Family_Planning_accessed__c: state.replaceUnderscoreWithSpace(state.capitalizeFirstLetter(form["in_the_last_2_years_what_type_of_family_planning_services_did_you_access"])),
              Methods_to_avoid_unwanted_pregnancy__c: state.capitalizeFirstLetter(form["i_know_at_least_three_methods_to_avoid_an_unwanted_pregnancy"]),
              Support_for_prevention_of_teen_pregnancy__c: state.capitalizeFirstLetter(form["in_the_last_2_years_did_you_get_support_for_prevention_of_teenage_pregnancy"]),
              I_have_felt_cheerful_and_in_good_spirits__c: state.timeMap[(form["i_have_felt_cheerful_and_in_good_spirits"])],
              I_have_felt_calm_and_relaxed__c: state.timeMap[form["i_have_felt_calm_and_relaxed"]],
              I_have_felt_active_and_vigorous__c: state.timeMap[form["question11"]],
              I_woke_up_feeling_fresh_and_rested__c: state.timeMap[form["i_woke_up_feeling_fresh_and_rested"]],
              Life_filled_with_things_interesting_me__c: state.replaceUnderscoreWithSpace(state.capitalizeFirstLetter(form["my_daily_life_has_been_filled_with_things_that_interest_me"])),
              Sign_of_personal_weakness__c: state.idkdeclinedtoidkdeclined[state.capitalizeFirstLetter(form["a_mental_illness_is_a_sign_of_personal_weakness"])],
              //Sign_of_personal_weakness__c: state.capitalizeFirstLetter(form["seeking_help_for_mental_health_challenges_is_a_sign_of_weakness"]),
              Expectations_dealing_with_emotions__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["society_expects_boys_and_girls_to_deal_with_their_emotions_differently"])],
              Self_control_and_smart_decisions__c: state.capitalizeFirstLetter(form["self-control_helps_you_make_smart_decisions_when_you_are_angry_or_upset"]),
              Avoid_using_violent_behaviour__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["when_i_am_angry_i_know_how_to_avoid_using_violent_behaviour"])],
              Confidence_and_face_to_face_appointments__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["i_am_confident_attending_face_to_face_appointments_to_seek_information_abou"])],
              Seek_information_about_mental_illness__c: state.idkdeclinedtoidkdeclined[state.capitalizeFirstLetter(form["i_am_confident_that_i_know_where_to_seek_information_about_mental_illness"])],
              Bounce_back_from_difficult_situations__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["i_can_bounce_back_from_difficult_situations"])],
              Avoid_people_with_mental_illness__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["it_is_best_to_avoid_people_with_mental_illness_so_that_you_dont_develop_thi"])],
              Informed_decisions_about_sexual_health__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["i_can_make_my_own_informed_decisions_about_my_sexual_healthcare"])],
              Say_no_to_sex_despite_pressure__c: state.capitalizeFirstLetter(form["i_can_say_no_to_sex_even_if_my_boyfriend_or_friends_pressure_me_to_have_sex"]),
              Make_my_own_decisions_pressure__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["i_can_make_my_own_decisions_no_matter_how_much_pressure_i_get_from_others"])],
              Tell_someone_if_I_were_touched__c: state.capitalizeFirstLetter(form["i_would_tell_someone_if_i_were_touched_in_a_manner_that_made_me_uncomfortab"]),
              Say_no_to_sex_no_matter_who_asks_me__c: state.capitalizeFirstLetter(form["i_can_say_no_to_sex_no_matter_who_asks_me"]),
              How_to_overcome_challenges__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["i_know_how_to_overcome_challenges_that_i_may_face_in_my_life"])],
              I_can_achieve_my_goals__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["i_can_achieve_my_goals_even_if_i_face_challenges"])],
              Confident_setting_measurable_goals__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["i_feel_confident_setting_measurable_goals"])],
              Good_reason_to_hit_his_girlfriend_wife__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["sometimes_a_man_or_boyfriend_may_have_a_good_reason_to_hit_his_girlfriend_o"])],
              Take_part_in_household_chores__c: state.capitalizeFirstLetter(form["men_should_take_part_in_household_chores_such_as_washing_plates_and_sweepin"]),
              Girls_responsibility_on_pregnancy__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["it_is_only_the_girls_responsibility_to_avoid_getting_pregnant"])],
              Right_to_have_sex__c: state.capitalizeFirstLetter(form["a_man_has_the_right_to_have_sex_with_his_girlfriend_even_if_she_doesnt_want"]),
              Appropriate_for_a_girl_to_carry_condoms__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["it_is_not_appropriate_for_a_girlwoman_to_carry_condoms"])],
              Where_to_get_support__c: state.idkdeclinedtoidkdeclined[state.capitalizeFirstLetter(form["copy-1-of-i_know_where_to_get_support_services_for_me_or_someone_else_for_gender-base"])],
              Gone_to_seek_support_forself__c: state.agreeDisagreeMap[state.capitalizeFirstLetter(form["in_the_last_2_years_have_you_ever_gone_to_seek_support_for_yourself_or_for_"])],
              People_in_my_life_who_I_can_get_help__c: state.idkdeclinedtoidkdeclined[state.capitalizeFirstLetter(form["there_are_people_in_my_life_who_i_can_get_help_from_if_i_need_it"])],
              People_in_my_life_who_I_can_talk_to__c: state.capitalizeFirstLetter(form["there_are_people_in_my_life_who_i_can_talk_to_about_how_to_handle_things"]),
              Where_to_go_for_support_for_alcohol__c: state.idkdeclinedtoidkdeclined[state.capitalizeFirstLetter(form["i_know_where_to_go_for_support_if_i_or_someone_i_know_drinks_too_much_alcoh"])],
            };
            return state;
          });

          upsert(
            "SKILLZ_Outcome_Monitoring_Survey__c",
            "CommCare_Ext_ID__c",
            (state) => state.surveyMappings
          );

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Outcome-Survey:
        source_trigger: webhook
        target_job: Outcome-Survey
        condition_type: js_expression
        condition_label: Outcome Survey
        condition_expression: |
          state.data.form["@name"] == "SKILLZ Outcome Monitoring Survey" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
  Upsert-Intervention-Notes:
    name: Upsert Intervention Notes
    jobs:
      Upsert-Intervention-Notes:
        name: Upsert Intervention Notes
        adaptor: '@openfn/language-salesforce@2.7.4'
        credential: rita@openfn.org-GRS-Salesforce-Prod
        body: |
          //openfn.org source 
          upsert(
            'Event__c',
            'CommCare_Case_ID__c',
            fields(
              field('CommCare_Case_ID__c', dataValue('form.case.@case_id')),
              //field('Name', dataValue('form.intervention_name')),
              field('Comments__c', dataValue('form.intervention_notes_to_save')),
              relationship('RecordType', 'Name', 'Intervention')
            )
          );

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->Upsert-Intervention-Notes:
        source_trigger: webhook
        target_job: Upsert-Intervention-Notes
        condition_type: js_expression
        condition_label: Intervention Notes
        condition_expression: |
          state.data.form["@name"] == "Intervention Notes" && state.data.form["business_unit"] != "57ac433fe0cb4319a701cc9e7c721816"
        enabled: true
